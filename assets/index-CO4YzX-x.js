var Ci=Object.defineProperty;var gt=r=>{throw TypeError(r)};var Ti=(r,e,t)=>e in r?Ci(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var pt=(r,e,t)=>Ti(r,typeof e!="symbol"?e+"":e,t),Ii=(r,e,t)=>e.has(r)||gt("Cannot "+t);var oe=(r,e,t)=>(Ii(r,e,"read from private field"),t?t.call(r):e.get(r)),mt=(r,e,t)=>e.has(r)?gt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{M as it,i as Di,D as Li,f as ke,F as Ai,a as xi,u as ni,g as Ni,n as Re,b as ue,A as j,c as si,d as ai,P as Mi,s as Q,e as L,h as O,j as Ri,k as le,X as Fe,l as $,m as Bi,o as Y,R as me,O as re,p as ki,q as Fi,r as ri,t as oi,U as nt,v as Oi,T as Vi,w as Hi,x as Ui,y as we,z as Wi,S as ye,B as Oe,C as Ji,E as Gi,G as vt,H as Et,I as bt,J as wt,K as zi,L as ji,N as $i,Q as yt,V as Ki,W as Xi}from"./vendor-TUkyq4-d.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const fe="auto",st=1,Pt=1.1,li=.1,hi=10,Ve=0,Zi=1.25,St=40,_t=5,T={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},R={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},I={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4},K={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},C={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},x={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2},V={SELECT:0,HAND:1,ZOOM:2},Yi=/\bprint\s*\(/;function at(r,e,t=!1){let i=r.offsetParent;if(!i){console.error("offsetParent is not set -- cannot scroll");return}let n=r.offsetTop+r.clientTop,s=r.offsetLeft+r.clientLeft;for(;i.clientHeight===i.scrollHeight&&i.clientWidth===i.scrollWidth||t&&(i.classList.contains("markedContent")||getComputedStyle(i).overflow==="hidden");)if(n+=i.offsetTop,s+=i.offsetLeft,i=i.offsetParent,!i)return;if(e&&(e.top!==void 0&&(n+=e.top),e.left!==void 0)){const a=r.getBoundingClientRect().width,o=it((i.clientWidth-a)/2,20,400),l=e.left-o;s+=l,i.scrollLeft=s}i.scrollTop=n}function di(r,e,t=void 0){const i=function(a){s||(s=window.requestAnimationFrame(function(){s=null;const l=r.scrollLeft,h=n.lastX;l!==h&&(n.right=l>h),n.lastX=l;const d=r.scrollTop,c=n.lastY;d!==c&&(n.down=d>c),n.lastY=d,e(n)}))},n={right:!0,down:!0,lastX:r.scrollLeft,lastY:r.scrollTop,_eventHandler:i};let s=null;return r.addEventListener("scroll",i,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(s),{once:!0}),n}function ve(r){const e=new Map;for(const[t,i]of new URLSearchParams(r))e.set(t.toLowerCase(),i);return e}const Ct=/[\x00-\x1F]/g;function he(r,e=!1){return Ct.test(r)?e?r.replaceAll(Ct,t=>t==="\0"?"":" "):r.replaceAll("\0",""):r}function Ee(r,e,t=0){let i=t,n=r.length-1;if(n<0||!e(r[n]))return r.length;if(e(r[i]))return i;for(;i<n;){const s=i+n>>1,a=r[s];e(a)?n=s:i=s+1}return i}function Tt(r){if(Math.floor(r)===r)return[r,1];const e=1/r,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];const i=r>1?e:r;let n=0,s=1,a=1,o=1;for(;;){const h=n+a,d=s+o;if(d>t)break;i<=h/d?(a=h,o=d):(n=h,s=d)}let l;return i-n/s<a/o-i?l=i===r?[n,s]:[s,n]:l=i===r?[a,o]:[o,a],l}function Pe(r,e){return r-r%e}function Qi({view:r,userUnit:e,rotate:t}){const[i,n,s,a]=r,o=t%180!==0,l=(s-i)/72*e,h=(a-n)/72*e;return{width:o?h:l,height:o?l:h}}function qi(r,e,t){if(r<2)return r;let i=e[r].div,n=i.offsetTop+i.clientTop;n>=t&&(i=e[r-1].div,n=i.offsetTop+i.clientTop);for(let s=r-2;s>=0&&(i=e[s].div,!(i.offsetTop+i.clientTop+i.clientHeight<=n));--s)r=s;return r}function ci({scrollEl:r,views:e,sortByVisibility:t=!1,horizontal:i=!1,rtl:n=!1}){const s=r.scrollTop,a=s+r.clientHeight,o=r.scrollLeft,l=o+r.clientWidth;function h(w){const b=w.div;return b.offsetTop+b.clientTop+b.clientHeight>s}function d(w){const b=w.div,E=b.offsetLeft+b.clientLeft,P=E+b.clientWidth;return n?E<l:P>o}const c=[],u=new Set,p=e.length;let f=Ee(e,i?d:h);f>0&&f<p&&!i&&(f=qi(f,e,s));let v=i?l:-1;for(let w=f;w<p;w++){const b=e[w],E=b.div,P=E.offsetLeft+E.clientLeft,_=E.offsetTop+E.clientTop,D=E.clientWidth,A=E.clientHeight,F=P+D,H=_+A;if(v===-1)H>=a&&(v=H);else if((i?P:_)>v)break;if(H<=s||_>=a||F<=o||P>=l)continue;const q=Math.max(0,s-_),M=Math.max(0,o-P),N=q+Math.max(0,H-a),B=M+Math.max(0,F-l),k=(A-N)/A,se=(D-B)/D,ft=k*se*100|0;c.push({id:b.id,x:P,y:_,visibleArea:ft===100?null:{minX:M,minY:q,maxX:Math.min(F,l)-P,maxY:Math.min(H,a)-_},view:b,percent:ft,widthPercent:se*100|0}),u.add(b.id)}const y=c[0],S=c.at(-1);return t&&c.sort(function(w,b){const E=w.percent-b.percent;return Math.abs(E)>.001?-E:w.id-b.id}),{first:y,last:S,views:c,ids:u}}function ui(r){let e=Math.hypot(r.deltaX,r.deltaY);const t=Math.atan2(r.deltaY,r.deltaX);return-.25*Math.PI<t&&t<.75*Math.PI&&(e=-e),e}function en(r){const e=r.deltaMode;let t=ui(r);const i=30,n=30;return e===WheelEvent.DOM_DELTA_PIXEL?t/=i*n:e===WheelEvent.DOM_DELTA_LINE&&(t/=n),t}function Be(r){return Number.isInteger(r)&&r%90===0}function fi(r){return Number.isInteger(r)&&Object.values(C).includes(r)&&r!==C.UNKNOWN}function gi(r){return Number.isInteger(r)&&Object.values(x).includes(r)&&r!==x.UNKNOWN}function Ye(r){return r.width<=r.height}const tn=new Promise(function(r){if(typeof PDFJSDev<"u"&&PDFJSDev.test("LIB")&&typeof window>"u"){setTimeout(r,20);return}window.requestAnimationFrame(r)}),rt=typeof PDFJSDev<"u"&&PDFJSDev.test("LIB")&&typeof document>"u"?null:document.documentElement.style;class nn{#e=null;#t=null;#i=0;#n=null;#a=!0;constructor(e){this.#e=e.classList,this.#n=e.style}get percent(){return this.#i}set percent(e){if(this.#i=it(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#i}%`)}setWidth(e){if(!e)return;const i=e.parentNode.offsetWidth-e.offsetWidth;i>0&&this.#n.setProperty("--progressBar-end-offset",`${i}px`)}setDisableAutoFetch(e=5e3){this.#i===100||isNaN(this.#i)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#a&&(this.#a=!1,this.#e.add("hidden"))}show(){this.#a||(this.#a=!0,this.#e.remove("hidden"))}}function It(){let r=document,e=r.activeElement||r.querySelector(":focus");for(;e?.shadowRoot;)r=e.shadowRoot,e=r.activeElement||r.querySelector(":focus");return e}function pi(r){let e=C.VERTICAL,t=x.NONE;switch(r){case"SinglePage":e=C.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=C.PAGE;case"TwoColumnLeft":t=x.ODD;break;case"TwoPageRight":e=C.PAGE;case"TwoColumnRight":t=x.EVEN;break}return{scrollMode:e,spreadMode:t}}function sn(r){switch(r){case"UseNone":return I.NONE;case"UseThumbs":return I.THUMBS;case"UseOutlines":return I.OUTLINE;case"UseAttachments":return I.ATTACHMENTS;case"UseOC":return I.LAYERS}return I.NONE}function U(r,e,t=null){r.classList.toggle("toggled",e),r.setAttribute("aria-checked",e),t?.classList.toggle("hidden",!e)}function X(r,e,t=null){r.classList.toggle("toggled",e),r.setAttribute("aria-expanded",e),t?.classList.toggle("hidden",!e)}const Se=typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?Math.fround:function(){if(typeof PDFJSDev<"u"&&PDFJSDev.test("LIB")&&typeof document>"u")return e=>e;const r=document.createElement("div");return r.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",r.style.width==="calc(1320px)"?Math.fround:e=>e}();if(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")){var ae=new Map;typeof PDFJSDev<"u"&&PDFJSDev.test("LIB")&&!globalThis.navigator?.language&&(globalThis.navigator={language:"en-US",maxTouchPoints:1,platform:"",userAgent:""});const{maxTouchPoints:r,platform:e,userAgent:t}=navigator,i=/Android/.test(t),n=/\b(iPad|iPhone|iPod)(?=;)/.test(t)||e==="MacIntel"&&r>1;(function(){(n||i)&&ae.set("maxCanvasPixels",5242880)})(),function(){i&&ae.set("useSystemFonts",!1)}()}const g={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},Qe={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},G={allowedGlobalEvents:{value:null,kind:g.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:g.BROWSER+g.API},isInAutomation:{value:!1,kind:g.BROWSER},localeProperties:{value:typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?{lang:navigator.language||"en-US"}:null,kind:g.BROWSER},maxCanvasDim:{value:32767,kind:g.BROWSER+g.VIEWER},nimbusDataStr:{value:"",kind:g.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:g.BROWSER},supportsDocumentFonts:{value:!0,kind:g.BROWSER},supportsIntegratedFind:{value:!1,kind:g.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:g.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:g.BROWSER},supportsPinchToZoom:{value:!0,kind:g.BROWSER},supportsPrinting:{value:!0,kind:g.BROWSER},toolbarDensity:{value:0,kind:g.BROWSER+g.EVENT_DISPATCH},altTextLearnMoreUrl:{value:typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?"https://support.mozilla.org/1/firefox/%VERSION%/%OS%/%LOCALE%/pdf-alt-text":"",kind:g.VIEWER+g.PREFERENCE},annotationEditorMode:{value:0,kind:g.VIEWER+g.PREFERENCE},annotationMode:{value:2,kind:g.VIEWER+g.PREFERENCE},capCanvasAreaFactor:{value:200,kind:g.VIEWER+g.PREFERENCE},cursorToolOnLoad:{value:0,kind:g.VIEWER+g.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:g.VIEWER},defaultZoomDelay:{value:400,kind:g.VIEWER+g.PREFERENCE},defaultZoomValue:{value:"",kind:g.VIEWER+g.PREFERENCE},disableHistory:{value:!1,kind:g.VIEWER},disablePageLabels:{value:!1,kind:g.VIEWER+g.PREFERENCE},enableAltText:{value:!1,kind:g.VIEWER+g.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:g.VIEWER+g.PREFERENCE+g.EVENT_DISPATCH},enableAutoLinking:{value:!0,kind:g.VIEWER+g.PREFERENCE},enableDetailCanvas:{value:!0,kind:g.VIEWER},enableGuessAltText:{value:!0,kind:g.VIEWER+g.PREFERENCE+g.EVENT_DISPATCH},enableHighlightFloatingButton:{value:typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"),kind:g.VIEWER+g.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:g.VIEWER+g.PREFERENCE},enablePermissions:{value:!1,kind:g.VIEWER+g.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:g.VIEWER+g.PREFERENCE},enableScripting:{value:typeof PDFJSDev>"u"||!PDFJSDev.test("CHROME"),kind:g.VIEWER+g.PREFERENCE},enableSignatureEditor:{value:typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"),kind:g.VIEWER+g.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:g.VIEWER+g.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:g.VIEWER},externalLinkTarget:{value:0,kind:g.VIEWER+g.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:g.VIEWER+g.PREFERENCE},historyUpdateUrl:{value:!1,kind:g.VIEWER+g.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:g.VIEWER+g.PREFERENCE},imageResourcesPath:{value:typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/web/images/":"./images/",kind:g.VIEWER},maxCanvasPixels:{value:2**25,kind:g.VIEWER},minDurationToUpdateCanvas:{value:500,kind:g.VIEWER},forcePageColors:{value:!1,kind:g.VIEWER+g.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:g.VIEWER+g.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:g.VIEWER+g.PREFERENCE},pdfBugEnabled:{value:typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"),kind:g.VIEWER+g.PREFERENCE},printResolution:{value:150,kind:g.VIEWER},sidebarViewOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},scrollModeOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},spreadModeOnLoad:{value:-1,kind:g.VIEWER+g.PREFERENCE},textLayerMode:{value:1,kind:g.VIEWER+g.PREFERENCE},viewerCssTheme:{value:typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")?2:0,kind:g.VIEWER+g.PREFERENCE},viewOnLoad:{value:0,kind:g.VIEWER+g.PREFERENCE},cMapPacked:{value:!0,kind:g.API},cMapUrl:{value:typeof PDFJSDev>"u"?"../external/bcmaps/":PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/web/cmaps/":"/cmaps/",kind:g.API},disableAutoFetch:{value:!1,kind:g.API+g.PREFERENCE},disableFontFace:{value:!1,kind:g.API+g.PREFERENCE},disableRange:{value:!1,kind:g.API+g.PREFERENCE},disableStream:{value:!1,kind:g.API+g.PREFERENCE},docBaseUrl:{value:typeof PDFJSDev>"u"?document.URL.split("#",1)[0]:"",kind:g.API},enableHWA:{value:typeof PDFJSDev<"u"&&!PDFJSDev.test("MOZCENTRAL"),kind:g.API+g.VIEWER+g.PREFERENCE},enableXfa:{value:!0,kind:g.API+g.PREFERENCE},fontExtraProperties:{value:!1,kind:g.API},iccUrl:{value:typeof PDFJSDev>"u"?"../external/iccs/":PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/web/iccs/":"/iccs/",kind:g.API},isEvalSupported:{value:!0,kind:g.API},isOffscreenCanvasSupported:{value:!0,kind:g.API},maxImageSize:{value:-1,kind:g.API},pdfBug:{value:!1,kind:g.API},standardFontDataUrl:{value:typeof PDFJSDev>"u"?"../external/standard_fonts/":PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/web/standard_fonts/":"/standard_fonts/",kind:g.API},useSystemFonts:{value:(typeof PDFJSDev>"u"?window.isGECKOVIEW:PDFJSDev.test("GECKOVIEW"))?!1:void 0,kind:g.API,type:Qe.BOOLEAN+Qe.UNDEFINED},verbosity:{value:1,kind:g.API},wasmUrl:{value:typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/web/wasm/":"/wasm/",kind:g.API},workerPort:{value:typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")&&globalThis.pdfjsPreloadedWorker||null,kind:g.WORKER},workerSrc:{value:typeof PDFJSDev>"u"?"https://registry.npmmirror.com/pdfjs-dist/5.3.93/files/build/pdf.worker.mjs":PDFJSDev.test("MOZCENTRAL")?"resource://pdf.js/build/pdf.worker.mjs":"../build/pdf.worker.mjs",kind:g.WORKER}};(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&(G.defaultUrl={value:typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")?"":"https://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf",kind:g.VIEWER},G.sandboxBundleSrc={value:typeof PDFJSDev>"u"?"../build/dev-sandbox/pdf.sandbox.mjs":"../build/pdf.sandbox.mjs",kind:g.VIEWER},G.enableFakeMLManager={value:!0,kind:g.VIEWER});typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?G.disablePreferences={value:typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING"),kind:g.VIEWER}:PDFJSDev.test("CHROME")&&(G.disableTelemetry={value:!1,kind:g.VIEWER+g.PREFERENCE});if(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING || LIB"))for(const r in G){const{value:e,kind:t,type:i}=G[r];if(t&g.PREFERENCE){if(t===g.PREFERENCE)throw new Error(`Cannot use only "PREFERENCE" kind: ${r}`);if(t&g.BROWSER)throw new Error(`Cannot mix "PREFERENCE" and "BROWSER" kind: ${r}`);if(i!==void 0)throw new Error(`Cannot have \`type\`-field for "PREFERENCE" kind: ${r}`);if(typeof ae=="object"&&ae.has(r))throw new Error(`Should not have compatibility-value for "PREFERENCE" kind: ${r}`);if(typeof e!="boolean"&&typeof e!="string"&&!Number.isInteger(e))throw new Error(`Invalid value for "PREFERENCE" kind: ${r}`)}else if(t&g.BROWSER){if(i!==void 0)throw new Error(`Cannot have \`type\`-field for "BROWSER" kind: ${r}`);if(typeof ae=="object"&&ae.has(r))throw new Error(`Should not have compatibility-value for "BROWSER" kind: ${r}`);if(e===void 0)throw new Error(`Invalid value for "BROWSER" kind: ${r}`)}}var ne;const Z=class Z{constructor(){if(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))throw new Error("Cannot initialize AppOptions.")}static get(e){return oe(this,ne).get(e)}static getAll(e=null,t=!1){const i=Object.create(null);for(const n in G){const s=G[n];e&&!(e&s.kind)||(i[n]=t?s.value:oe(this,ne).get(n))}return i}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this._hasInvokedSet||=!0);let i;for(const n in e){const s=G[n],a=e[n];if(!s||!(typeof a==typeof s.value||Qe[(typeof a).toUpperCase()]&s.type))continue;const{kind:o}=s;t&&!(o&g.BROWSER||o&g.PREFERENCE)||(this.eventBus&&o&g.EVENT_DISPATCH&&(i||=new Map).set(n,a),oe(this,ne).set(n,a))}if(i)for(const[n,s]of i)this.eventBus.dispatch(n.toLowerCase(),{source:this,value:s})}};ne=new WeakMap,pt(Z,"eventBus"),mt(Z,ne,new Map),(()=>{for(const e in G)oe(Z,ne).set(e,G[e].value);if(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")){for(const[e,t]of ae)oe(Z,ne).set(e,t);Z._hasInvokedSet=!1,Z._checkDisablePreferences=()=>Z.get("disablePreferences")?!0:(Z._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)}})();let m=Z;const an="noopener noreferrer nofollow",ee={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};class mi{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:i=null,ignoreDestinationZoom:n=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=i,this._ignoreDestinationZoom=n,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}async goToDestination(e){if(!this.pdfDocument)return;let t,i,n;if(typeof e=="string"?(t=e,i=await this.pdfDocument.getDestination(e)):(t=null,i=await e),!Array.isArray(i)){console.error(`goToDestination: "${i}" is not a valid destination array, for dest="${e}".`);return}const[s]=i;if(s&&typeof s=="object"){if(n=this.pdfDocument.cachedPageNumber(s),!n)try{n=await this.pdfDocument.getPageIndex(s)+1}catch{console.error(`goToDestination: "${s}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(s)&&(n=s+1);if(!n||n<1||n>this.pagesCount){console.error(`goToDestination: "${n}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:i,pageNumber:n})),this.pdfViewer.scrollPageIntoView({pageNumber:n,destArray:i,ignoreDestinationZoom:this._ignoreDestinationZoom})}goToPage(e){if(!this.pdfDocument)return;const t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,i=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');const n=i?ee.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let a="";switch(n){case ee.NONE:break;case ee.SELF:a="_self";break;case ee.BLANK:a="_blank";break;case ee.PARENT:a="_parent";break;case ee.TOP:a="_top";break}e.target=a,e.rel=typeof s=="string"?s:an}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){const t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,i;if(e.includes("=")){const n=ve(e);if(n.has("search")){const s=n.get("search").replaceAll('"',""),a=n.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:a?s:s.match(/\S+/g)})}if(n.has("page")&&(t=n.get("page")|0||1),n.has("zoom")){const s=n.get("zoom").split(","),a=s[0],o=parseFloat(a);a.includes("Fit")?a==="Fit"||a==="FitB"?i=[null,{name:a}]:a==="FitH"||a==="FitBH"||a==="FitV"||a==="FitBV"?i=[null,{name:a},s.length>1?s[1]|0:null]:a==="FitR"?s.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):i=[null,{name:a},s[1]|0,s[2]|0,s[3]|0,s[4]|0]:console.error(`PDFLinkService.setHash: "${a}" is not a valid zoom value.`):i=[null,{name:"XYZ"},s.length>1?s[1]|0:null,s.length>2?s[2]|0:null,o?o/100:a]}if(i?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:i,allowNegativeOffset:!0}):t&&(this.page=t),n.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:n.get("pagemode")}),n.has("nameddest")&&this.goToDestination(n.get("nameddest")),typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL")||!n.has("filename")||!n.has("filedest"))return;e=n.get("filedest")}i=unescape(e);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch{}if(typeof i=="string"||Di(i)){this.goToDestination(i);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}async executeSetOCGState(e){if(!this.pdfDocument)return;const t=this.pdfDocument,i=await this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(i.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(i))}}class ot extends mi{setDocument(e,t=null){}}const rn="modulepreload",on=function(r){return"/pdf-viewer/"+r},Dt={},ln=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let l=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=l(t.map(h=>{if(h=on(h),h in Dt)return;Dt[h]=!0;const d=h.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${c}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":rn,d||(u.as="script"),u.crossOrigin="",u.href=h,o&&u.setAttribute("nonce",o),document.head.appendChild(u),d)return new Promise((p,f)=>{u.addEventListener("load",p),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})},Lt={EVENT:"event",TIMEOUT:"timeout"};async function vi({target:r,name:e,delay:t=0}){if(typeof r!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:i,resolve:n}=Promise.withResolvers(),s=new AbortController;function a(h){s.abort(),clearTimeout(l),n(h)}const o=r instanceof lt?"_on":"addEventListener";r[o](e,a.bind(null,Lt.EVENT),{signal:s.signal});const l=setTimeout(a.bind(null,Lt.TIMEOUT),t);return i}class lt{#e=Object.create(null);on(e,t,i=null){this._on(e,t,{external:!0,once:i?.once,signal:i?.signal})}off(e,t,i=null){this._off(e,t)}dispatch(e,t){const i=this.#e[e];if(!i||i.length===0)return;let n;for(const{listener:s,external:a,once:o}of i.slice(0)){if(o&&this._off(e,s),a){(n||=[]).push(s);continue}s(t)}if(n){for(const s of n)s(t);n=null}}_on(e,t,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){console.error("Cannot use an `aborted` signal.");return}const o=()=>this._off(e,t);n=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}(this.#e[e]||=[]).push({listener:t,external:i?.external===!0,once:i?.once===!0,rmAbort:n})}_off(e,t,i=null){const n=this.#e[e];if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s];if(o.listener===t){o.rmAbort?.(),n.splice(s,1);return}}}}class hn extends lt{#e;#t;#i;constructor(e,t,i){super(),this.#t=e,this.#e=t,this.#i=i}dispatch(e,t){if(typeof PDFJSDev<"u"&&!PDFJSDev.test("MOZCENTRAL"))throw new Error("Not implemented: FirefoxEventBus.dispatch");if(super.dispatch(e,t),this.#i){const i=Object.create(null);if(t)for(const s in t){const a=t[s];if(s==="source"){if(a===window||a===document)return;continue}i[s]=a}const n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i});document.dispatchEvent(n)}this.#t?.has(e)&&this.#e.dispatchGlobalEvent({eventName:e,detail:t})}}class ht{constructor(){if((typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))&&this.constructor===ht)throw new Error("Cannot initialize BaseExternalServices.")}updateFindControlState(e){}updateFindMatchesCount(e){}initPassiveLoading(){}reportTelemetry(e){}async createL10n(){throw new Error("Not implemented: createL10n")}createScripting(){throw new Error("Not implemented: createScripting")}createSignatureStorage(){throw new Error("Not implemented: createSignatureStorage")}updateEditorStates(e){throw new Error("Not implemented: updateEditorStates")}dispatchGlobalEvent(e){}}class dt{#e=Object.freeze(typeof PDFJSDev>"u"?m.getAll(g.PREFERENCE,!0):PDFJSDev.eval("DEFAULT_PREFERENCES"));#t=null;constructor(){if((typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))&&this.constructor===dt)throw new Error("Cannot initialize BasePreferences.");typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")&&Object.defineProperty(this,"defaults",{get(){return this.#e}}),this.#t=this._readFromStorage(this.#e).then(({browserPrefs:e,prefs:t})=>{(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&m._checkDisablePreferences()||m.setAll({...e,...t},!0)}),typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")&&window.addEventListener("updatedPreference",async({detail:{name:e,value:t}})=>{await this.#t,m.setAll({[e]:t},!0)})}async _writeToStorage(e){throw new Error("Not implemented: _writeToStorage")}async _readFromStorage(e){throw new Error("Not implemented: _readFromStorage")}async reset(){if(typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL"))throw new Error("Please use `about:config` to change preferences.");await this.#t,m.setAll(this.#e,!0),await this._writeToStorage(this.#e)}async set(e,t){await this.#t,m.setAll({[e]:t},!0),await this._writeToStorage(typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?{[e]:m.get(e)}:m.getAll(g.PREFERENCE))}async get(e){if(typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL"))throw new Error("Not implemented: get");return await this.#t,m.get(e)}get initializedPromise(){return this.#t}}class Le{#e;#t;#i;#n;constructor({lang:e,isRTL:t},i=null){this.#i=Le.#a(e),this.#n=i,this.#e=t??Le.#s(this.#i)?"rtl":"ltr"}_setL10n(e){this.#n=e,typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING")&&(document.l10n=e)}getLanguage(){return this.#i}getDirection(){return this.#e}async get(e,t=null,i){return Array.isArray(e)?(e=e.map(a=>({id:a})),(await this.#n.formatMessages(e)).map(a=>a.value)):(await this.#n.formatMessages([{id:e,args:t}]))[0]?.value||i}async translate(e){(this.#t||=new Set).add(e);try{this.#n.connectRoot(e),await this.#n.translateRoots()}catch{}}async translateOnce(e){try{await this.#n.translateElements([e])}catch(t){console.error("translateOnce:",t)}}async destroy(){if(this.#t){for(const e of this.#t)this.#n.disconnectRoot(e);this.#t.clear(),this.#t=null}this.#n.pauseObserving()}pause(){this.#n.pauseObserving()}resume(){this.#n.resumeObserving()}static#a(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#s(e){const t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}}function dn(){const{isAndroid:r,isLinux:e,isMac:t,isWindows:i}=ni.platform;return e?"linux":i?"windows":t?"macos":r?"android":"other"}function At(r,e){const t=new Ai(e),i=new xi(r,{functions:{PLATFORM:dn}}),n=i.addResource(t);return n.length&&console.error("L10n errors",n),i}class te extends Le{constructor(e){super({lang:e});const t=e?te.#e.bind(te,"en-us",this.getLanguage()):te.#n.bind(te,this.getLanguage());this._setL10n(new Li([],t))}static async*#e(e,t){const{baseURL:i,paths:n}=await this.#i(),s=[t];if(e!==t){const o=t.split("-",1)[0];o!==t&&s.push(o),s.push(e)}const a=s.map(o=>[o,this.#t(o,i,n)]);for(const[o,l]of a){const h=await l;h?yield h:o==="en-us"&&(yield this.#a(o))}}static async#t(e,t,i){const n=i[e];if(!n)return null;const s=new URL(n,t),a=await ke(s,"text");return At(e,a)}static async#i(){try{const{href:e}=document.querySelector('link[type="application/l10n"]'),t=await ke(e,"json");return{baseURL:e.substring(0,e.lastIndexOf("/")+1)||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}}static async*#n(e){yield this.#a(e)}static async#a(e){if(typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING"))throw new Error("Not implemented: #createBundleFallback");const t=typeof PDFJSDev>"u"?await ke(new URL("../l10n/en-US/viewer.ftl",window.location.href),"text"):PDFJSDev.eval("DEFAULT_FTL");return At(e,t)}}class cn{constructor(e){this._ready=new Promise((t,i)=>{(typeof PDFJSDev>"u"?import(e):__raw_import__(e)).then(s=>{t(s.QuickJSSandbox())}).catch(i)})}async createSandbox(e){(await this._ready).create(e)}async dispatchEventInSandbox(e){const t=await this._ready;setTimeout(()=>t.dispatchEvent(e),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}const He="pdfjs.signature";class un{#e;#t=null;#i=null;constructor(e,t){this.#e=e,this.#i=t}#n(){localStorage.setItem(He,JSON.stringify(Object.fromEntries(this.#t)))}async getAll(){if(this.#i&&(window.addEventListener("storage",({key:e})=>{e===He&&(this.#t=null,this.#e?.dispatch("storedsignatureschanged",{source:this}))},{signal:this.#i}),this.#i=null),!this.#t){this.#t=new Map;const e=localStorage.getItem(He);if(e)for(const[t,i]of Object.entries(JSON.parse(e)))this.#t.set(t,i)}return this.#t}async isFull(){return await this.size()===5}async size(){return(await this.getAll()).size}async create(e){if(await this.isFull())return null;const t=Ni();return this.#t.set(t,e),this.#n(),t}async delete(e){const t=await this.getAll();return t.has(e)?(t.delete(e),this.#n(),!0):!1}}if(typeof PDFJSDev<"u"&&!PDFJSDev.test("GENERIC"))throw new Error('Module "pdfjs-web/genericcom" shall not be used outside GENERIC build.');class fn extends dt{async _writeToStorage(e){localStorage.setItem("pdfjs.preferences",JSON.stringify(e))}async _readFromStorage(e){return{prefs:JSON.parse(localStorage.getItem("pdfjs.preferences"))}}}class gn extends ht{async createL10n(){return new te(m.get("localeProperties")?.lang)}createScripting(){return new cn(m.get("sandboxBundleSrc"))}createSignatureStorage(e,t){return new un(e,t)}}const ut=class ut{async isEnabledFor(e){return!1}async deleteModel(e){return null}isReady(e){return!1}guess(e){}toggleService(e,t){}};(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))&&(ut.getFakeMLManager=e=>new pn(e));let Ae=ut;if(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))var pn=class{eventBus=null;hasProgress=!1;constructor({enableGuessAltText:r,enableAltTextModelDownload:e}){this.enableGuessAltText=r,this.enableAltTextModelDownload=e}setEventBus(r,e){this.eventBus=r}async isEnabledFor(r){return this.enableGuessAltText}async deleteModel(r){return this.enableAltTextModelDownload=!1,null}async loadModel(r){}async downloadModel(r){this.hasProgress=!0;const{promise:e,resolve:t}=Promise.withResolvers(),i=1e8,n=1.5*i,s=5e6;let a=0;const o=setInterval(()=>{if(a+=s,a<=n){this.eventBus.dispatch("loadaiengineprogress",{source:this,detail:{total:i,totalLoaded:a,finished:a+s>=n}});return}clearInterval(o),this.hasProgress=!1,this.enableAltTextModelDownload=!0,t(!0)},900);return e}isReady(r){return this.enableAltTextModelDownload}guess({request:{data:r}}){return new Promise(e=>{setTimeout(()=>{e(r?{output:"Fake alt text."}:{error:!0})},3e3)})}toggleService(r,e){this.enableGuessAltText=e}};class mn{#e=this.#R.bind(this);#t;#i=null;#n;#a;#s;#r;#o;#h;#l;#d=!1;#c;#u=null;#f=null;#v;#p;#E=!1;#g=!1;#T;#P;#w;#m;#L;#b;#C=null;constructor({descriptionContainer:e,dialog:t,imagePreview:i,cancelButton:n,disclaimer:s,notNowButton:a,saveButton:o,textarea:l,learnMore:h,errorCloseButton:d,createAutomaticallyButton:c,downloadModel:u,downloadModelDescription:p,title:f},v,y){this.#n=n,this.#t=c,this.#a=e,this.#s=t,this.#r=s,this.#P=a,this.#v=i,this.#m=l,this.#T=h,this.#L=f,this.#o=u,this.#h=p,this.#w=v,this.#l=y,t.addEventListener("close",this.#x.bind(this)),t.addEventListener("contextmenu",S=>{S.target!==this.#m&&S.preventDefault()}),n.addEventListener("click",this.#e),a.addEventListener("click",this.#e),o.addEventListener("click",this.#U.bind(this)),d.addEventListener("click",()=>{this.#y(!1)}),c.addEventListener("click",async()=>{const S=c.getAttribute("aria-pressed")!=="true";this.#i._reportTelemetry({action:"pdfjs.image.alt_text.ai_generation_check",data:{status:S}}),this.#b&&(this.#b.setPreference("enableGuessAltText",S),await this.#b.mlManager.toggleService("altText",S)),this.#_(S,!1)}),l.addEventListener("focus",()=>{this.#g=this.#E,this.#S(!1),this.#I()}),l.addEventListener("blur",()=>{l.value||this.#S(this.#g),this.#I()}),l.addEventListener("input",()=>{this.#I()}),y._on("enableguessalttext",({value:S})=>{this.#_(S,!1)}),this.#w.register(t),this.#T.addEventListener("click",()=>{this.#i._reportTelemetry({action:"pdfjs.image.alt_text.info",data:{topic:"alt_text"}})})}#S(e){!this.#b||this.#E===e||(this.#E=e,this.#a.classList.toggle("loading",e))}#y(e){this.#b&&this.#s.classList.toggle("error",e)}async#_(e,t=!1){if(this.#b)if(this.#s.classList.toggle("aiDisabled",!e),this.#t.setAttribute("aria-pressed",e),e){const{altTextLearnMoreUrl:i}=this.#b.mlManager;i&&(this.#T.href=i),this.#H(t)}else this.#S(!1),this.#E=!1,this.#I()}#A(){this.#P.classList.toggle("hidden",!this.#d),this.#n.classList.toggle("hidden",this.#d)}#N(e){!this.#b||this.#u===e||(this.#u=e,this.#s.classList.toggle("noAi",!e),this.#I())}#I(){const e=this.#E||this.#c&&this.#c===this.#m.value;this.#r.hidden=!e;const t=this.#E||!!this.#m.value;this.#f!==t&&(this.#f=t,this.#L.setAttribute("data-l10n-id",t?"pdfjs-editor-new-alt-text-dialog-edit-label":"pdfjs-editor-new-alt-text-dialog-add-label"))}async#H(e){if(this.#E||this.#m.value||e&&this.#C!==null)return;if(this.#c=this.#i.guessedAltText,this.#C===null&&this.#c){this.#F(this.#c);return}this.#S(!0),this.#I();let t=!1;try{const i=await this.#i.mlGuessAltText(this.#p,!1);i&&(this.#c=i,this.#g=this.#E,this.#E&&this.#F(i))}catch(i){console.error(i),t=!0}this.#S(!1),this.#I(),t&&this.#b&&this.#y(!0)}#F(e){!this.#b||this.#m.value||(this.#m.value=e,this.#I())}#O(){this.#o.classList.toggle("hidden",!1);const e=async({detail:{finished:t,total:i,totalLoaded:n}})=>{n=Math.min(.99*i,n);const a=this.#h.ariaValueMax=Math.round(i/1e6),o=this.#h.ariaValueNow=Math.round(n/1e6);if(this.#h.setAttribute("data-l10n-args",JSON.stringify({totalSize:a,downloadedSize:o})),!t||(this.#l._off("loadaiengineprogress",e),this.#o.classList.toggle("hidden",!0),this.#N(!0),!this.#b))return;const{mlManager:l}=this.#b;l.toggleService("altText",!0),this.#_(await l.isEnabledFor("altText"),!0)};this.#l._on("loadaiengineprogress",e)}async editAltText(e,t,i){if(this.#i||!t)return;if(i&&t.hasAltTextData()){t.altTextFinish();return}this.#d=i;let{mlManager:n}=e,s=!!n;this.#I(),n&&!n.isReady("altText")?(s=!1,n.hasProgress?this.#O():n=null):this.#o.classList.toggle("hidden",!0);const a=n?.isEnabledFor("altText");this.#i=t,this.#b=e,this.#b.removeEditListeners(),{altText:this.#C}=t.altTextData,this.#m.value=this.#C??"";const o=224,l=180;let h,d,c;n?({canvas:h,width:d,height:c,imageData:this.#p}=t.copyCanvas(o,l,!0),s&&this.#_(await a,!0)):{canvas:h,width:d,height:c}=t.copyCanvas(o,l,!1),h.setAttribute("role","presentation");const{style:u}=h;u.width=`${d}px`,u.height=`${c}px`,this.#v.append(h),this.#A(),this.#N(s),this.#y(!1);try{await this.#w.open(this.#s)}catch(p){throw this.#x(),p}}#R(){this.#i.altTextData={cancel:!0};const e=this.#m.value.trim();this.#i._reportTelemetry({action:"pdfjs.image.alt_text.dismiss",data:{alt_text_type:e?"present":"empty",flow:this.#d?"image_add":"alt_text_edit"}}),this.#i._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:"skipped"}}),this.#D()}#D(){this.#w.closeIfActive(this.#s)}#x(){const e=this.#v.firstChild;e.remove(),e.width=e.height=0,this.#p=null,this.#S(!1),this.#b?.addEditListeners(),this.#i.altTextFinish(),this.#b?.setSelected(this.#i),this.#i=null,this.#b=null}#k(e){return new Set(e.toLowerCase().split(/[^\p{L}\p{N}]+/gu).filter(t=>!!t))}#U(){const e=this.#m.value.trim();if(this.#i.altTextData={altText:e,decorative:!1},this.#i.altTextData.guessedAltText=this.#c,this.#c&&this.#c!==e){const t=this.#k(this.#c),i=this.#k(e);this.#i._reportTelemetry({action:"pdfjs.image.alt_text.user_edit",data:{total_words:t.size,words_removed:t.difference(i).size,words_added:i.difference(t).size}})}this.#i._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:e?"present":"empty"}}),this.#i._reportTelemetry({action:"pdfjs.image.alt_text.save",data:{alt_text_type:e?"present":"empty",flow:this.#d?"image_add":"alt_text_edit"}}),this.#D()}destroy(){this.#b=null,this.#D()}}class vn{#e;#t;#i;#n;#a;#s;#r;#o;constructor({dialog:e,createModelButton:t,aiModelSettings:i,learnMore:n,closeButton:s,deleteModelButton:a,downloadModelButton:o,showAltTextDialogButton:l},h,d,c){this.#n=e,this.#e=i,this.#t=t,this.#i=o,this.#o=l,this.#r=h,this.#a=d,this.#s=c;const{altTextLearnMoreUrl:u}=c;u&&(n.href=u),e.addEventListener("contextmenu",Re),t.addEventListener("click",async p=>{const f=this.#c("enableGuessAltText",p);await c.toggleService("altText",f),this.#h({type:"stamp",action:"pdfjs.image.alt_text.settings_ai_generation_check",data:{status:f}})}),l.addEventListener("click",p=>{const f=this.#c("enableNewAltTextWhenAddingImage",p);this.#h({type:"stamp",action:"pdfjs.image.alt_text.settings_edit_alt_text_check",data:{status:f}})}),a.addEventListener("click",this.#d.bind(this,!0)),o.addEventListener("click",this.#l.bind(this,!0)),s.addEventListener("click",this.#f.bind(this)),n.addEventListener("click",()=>{this.#h({type:"stamp",action:"pdfjs.image.alt_text.info",data:{topic:"ai_generation"}})}),d._on("enablealttextmodeldownload",({value:p})=>{p?this.#l(!1):this.#d(!1)}),this.#r.register(e)}#h(e){this.#a.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}async#l(e=!1){if(e){this.#i.disabled=!0;const t=this.#i.firstChild;t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-downloading-model-button"),await this.#s.downloadModel("altText"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-download-model-button"),this.#t.disabled=!1,this.#u("enableGuessAltText",!0),this.#s.toggleService("altText",!0),this.#u("enableAltTextModelDownload",!0),this.#i.disabled=!1}this.#e.classList.toggle("download",!1),this.#t.setAttribute("aria-pressed",!0)}async#d(e=!1){e&&(await this.#s.deleteModel("altText"),this.#u("enableGuessAltText",!1),this.#u("enableAltTextModelDownload",!1)),this.#e.classList.toggle("download",!0),this.#t.disabled=!0,this.#t.setAttribute("aria-pressed",!1)}async open({enableGuessAltText:e,enableNewAltTextWhenAddingImage:t}){const{enableAltTextModelDownload:i}=this.#s;this.#t.disabled=!i,this.#t.setAttribute("aria-pressed",i&&e),this.#o.setAttribute("aria-pressed",t),this.#e.classList.toggle("download",!i),await this.#r.open(this.#n),this.#h({type:"stamp",action:"pdfjs.image.alt_text.settings_displayed"})}#c(e,{target:t}){const i=t.getAttribute("aria-pressed")!=="true";return this.#u(e,i),t.setAttribute("aria-pressed",i),i}#u(e,t){this.#a.dispatch("setpreference",{source:this,name:e,value:t})}#f(){this.#r.closeIfActive(this.#n)}}class En{#e=null;#t=null;#i;#n;#a;#s=!1;#r;#o;#h;#l;#d;#c;#u=null;#f=null;#v=null;#p=null;#E;#g=null;constructor({dialog:e,optionDescription:t,optionDecorative:i,textarea:n,cancelButton:s,saveButton:a},o,l,h){this.#n=e,this.#r=t,this.#o=i,this.#d=n,this.#i=s,this.#l=a,this.#h=l,this.#a=h,this.#E=o;const d=this.#L.bind(this);e.addEventListener("close",this.#m.bind(this)),e.addEventListener("contextmenu",c=>{c.target!==this.#d&&c.preventDefault()}),s.addEventListener("click",this.#w.bind(this)),a.addEventListener("click",this.#b.bind(this)),t.addEventListener("change",d),i.addEventListener("change",d),this.#h.register(e)}#T(){if(this.#v)return;const e=new ue,t=this.#v=e.createElement("svg");t.setAttribute("width","0"),t.setAttribute("height","0");const i=e.createElement("defs");t.append(i);const n=e.createElement("mask");i.append(n),n.setAttribute("id","alttext-manager-mask"),n.setAttribute("maskContentUnits","objectBoundingBox");let s=e.createElement("rect");n.append(s),s.setAttribute("fill","white"),s.setAttribute("width","1"),s.setAttribute("height","1"),s.setAttribute("x","0"),s.setAttribute("y","0"),s=this.#p=e.createElement("rect"),n.append(s),s.setAttribute("fill","black"),this.#n.append(t)}async editAltText(e,t){if(this.#t||!t)return;this.#T(),this.#s=!1,this.#e=new AbortController;const i={signal:this.#e.signal},n=this.#C.bind(this);for(const o of[this.#r,this.#o,this.#d,this.#l,this.#i])o.addEventListener("click",n,i);const{altText:s,decorative:a}=t.altTextData;a===!0?(this.#o.checked=!0,this.#r.checked=!1):(this.#o.checked=!1,this.#r.checked=!0),this.#u=this.#d.value=s?.trim()||"",this.#L(),this.#t=t,this.#c=e,this.#c.removeEditListeners(),this.#f=new AbortController,this.#a._on("resize",this.#P.bind(this),{signal:this.#f.signal});try{await this.#h.open(this.#n),this.#P()}catch(o){throw this.#m(),o}}#P(){if(!this.#t)return;const e=this.#n,{style:t}=e,{x:i,y:n,width:s,height:a}=this.#E.getBoundingClientRect(),{innerWidth:o,innerHeight:l}=window,{width:h,height:d}=e.getBoundingClientRect(),{x:c,y:u,width:p,height:f}=this.#t.getClientDimensions(),v=10,y=this.#c.direction==="ltr",S=Math.max(c,i),w=Math.min(c+p,i+s),b=Math.max(u,n),E=Math.min(u+f,n+a);this.#p.setAttribute("width",`${(w-S)/o}`),this.#p.setAttribute("height",`${(E-b)/l}`),this.#p.setAttribute("x",`${S/o}`),this.#p.setAttribute("y",`${b/l}`);let P=null,_=Math.max(u,0);_+=Math.min(l-(_+d),0),y?c+p+v+h<o?P=c+p+v:c>h+v&&(P=c-h-v):c>h+v?P=c-h-v:c+p+v+h<o&&(P=c+p+v),P===null&&(_=null,P=Math.max(c,0),P+=Math.min(o-(P+h),0),u>d+v?_=u-d-v:u+f+v+d<l&&(_=u+f+v)),_!==null?(e.classList.add("positioned"),y?t.left=`${P}px`:t.right=`${o-P-h}px`,t.top=`${_}px`):(e.classList.remove("positioned"),t.left="",t.top="")}#w(){this.#h.closeIfActive(this.#n)}#m(){this.#t._reportTelemetry(this.#g||{action:"alt_text_cancel",alt_text_keyboard:!this.#s}),this.#g=null,this.#S(),this.#c?.addEditListeners(),this.#f?.abort(),this.#f=null,this.#t.altTextFinish(),this.#t=null,this.#c=null}#L(){this.#d.disabled=this.#o.checked}#b(){const e=this.#d.value.trim(),t=this.#o.checked;this.#t.altTextData={altText:e,decorative:t},this.#g={action:"alt_text_save",alt_text_description:!!e,alt_text_edit:!!this.#u&&this.#u!==e,alt_text_decorative:t,alt_text_keyboard:!this.#s},this.#w()}#C(e){e.detail!==0&&(this.#s=!0,this.#S())}#S(){this.#e?.abort(),this.#e=null}destroy(){this.#c=null,this.#w(),this.#v?.remove(),this.#v=this.#p=null}}class bn{constructor(e,t){this.eventBus=t,this.#e(e)}#e({editorFreeTextFontSize:e,editorFreeTextColor:t,editorInkColor:i,editorInkThickness:n,editorInkOpacity:s,editorStampAddImage:a,editorFreeHighlightThickness:o,editorHighlightShowAll:l,editorSignatureAddSignature:h}){const{eventBus:d}=this,c=(u,p)=>{d.dispatch("switchannotationeditorparams",{source:this,type:j[u],value:p})};e.addEventListener("input",function(){c("FREETEXT_SIZE",this.valueAsNumber)}),t.addEventListener("input",function(){c("FREETEXT_COLOR",this.value)}),i.addEventListener("input",function(){c("INK_COLOR",this.value)}),n.addEventListener("input",function(){c("INK_THICKNESS",this.valueAsNumber)}),s.addEventListener("input",function(){c("INK_OPACITY",this.valueAsNumber)}),a.addEventListener("click",()=>{d.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{action:"pdfjs.image.add_image_click"}}}),c("CREATE")}),o.addEventListener("input",function(){c("HIGHLIGHT_THICKNESS",this.valueAsNumber)}),l.addEventListener("click",function(){const u=this.getAttribute("aria-pressed")==="true";this.setAttribute("aria-pressed",!u),c("HIGHLIGHT_SHOW_ALL",!u)}),h.addEventListener("click",()=>{c("CREATE")}),d._on("annotationeditorparamschanged",u=>{for(const[p,f]of u.details)switch(p){case j.FREETEXT_SIZE:e.value=f;break;case j.FREETEXT_COLOR:t.value=f;break;case j.INK_COLOR:i.value=f;break;case j.INK_THICKNESS:n.value=f;break;case j.INK_OPACITY:s.value=f;break;case j.HIGHLIGHT_DEFAULT_COLOR:d.dispatch("mainhighlightcolorpickerupdatecolor",{source:this,value:f});break;case j.HIGHLIGHT_THICKNESS:o.value=f;break;case j.HIGHLIGHT_FREE:o.disabled=!f;break;case j.HIGHLIGHT_SHOW_ALL:l.setAttribute("aria-pressed",f);break}})}}const _e=.1;class xe{#e;#t=0;#i;constructor(e,t,i,n){if(this.#e=t,this.#i=i,!n)return;this.#t=n.getBoundingClientRect().height;const s=new ResizeObserver(a=>{for(const o of a)if(o.target===n){this.#t=Math.floor(o.borderBoxSize[0].blockSize);break}});s.observe(n),e.addEventListener("abort",()=>s.disconnect(),{once:!0})}#n(e,t){const i=e.y,n=e.bottom,s=e.y+e.height/2,a=t.y,o=t.bottom,l=t.y+t.height/2;return i<=l&&l<=n||a<=s&&s<=o}#a(e,t,i,n){const s=e.y+e.height/2;return(n?i>=s:i<=s)&&e.x-_e<=t&&t<=e.right+_e}#s(e){return e.top>=this.#t&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}#r(e,t){const{focusNode:i,focusOffset:n}=e,s=document.createRange();s.setStart(i,n),s.setEnd(i,n);const a=s.getBoundingClientRect();return[a.x,t?a.top:a.bottom]}static#o(e,t){if((typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&!document.caretPositionFromPoint){const{startContainer:i,startOffset:n}=document.caretRangeFromPoint(e,t);return{offsetNode:i,offset:n}}return document.caretPositionFromPoint(e,t)}#h(e,t,i,n,s){if(s||=n.getBoundingClientRect(),t<=s.x+_e){i?e.extend(n.firstChild,0):e.setPosition(n.firstChild,0);return}if(s.right-_e<=t){const{lastChild:h}=n;i?e.extend(h,h.length):e.setPosition(h,h.length);return}const a=s.y+s.height/2;let o=xe.#o(t,a),l=o.offsetNode?.parentElement;if(l&&l!==n){const h=document.elementsFromPoint(t,a),d=[];for(const c of h){if(c===n)break;const{style:u}=c;d.push([c,u.visibility]),u.visibility="hidden"}o=xe.#o(t,a),l=o.offsetNode?.parentElement;for(const[c,u]of d)c.style.visibility=u}if(l!==n){i?e.extend(n.firstChild,0):e.setPosition(n.firstChild,0);return}i?e.extend(o.offsetNode,o.offset):e.setPosition(o.offsetNode,o.offset)}#l(e,t,i,n,s){if(this.#s(n)){this.#h(t,s,e,i,n);return}this.#e.addEventListener("scrollend",this.#h.bind(this,t,s,e,i,null),{once:!0}),i.scrollIntoView()}#d(e,t){for(;;){const i=e.closest(".page"),n=parseInt(i.getAttribute("data-page-number")),s=t?n-1:n+1;if(e=this.#i.querySelector(`.page[data-page-number="${s}"] .textLayer`),!e)return null;const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),o=t?a.lastChild():a.firstChild();if(o)return o}}moveCaret(e,t){const i=document.getSelection();if(i.rangeCount===0)return;const{focusNode:n}=i,s=n.nodeType!==Node.ELEMENT_NODE?n.parentElement:n,a=s.closest(".textLayer");if(!a)return;const o=document.createTreeWalker(a,NodeFilter.SHOW_TEXT);o.currentNode=n;const l=s.getBoundingClientRect();let h=null;const d=(e?o.previousSibling:o.nextSibling).bind(o);for(;d();){const f=o.currentNode.parentElement;if(!this.#n(l,f.getBoundingClientRect())){h=f;break}}if(!h){const f=this.#d(a,e);if(!f)return;if(t){const S=(e?o.firstChild():o.lastChild())||n;i.extend(S,e?0:S.length);const w=document.createRange();w.setStart(f,e?f.length:0),w.setEnd(f,e?f.length:0),i.addRange(w);return}const[v]=this.#r(i,e),{parentElement:y}=f;this.#l(t,i,y,y.getBoundingClientRect(),v);return}const[c,u]=this.#r(i,e),p=h.getBoundingClientRect();if(this.#a(p,c,u,e)){this.#l(t,i,h,p,c);return}for(;d();){const f=o.currentNode.parentElement,v=f.getBoundingClientRect();if(!this.#n(p,v))break;if(this.#a(v,c,u,e)){this.#l(t,i,f,v,c);return}}this.#l(t,i,h,p,c)}}if(typeof PDFJSDev<"u"&&!PDFJSDev.test("CHROME || GENERIC"))throw new Error('Module "pdfjs-web/download_manager" shall not be used outside CHROME and GENERIC builds.');function xt(r,e){const t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=r,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}class wn{#e=new WeakMap;downloadData(e,t,i){const n=URL.createObjectURL(new Blob([e],{type:i}));xt(n,t)}openOrDownloadData(e,t,i=null){const n=ai(t),s=n?"application/pdf":"";if((typeof PDFJSDev>"u"||!PDFJSDev.test("COMPONENTS"))&&n){let a=this.#e.get(e);a||(a=URL.createObjectURL(new Blob([e],{type:s})),this.#e.set(e,a));let o;typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?o="?file="+encodeURIComponent(a+"#"+t):PDFJSDev.test("CHROME")&&(o=chrome.runtime.getURL("/content/web/viewer.html")+"?file="+encodeURIComponent(a+"#"+t)),i&&(o+=`#${escape(i)}`);try{return window.open(o),!0}catch(l){console.error("openOrDownloadData:",l),URL.revokeObjectURL(a),this.#e.delete(e)}}return this.downloadData(e,t,s),!1}download(e,t,i){let n;if(e)n=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!si(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}n=t+"#pdfjs.action=download"}xt(n,i)}}class Ne{#e=null;#t;#i=null;#n=null;#a=null;isOpen=!1;#s;#r=null;#o;static#h=Object.freeze({highlight:"pdfjs-editor-undo-bar-message-highlight",freetext:"pdfjs-editor-undo-bar-message-freetext",stamp:"pdfjs-editor-undo-bar-message-stamp",ink:"pdfjs-editor-undo-bar-message-ink",signature:"pdfjs-editor-undo-bar-message-signature",_multiple:"pdfjs-editor-undo-bar-message-multiple"});constructor({container:e,message:t,undoButton:i,closeButton:n},s){this.#t=e,this.#s=t,this.#o=i,this.#e=n,this.#i=s}destroy(){this.#a?.abort(),this.#a=null,this.hide()}show(e,t){if(!this.#a){this.#a=new AbortController;const i={signal:this.#a.signal},n=this.hide.bind(this);this.#t.addEventListener("contextmenu",Re,i),this.#e.addEventListener("click",n,i),this.#i._on("beforeprint",n,i),this.#i._on("download",n,i)}this.hide(),typeof t=="string"?this.#s.setAttribute("data-l10n-id",Ne.#h[t]):(this.#s.setAttribute("data-l10n-id",Ne.#h._multiple),this.#s.setAttribute("data-l10n-args",JSON.stringify({count:t}))),this.isOpen=!0,this.#t.hidden=!1,this.#r=new AbortController,this.#o.addEventListener("click",()=>{e(),this.hide()},{signal:this.#r.signal}),this.#n=setTimeout(()=>{this.#t.focus(),this.#n=null},100)}hide(){this.isOpen&&(this.isOpen=!1,this.#t.hidden=!0,this.#r?.abort(),this.#r=null,this.#n&&(clearTimeout(this.#n),this.#n=null))}}class yn{#e=new WeakMap;#t=null;get active(){return this.#t}async register(e,t=!1){if(typeof e!="object")throw new Error("Not enough parameters.");if(this.#e.has(e))throw new Error("The overlay is already registered.");this.#e.set(e,{canForceClose:t}),e.addEventListener("cancel",({target:i})=>{this.#t===i&&(this.#t=null)})}async open(e){if(this.#e.has(e)){if(this.#t){if(this.#t===e)throw new Error("The overlay is already active.");if(this.#e.get(e).canForceClose)await this.close();else throw new Error("Another overlay is currently active.")}}else throw new Error("The overlay does not exist.");this.#t=e,e.showModal()}async close(e=this.#t){if(this.#e.has(e))if(this.#t){if(this.#t!==e)throw new Error("Another overlay is currently active.")}else throw new Error("The overlay is currently not active.");else throw new Error("The overlay does not exist.");e.close(),this.#t=null}async closeIfActive(e){this.#t===e&&await this.close(e)}}class Pn{#e=null;#t=null;#i=null;constructor(e,t,i=!1){this.dialog=e.dialog,this.label=e.label,this.input=e.input,this.submitButton=e.submitButton,this.cancelButton=e.cancelButton,this.overlayManager=t,this._isViewerEmbedded=i,this.submitButton.addEventListener("click",this.#n.bind(this)),this.cancelButton.addEventListener("click",this.close.bind(this)),this.input.addEventListener("keydown",n=>{n.keyCode===13&&this.#n()}),this.overlayManager.register(this.dialog,!0),this.dialog.addEventListener("close",this.#a.bind(this))}async open(){await this.#e?.promise,this.#e=Promise.withResolvers();try{await this.overlayManager.open(this.dialog)}catch(t){throw this.#e.resolve(),t}const e=this.#i===Mi.INCORRECT_PASSWORD;(!this._isViewerEmbedded||e)&&this.input.focus(),this.label.setAttribute("data-l10n-id",e?"pdfjs-password-invalid":"pdfjs-password-label")}async close(){this.overlayManager.closeIfActive(this.dialog)}#n(){const e=this.input.value;e?.length>0&&this.#s(e)}#a(){this.#s(new Error("PasswordPrompt cancelled.")),this.#e.resolve()}#s(e){this.#t&&(this.close(),this.input.value="",this.#t(e),this.#t=null)}async setUpdateCallback(e,t){this.#e&&await this.#e.promise,this.#t=e,this.#i=t}}const Sn=-100,Nt="selected";class be{constructor(e){if((typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))&&this.constructor===be)throw new Error("Cannot initialize BaseTreeViewer.");this.container=e.container,this.eventBus=e.eventBus,this._l10n=e.l10n,this.reset()}reset(){this._pdfDocument=null,this._lastToggleIsShow=!0,this._currentTreeItem=null,this.container.textContent="",this.container.classList.remove("treeWithDeepNesting")}_dispatchEvent(e){throw new Error("Not implemented: _dispatchEvent")}_bindLink(e,t){throw new Error("Not implemented: _bindLink")}_normalizeTextContent(e){return he(e,!0)||""}_addToggleButton(e,t=!1){const i=document.createElement("div");i.className="treeItemToggler",t&&i.classList.add("treeItemsHidden"),i.onclick=n=>{if(n.stopPropagation(),i.classList.toggle("treeItemsHidden"),n.shiftKey){const s=!i.classList.contains("treeItemsHidden");this._toggleTreeItem(e,s)}},e.prepend(i)}_toggleTreeItem(e,t=!1){this._l10n.pause(),this._lastToggleIsShow=t;for(const i of e.querySelectorAll(".treeItemToggler"))i.classList.toggle("treeItemsHidden",!t);this._l10n.resume()}_toggleAllTreeItems(){this._toggleTreeItem(this.container,!this._lastToggleIsShow)}_finishRendering(e,t,i=!1){i&&(this.container.classList.add("treeWithDeepNesting"),this._lastToggleIsShow=!e.querySelector(".treeItemsHidden")),this._l10n.pause(),this.container.append(e),this._l10n.resume(),this._dispatchEvent(t)}render(e){throw new Error("Not implemented: render")}_updateCurrentTreeItem(e=null){this._currentTreeItem&&(this._currentTreeItem.classList.remove(Nt),this._currentTreeItem=null),e&&(e.classList.add(Nt),this._currentTreeItem=e)}_scrollToCurrentTreeItem(e){if(!e)return;this._l10n.pause();let t=e.parentNode;for(;t&&t!==this.container;)t.classList.contains("treeItem")&&t.firstElementChild?.classList.remove("treeItemsHidden"),t=t.parentNode;this._l10n.resume(),this._updateCurrentTreeItem(e),this.container.scrollTo(e.offsetLeft,e.offsetTop+Sn)}}class _n extends be{constructor(e){super(e),this.downloadManager=e.downloadManager,this.eventBus._on("fileattachmentannotation",this.#e.bind(this))}reset(e=!1){super.reset(),this._attachments=null,e||(this._renderedCapability=Promise.withResolvers()),this._pendingDispatchEvent=!1}async _dispatchEvent(e){this._renderedCapability.resolve(),!(e===0&&!this._pendingDispatchEvent&&(this._pendingDispatchEvent=!0,await vi({target:this.eventBus,name:"annotationlayerrendered",delay:1e3}),!this._pendingDispatchEvent))&&(this._pendingDispatchEvent=!1,this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:e}))}_bindLink(e,{content:t,description:i,filename:n}){i&&(e.title=i),e.onclick=()=>(this.downloadManager.openOrDownloadData(t,n),!1)}render({attachments:e,keepRenderedCapability:t=!1}){if(this._attachments&&this.reset(t),this._attachments=e||null,!e){this._dispatchEvent(0);return}const i=document.createDocumentFragment();let n=0;for(const s in e){const a=e[s],o=document.createElement("div");o.className="treeItem";const l=document.createElement("a");this._bindLink(l,a),l.textContent=this._normalizeTextContent(a.filename),o.append(l),i.append(o),n++}this._finishRendering(i,n)}#e(e){const t=this._renderedCapability.promise;t.then(()=>{if(t!==this._renderedCapability.promise)return;const i=this._attachments||Object.create(null);for(const n in i)if(e.filename===n)return;i[e.filename]=e,this.render({attachments:i,keepRenderedCapability:!0})})}}const Mt="grab-to-pan-grab";class Cn{#e=null;#t=null;#i=null;constructor({element:e}){this.element=e,this.document=e.ownerDocument;const t=this.overlay=document.createElement("div");t.className="grab-to-pan-grabbing"}activate(){this.#e||(this.#e=new AbortController,this.element.addEventListener("mousedown",this.#n.bind(this),{capture:!0,signal:this.#e.signal}),this.element.classList.add(Mt))}deactivate(){this.#e&&(this.#e.abort(),this.#e=null,this.#s(),this.element.classList.remove(Mt))}toggle(){this.#e?this.deactivate():this.activate()}ignoreTarget(e){return e.matches("a[href], a[href] *, input, textarea, button, button *, select, option")}#n(e){if(e.button!==0||this.ignoreTarget(e.target))return;if(e.originalTarget)try{e.originalTarget.tagName}catch{return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=e.clientX,this.clientYStart=e.clientY,this.#t=new AbortController;const t=this.#s.bind(this),i={capture:!0,signal:this.#t.signal};this.document.addEventListener("mousemove",this.#a.bind(this),i),this.document.addEventListener("mouseup",t,i),this.#i=new AbortController,this.element.addEventListener("scroll",t,{capture:!0,signal:this.#i.signal}),Q(e);const n=document.activeElement;n&&!n.contains(e.target)&&n.blur()}#a(e){if(this.#i?.abort(),this.#i=null,!(e.buttons&1)){this.#s();return}const t=e.clientX-this.clientXStart,i=e.clientY-this.clientYStart;this.element.scrollTo({top:this.scrollTopStart-i,left:this.scrollLeftStart-t,behavior:"instant"}),this.overlay.parentNode||document.body.append(this.overlay)}#s(){this.#t?.abort(),this.#t=null,this.#i?.abort(),this.#i=null,this.overlay.remove()}}class Tn{#e=V.SELECT;#t=null;constructor({container:e,eventBus:t,cursorToolOnLoad:i=V.SELECT}){this.container=e,this.eventBus=t,this.#n(),Promise.resolve().then(()=>{this.switchTool(i)})}get activeTool(){return this.#e}switchTool(e){this.#t===null&&this.#i(e)}#i(e,t=!1){if(e===this.#e){this.#t!==null&&this.eventBus.dispatch("cursortoolchanged",{source:this,tool:e,disabled:t});return}const i=()=>{switch(this.#e){case V.SELECT:break;case V.HAND:this._handTool.deactivate();break}};switch(e){case V.SELECT:i();break;case V.HAND:i(),this._handTool.activate();break;case V.ZOOM:default:console.error(`switchTool: "${e}" is an unsupported value.`);return}this.#e=e,this.eventBus.dispatch("cursortoolchanged",{source:this,tool:e,disabled:t})}#n(){this.eventBus._on("switchcursortool",s=>{s.reset?this.#t!==null&&(e=L.NONE,t=R.NORMAL,n()):this.switchTool(s.tool)});let e=L.NONE,t=R.NORMAL;const i=()=>{this.#t??=this.#e,this.#i(V.SELECT,!0)},n=()=>{this.#t!==null&&e===L.NONE&&t===R.NORMAL&&(this.#i(this.#t),this.#t=null)};this.eventBus._on("annotationeditormodechanged",({mode:s})=>{e=s,s===L.NONE?n():i()}),this.eventBus._on("presentationmodechanged",({state:s})=>{t=s,s===R.NORMAL?n():s===R.FULLSCREEN&&i()})}get _handTool(){return O(this,"_handTool",new Cn({element:this.container}))}}const In=["en-us","en-lr","my"],Dn={"8.5x11":"pdfjs-document-properties-page-size-name-letter","8.5x14":"pdfjs-document-properties-page-size-name-legal"},Rt={"297x420":"pdfjs-document-properties-page-size-name-a-three","210x297":"pdfjs-document-properties-page-size-name-a-four"};function Ue(r,e,t){const i=e?r.width:r.height,n=e?r.height:r.width;return t[`${i}x${n}`]}class Ln{#e=null;constructor({dialog:e,fields:t,closeButton:i},n,s,a,o,l){this.dialog=e,this.fields=t,this.overlayManager=n,this.l10n=a,this._fileNameLookup=o,this._titleLookup=l,this.#t(),i.addEventListener("click",this.close.bind(this)),this.overlayManager.register(this.dialog),s._on("pagechanging",h=>{this._currentPageNumber=h.pageNumber}),s._on("rotationchanging",h=>{this._pagesRotation=h.pagesRotation})}async open(){await Promise.all([this.overlayManager.open(this.dialog),this._dataAvailableCapability.promise]);const e=this._currentPageNumber,t=this._pagesRotation;if(this.#e&&e===this.#e._currentPageNumber&&t===this.#e._pagesRotation){this.#i();return}const[{info:i,metadata:n,contentLength:s},a]=await Promise.all([this.pdfDocument.getMetadata(),this.pdfDocument.getPage(e)]),[o,l,h,d,c,u,p]=await Promise.all([this._fileNameLookup(),this.#n(s),this._titleLookup(),this.#s(n?.get("xmp:createdate"),i.CreationDate),this.#s(n?.get("xmp:modifydate"),i.ModDate),this.#a(Qi(a),t),this.#r(i.IsLinearized)]);this.#e=Object.freeze({fileName:o,fileSize:l,title:h,author:n?.get("dc:creator")?.join(`
`)||i.Author,subject:n?.get("dc:subject")?.join(`
`)||i.Subject,keywords:n?.get("pdf:keywords")||i.Keywords,creationDate:d,modificationDate:c,creator:n?.get("xmp:creatortool")||i.Creator,producer:n?.get("pdf:producer")||i.Producer,version:i.PDFFormatVersion,pageCount:this.pdfDocument.numPages,pageSize:u,linearized:p,_currentPageNumber:e,_pagesRotation:t}),this.#i();const{length:f}=await this.pdfDocument.getDownloadInfo();if(s===f)return;const v=Object.assign(Object.create(null),this.#e);v.fileSize=await this.#n(f),this.#e=Object.freeze(v),this.#i()}async close(){this.overlayManager.close(this.dialog)}setDocument(e){this.pdfDocument&&(this.#t(),this.#i()),e&&(this.pdfDocument=e,this._dataAvailableCapability.resolve())}#t(){this.pdfDocument=null,this.#e=null,this._dataAvailableCapability=Promise.withResolvers(),this._currentPageNumber=1,this._pagesRotation=0}#i(){if(!(this.#e&&this.overlayManager.active!==this.dialog))for(const e in this.fields){const t=this.#e?.[e];this.fields[e].textContent=t||t===0?t:"-"}}async#n(e=0){const t=e/1024,i=t/1024;return t?this.l10n.get(i>=1?"pdfjs-document-properties-size-mb":"pdfjs-document-properties-size-kb",{mb:i,kb:t,b:e}):void 0}async#a(e,t){if(!e)return;t%180!==0&&(e={width:e.height,height:e.width});const i=Ye(e),n=In.includes(this.l10n.getLanguage());let s={width:Math.round(e.width*100)/100,height:Math.round(e.height*100)/100},a={width:Math.round(e.width*25.4*10)/10,height:Math.round(e.height*25.4*10)/10},o=Ue(s,i,Dn)||Ue(a,i,Rt);if(!o&&!(Number.isInteger(a.width)&&Number.isInteger(a.height))){const p={width:e.width*25.4,height:e.height*25.4},f={width:Math.round(a.width),height:Math.round(a.height)};Math.abs(p.width-f.width)<.1&&Math.abs(p.height-f.height)<.1&&(o=Ue(f,i,Rt),o&&(s={width:Math.round(f.width/25.4*100)/100,height:Math.round(f.height/25.4*100)/100},a=f))}const[{width:l,height:h},d,c,u]=await Promise.all([n?s:a,this.l10n.get(n?"pdfjs-document-properties-page-size-unit-inches":"pdfjs-document-properties-page-size-unit-millimeters"),o&&this.l10n.get(o),this.l10n.get(i?"pdfjs-document-properties-page-size-orientation-portrait":"pdfjs-document-properties-page-size-orientation-landscape")]);return this.l10n.get(c?"pdfjs-document-properties-page-size-dimension-name-string":"pdfjs-document-properties-page-size-dimension-string",{width:l,height:h,unit:d,name:c,orientation:u})}async#s(e,t){const i=Date.parse(e)||Ri.toDateObject(t);return i?this.l10n.get("pdfjs-document-properties-date-time-string",{dateObj:i.valueOf()}):void 0}#r(e){return this.l10n.get(e?"pdfjs-document-properties-linearized-yes":"pdfjs-document-properties-linearized-no")}}const z={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function An(r){return r<11904}function xn(r){return(r&65408)===0}function Nn(r){return r>=97&&r<=122||r>=65&&r<=90}function Mn(r){return r>=48&&r<=57}function Rn(r){return r===32||r===9||r===13||r===10}function Bn(r){return r>=13312&&r<=40959||r>=63744&&r<=64255}function kn(r){return r>=12448&&r<=12543}function Fn(r){return r>=12352&&r<=12447}function On(r){return r>=65376&&r<=65439}function Vn(r){return(r&65408)===3584}function Ce(r){return An(r)?xn(r)?Rn(r)?z.SPACE:Nn(r)||Mn(r)||r===95?z.ALPHA_LETTER:z.PUNCT:Vn(r)?z.THAI_LETTER:r===160?z.SPACE:z.ALPHA_LETTER:Bn(r)?z.HAN_LETTER:kn(r)?z.KATAKANA_LETTER:Fn(r)?z.HIRAGANA_LETTER:On(r)?z.HALFWIDTH_KATAKANA_LETTER:z.ALPHA_LETTER}let We;function Hn(){if(We||="---------------------------------------------------------------------------------------------------",typeof PDFJSDev>"u"||PDFJSDev.test("TESTING")){const r=[],e=[],t=new RegExp("^\\p{M}$","u");for(let i=0;i<65536;i++){const n=String.fromCharCode(i);if(n.normalize("NFKC")!==n&&!t.test(n)){if(e.length!==2){e[0]=e[1]=i;continue}e[1]+1!==i?(e[0]===e[1]?r.push(String.fromCharCode(e[0])):r.push(`${String.fromCharCode(e[0])}-${String.fromCharCode(e[1])}`),e[0]=e[1]=i):e[1]=i}}if(r.join("")!==We)throw new Error("getNormalizeWithNFKC - update the `NormalizeWithNFKC` string.")}return We}const J={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},Un=250,Wn=-50,Bt={"":"-","":"'","":"'","":"'","":"'","":'"',"":'"',"":'"',"":'"',"":"1/4","":"1/2","":"3/4"},kt=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let Ft;const Jn=new RegExp("\\p{M}+","gu"),Gn=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),zn=new RegExp("([^\\p{M}])\\p{M}*$","u"),jn=new RegExp("^\\p{M}*([^\\p{M}])","u"),$n=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,Ot=new Map,Kn="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",Vt=new Map;let Je=null,Ge=null;function Ie(r,e={}){const t=[];let i;for(;(i=$n.exec(r))!==null;){let{index:w}=i;for(const b of i[0]){let E=Ot.get(b);E||(E=b.normalize("NFD").length,Ot.set(b,E)),t.push([E,w++])}}const n=t.length>0,s=e.ignoreDashEOL??!1;let a;if(!n&&Je)a=Je;else if(n&&Ge)a=Ge;else{const w=Object.keys(Bt).join(""),b=Hn(),D=[`[${w}]`,`[${b}]`,"(?:|)\\n","\\p{M}+(?:-\\n)?","\\p{Ll}-\\n(?=\\p{Ll})|\\p{Lu}-\\n(?=\\p{L})","\\S-\\n","(?:\\p{Ideographic}|[-])\\n","\\n",n?Kn:"\\u0000"];a=new RegExp(D.map(A=>`(${A})`).join("|"),"gum"),n?Ge=a:Je=a}const o=[];for(;(i=Jn.exec(r))!==null;)o.push([i[0].length,i.index]);let l=r.normalize("NFD");const h=[0,0];let d=0,c=0,u=0,p=0,f=0,v=!1;l=l.replace(a,(w,b,E,P,_,D,A,F,H,q,M)=>{if(M-=p,b){const N=Bt[b],B=N.length;for(let k=1;k<B;k++)h.push(M-u+k,u-k);return u-=B-1,N}if(E){let N=Vt.get(E);N||(N=E.normalize("NFKC"),Vt.set(E,N));const B=N.length;for(let k=1;k<B;k++)h.push(M-u+k,u-k);return u-=B-1,N}if(P)return v=!0,M+f===o[d]?.[1]?++d:(h.push(M-1-u+1,u-1),u-=1,p+=1),h.push(M-u+1,u),p+=1,f+=1,P.charAt(0);if(_){const N=_.endsWith(`
`),B=N?_.length-2:_.length;v=!0;let k=B;M+f===o[d]?.[1]&&(k-=o[d][0],++d);for(let se=1;se<=k;se++)h.push(M-1-u+se,u-se);return u-=k,p+=k,N?(M+=B-1,h.push(M-u+1,1+u),u+=1,p+=1,f+=1,_.slice(0,B)):_}if(D){if(s)return p+=1,f+=1,D.slice(0,-1);const N=D.length-2;return h.push(M-u+N,1+u),u+=1,p+=1,f+=1,D.slice(0,-2)}if(A)return p+=1,f+=1,A.slice(0,-1);if(F){const N=F.length-1;return h.push(M-u+N,u),p+=1,f+=1,F.slice(0,-1)}if(H)return h.push(M-u+1,u-1),u-=1,p+=1,f+=1," ";if(M+f===t[c]?.[1]){const N=t[c][0]-1;++c;for(let B=1;B<=N;B++)h.push(M-(u-B),u-B);u-=N,p+=N}return q}),h.push(l.length,u);const y=new Uint32Array(h.length>>1),S=new Int32Array(h.length>>1);for(let w=0,b=h.length;w<b;w+=2)y[w>>1]=h[w],S[w>>1]=h[w+1];return[l,[y,S],v]}function Ei(r,e,t){if(!r)return[e,t];const[i,n]=r,s=e,a=e+t-1;let o=Ee(i,u=>u>=s);i[o]>s&&--o;let l=Ee(i,u=>u>=a,o);i[l]>a&&--l;const h=s+n[o],c=a+n[l]+1-h;return[h,c]}class Xn{#e=null;#t=!0;#i=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:i=!0}){this._linkService=e,this._eventBus=t,this.#t=i,this.onIsPageVisible=null,this.#a(),t._on("find",this.#n.bind(this)),t._on("findbarclose",this.#T.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#a(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#n(e){if(!e)return;const t=this._pdfDocument,{type:i}=e;(this.#e===null||this.#r(e))&&(this._dirtyMatch=!0),this.#e=e,i!=="highlightallchange"&&this.#m(J.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#d();const n=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),i?this._dirtyMatch?this.#f():i==="again"?(this.#f(),n&&this.#e.highlightAll&&this.#u()):i==="highlightallchange"?(s?this.#f():this._highlightMatches=!0,this.#u()):this.#f():this._findTimeout=setTimeout(()=>{this.#f(),this._findTimeout=null},Un)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:i=-1,matchIndex:n=-1}){if(!this._scrollMatches||!e)return;if(n===-1||n!==this._selected.matchIdx)return;if(i===-1||i!==this._selected.pageIdx)return;this._scrollMatches=!1,at(e,{top:Wn,left:t},!0)}#a(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#i=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#s(){const{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=Ie(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>Ie(t)[0])}#r(e){const t=e.query,i=this.#e.query,n=typeof t;if(n!==typeof i)return!0;if(n==="string"){if(t!==i)return!0}else if(JSON.stringify(t)!==JSON.stringify(i))return!0;switch(e.type){case"again":const a=this._selected.pageIdx+1,o=this._linkService;return a>=1&&a<=o.pagesCount&&a!==o.page&&!(this.onIsPageVisible?.(a)??!0);case"highlightallchange":return!1}return!0}#o(e,t,i){let n=e.slice(0,t).match(zn);if(n){const s=e.charCodeAt(t),a=n[1].charCodeAt(0);if(Ce(s)===Ce(a))return!1}if(n=e.slice(t+i).match(jn),n){const s=e.charCodeAt(t+i-1),a=n[1].charCodeAt(0);if(Ce(s)===Ce(a))return!1}return!0}#h(e,t){const{matchDiacritics:i}=this.#e;let n=!1;e=e.replaceAll(Gn,(a,o,l,h,d,c)=>o?`[ ]*\\${o}[ ]*`:l?`[ ]*${l}[ ]*`:h?"[ ]+":i?d||c:d?kt.has(d.charCodeAt(0))?d:"":t?(n=!0,`${c}\\p{M}*`):c);const s="[ ]*";return e.endsWith(s)&&(e=e.slice(0,e.length-s.length)),i&&t&&(Ft||=String.fromCharCode(...kt),n=!0,e=`${e}(?=[${Ft}]|[^\\p{M}]|$)`),[n,e]}#l(e){if(!this.#e)return;const t=this.#s;if(t.length===0)return;const i=this._pageContents[e],n=this.match(t,i,e),s=this._pageMatches[e]=[],a=this._pageMatchesLength[e]=[],o=this._pageDiffs[e];n?.forEach(({index:h,length:d})=>{const[c,u]=Ei(o,h,d);u&&(s.push(c),a.push(u))}),this.#e.highlightAll&&this.#c(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#p());const l=s.length;this._matchesCountTotal+=l,this.#t?l>0&&this.#w():++this.#i===this._linkService.pagesCount&&this.#w()}match(e,t,i){const n=this._hasDiacritics[i];let s=!1;if(typeof e=="string"?[s,e]=this.#h(e,n):e=e.sort().reverse().map(c=>{const[u,p]=this.#h(c,n);return s||=u,`(${p})`}).join("|"),!e)return;const{caseSensitive:a,entireWord:o}=this.#e,l=`g${s?"u":""}${a?"":"i"}`;e=new RegExp(e,l);const h=[];let d;for(;(d=e.exec(t))!==null;)o&&!this.#o(t,d.index,d[0].length)||h.push({index:d.index,length:d[0].length});return h}#d(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve();const t={disableNormalization:!0},i=this._pdfDocument;for(let n=0,s=this._linkService.pagesCount;n<s;n++){const{promise:a,resolve:o}=Promise.withResolvers();this._extractTextPromises[n]=a,e=e.then(async()=>{if(i!==this._pdfDocument){o();return}await i.getPage(n+1).then(l=>l.getTextContent(t)).then(l=>{const h=[];for(const d of l.items)h.push(d.str),d.hasEOL&&h.push(`
`);[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=Ie(h.join("")),o()},l=>{console.error(`Unable to get text content for page ${n+1}`,l),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,o()})})}}#c(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#u(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#f(){const e=this.#e.findPrevious,t=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#i=0,this._matchesCountTotal=0,this.#u();for(let a=0;a<i;a++)this._pendingFindMatches.has(a)||(this._pendingFindMatches.add(a),this._extractTextPromises[a].then(()=>{this._pendingFindMatches.delete(a),this.#l(a)}))}if(this.#s.length===0){this.#m(J.FOUND);return}if(this._resumePageIdx)return;const s=this._offset;if(this._pagesToSearch=i,s.matchIdx!==null){const a=this._pageMatches[s.pageIdx].length;if(!e&&s.matchIdx+1<a||e&&s.matchIdx>0){s.matchIdx=e?s.matchIdx-1:s.matchIdx+1,this.#g(!0);return}this.#E(e)}this.#p()}#v(e){const t=this._offset,i=e.length,n=this.#e.findPrevious;return i?(t.matchIdx=n?i-1:0,this.#g(!0),!0):(this.#E(n),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#g(!1),!0):!1)}#p(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{const t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#v(e))}#E(e){const t=this._offset,i=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=i||t.pageIdx<0)&&(t.pageIdx=e?i-1:0,t.wrapped=!0)}#g(e=!1){let t=J.NOT_FOUND;const i=this._offset.wrapped;if(this._offset.wrapped=!1,e){const n=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=i?J.WRAPPED:J.FOUND,n!==-1&&n!==this._selected.pageIdx&&this.#c(n)}this.#m(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#c(this._selected.pageIdx))}#T(e){const t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#m(J.FOUND),this._highlightMatches=!1,this.#u())})}#P(){const{pageIdx:e,matchIdx:t}=this._selected;let i=0,n=this._matchesCountTotal;if(t!==-1){for(let s=0;s<e;s++)i+=this._pageMatches[s]?.length||0;i+=t+1}return(i<1||i>n)&&(i=n=0),{current:i,total:n}}#w(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#P()})}#m(e,t=!1){!this.#t&&(this.#i!==this._linkService.pagesCount||e===J.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#P(),rawQuery:this.#e?.query??null})}}const Zn=1e3;class Yn{#e;#t=new ResizeObserver(this.#i.bind(this));constructor(e,t,i){this.opened=!1,this.bar=e.bar,this.toggleButton=e.toggleButton,this.findField=e.findField,this.highlightAll=e.highlightAllCheckbox,this.caseSensitive=e.caseSensitiveCheckbox,this.matchDiacritics=e.matchDiacriticsCheckbox,this.entireWord=e.entireWordCheckbox,this.findMsg=e.findMsg,this.findResultsCount=e.findResultsCount,this.findPreviousButton=e.findPreviousButton,this.findNextButton=e.findNextButton,this.eventBus=i,this.#e=t;const n=new Map([[this.highlightAll,"highlightallchange"],[this.caseSensitive,"casesensitivitychange"],[this.entireWord,"entirewordchange"],[this.matchDiacritics,"diacriticmatchingchange"]]);this.toggleButton.addEventListener("click",()=>{this.toggle()}),this.findField.addEventListener("input",()=>{this.dispatchEvent("")}),this.bar.addEventListener("keydown",({keyCode:s,shiftKey:a,target:o})=>{switch(s){case 13:o===this.findField?this.dispatchEvent("again",a):n.has(o)&&(o.checked=!o.checked,this.dispatchEvent(n.get(o)));break;case 27:this.close();break}}),this.findPreviousButton.addEventListener("click",()=>{this.dispatchEvent("again",!0)}),this.findNextButton.addEventListener("click",()=>{this.dispatchEvent("again",!1)});for(const[s,a]of n)s.addEventListener("click",()=>{this.dispatchEvent(a)})}reset(){this.updateUIState()}dispatchEvent(e,t=!1){this.eventBus.dispatch("find",{source:this,type:e,query:this.findField.value,caseSensitive:this.caseSensitive.checked,entireWord:this.entireWord.checked,highlightAll:this.highlightAll.checked,findPrevious:t,matchDiacritics:this.matchDiacritics.checked})}updateUIState(e,t,i){const{findField:n,findMsg:s}=this;let a="",o="";switch(e){case J.FOUND:break;case J.PENDING:o="pending";break;case J.NOT_FOUND:a="pdfjs-find-not-found",o="notFound";break;case J.WRAPPED:a=t?"pdfjs-find-reached-top":"pdfjs-find-reached-bottom";break}n.setAttribute("data-status",o),n.setAttribute("aria-invalid",e===J.NOT_FOUND),s.setAttribute("data-status",o),a?s.setAttribute("data-l10n-id",a):(s.removeAttribute("data-l10n-id"),s.textContent=""),this.updateResultsCount(i)}updateResultsCount({current:e=0,total:t=0}={}){const{findResultsCount:i}=this;if(t>0){const n=Zn;i.setAttribute("data-l10n-id",t>n?"pdfjs-find-match-count-limit":"pdfjs-find-match-count"),i.setAttribute("data-l10n-args",JSON.stringify({limit:n,current:e,total:t}))}else i.removeAttribute("data-l10n-id"),i.textContent=""}open(){this.opened||(this.#t.observe(this.#e),this.#t.observe(this.bar),this.opened=!0,X(this.toggleButton,!0,this.bar)),this.findField.select(),this.findField.focus()}close(){this.opened&&(this.#t.disconnect(),this.opened=!1,X(this.toggleButton,!1,this.bar),this.eventBus.dispatch("findbarclose",{source:this}))}toggle(){this.opened?this.close():this.open()}#i(){const{bar:e}=this;e.classList.remove("wrapContainers");const t=e.clientHeight,i=e.firstElementChild.clientHeight;t>i&&e.classList.add("wrapContainers")}}const Qn=1e3,qn=50,es=1e3;function ze(){return document.location.hash}class ts{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",i=>{this._isPagesLoaded=!!i.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:i=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const n=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=i===!0,this._initialized=!0,this.#d();const s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=ze(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#a(s,!0)||t){const{hash:o,page:l,rotation:h}=this.#r(!0);if(!o||n||t){this.#t(null,!0);return}this.#t({hash:o,page:l,rotation:h},!0);return}const a=s.destination;this.#s(a,s.uid,!0),a.rotation!==void 0&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(this.#l(),this._initialized=!1,this.#c()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:i}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#n(i)&&(i!==null||this._destination)){console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}const n=e||JSON.stringify(t);if(!n)return;let s=!1;if(this._destination&&(is(this._destination.hash,n)||ns(this._destination.dest,t))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#t({dest:t,hash:n,page:i,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#n(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#i()}back(){if(!this._initialized||this._popStateInProgress)return;const e=window.history.state;this.#a(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const e=window.history.state;this.#a(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){const i=t||!this._destination,n={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:e};typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")&&window.history.state?.chromecomState&&(n.chromecomState=window.history.state.chromecomState),this.#s(e,n.uid);let s;if(this._updateUrl&&e?.hash){const{href:a,protocol:o}=document.location;o!=="file:"&&(s=le(a,e.hash))}i?window.history.replaceState(n,"",s):window.history.pushState(n,"",s)}#i(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&this._numPositionUpdates<=qn)return;let i=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;i=!0}this.#t(t,i)}#n(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#a(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;const[i]=performance.getEntriesByType("navigation");if(i?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#s(e,t,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#r(e=!1){const t=unescape(ze()).substring(1),i=ve(t),n=i.get("nameddest")||"";let s=i.get("page")|0;return(!this.#n(s)||e&&n.length>0)&&(s=null),{hash:t,page:s,rotation:this.linkService.rotation}}#o({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#i(!0),this._updateViewareaTimeout=null},es))}#h({state:e}){const t=ze(),i=this._currentHash!==t;if(this._currentHash=t,typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")&&e?.chromecomState&&!this.#a(e)||!e){this._uid++;const{hash:s,page:a,rotation:o}=this.#r();this.#t({hash:s,page:a,rotation:o},!0);return}if(!this.#a(e))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,vi({target:window,name:"hashchange",delay:Qn}).then(()=>{this._blockHashChange--}));const n=e.destination;this.#s(n,e.uid,!0),Be(n.rotation)&&(this.linkService.rotation=n.rotation),n.dest?this.linkService.goToDestination(n.dest):n.hash?this.linkService.setHash(n.hash):n.page&&(this.linkService.page=n.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#l(){(!this._destination||this._destination.temporary)&&this.#i()}#d(){if(this.#e)return;this.#e=new AbortController;const{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#o.bind(this),{signal:e}),window.addEventListener("popstate",this.#h.bind(this),{signal:e}),window.addEventListener("pagehide",this.#l.bind(this),{signal:e})}#c(){this.#e?.abort(),this.#e=null}}function is(r,e){return typeof r!="string"||typeof e!="string"?!1:r===e||ve(r).get("nameddest")===e}function ns(r,e){function t(i,n){if(typeof i!=typeof n||Array.isArray(i)||Array.isArray(n))return!1;if(i!==null&&typeof i=="object"&&n!==null){if(Object.keys(i).length!==Object.keys(n).length)return!1;for(const s in i)if(!t(i[s],n[s]))return!1;return!0}return i===n||Number.isNaN(i)&&Number.isNaN(n)}if(!(Array.isArray(r)&&Array.isArray(e))||r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}class ss extends be{constructor(e){super(e),this.eventBus._on("optionalcontentconfigchanged",t=>{this.#e(t.promise)}),this.eventBus._on("resetlayers",()=>{this.#e()}),this.eventBus._on("togglelayerstree",this._toggleAllTreeItems.bind(this))}reset(){super.reset(),this._optionalContentConfig=null,this._optionalContentVisibility?.clear(),this._optionalContentVisibility=null}_dispatchEvent(e){this.eventBus.dispatch("layersloaded",{source:this,layersCount:e})}_bindLink(e,{groupId:t,input:i}){const n=()=>{const s=i.checked;this._optionalContentConfig.setVisibility(t,s);const a=this._optionalContentVisibility.get(t);a&&(a.visible=s),this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(this._optionalContentConfig)})};e.onclick=s=>s.target===i?(n(),!0):s.target!==e?!0:(i.checked=!i.checked,n(),!1)}_setNestedName(e,{name:t=null}){if(typeof t=="string"){e.textContent=this._normalizeTextContent(t);return}e.setAttribute("data-l10n-id","pdfjs-additional-layers"),e.style.fontStyle="italic",this._l10n.translateOnce(e)}_addToggleButton(e,{name:t=null}){super._addToggleButton(e,t===null)}_toggleAllTreeItems(){this._optionalContentConfig&&super._toggleAllTreeItems()}render({optionalContentConfig:e,pdfDocument:t}){this._optionalContentConfig&&this.reset(),this._optionalContentConfig=e||null,this._pdfDocument=t||null;const i=e?.getOrder();if(!i){this._dispatchEvent(0);return}this._optionalContentVisibility=new Map;const n=document.createDocumentFragment(),s=[{parent:n,groups:i}];let a=0,o=!1;for(;s.length>0;){const l=s.shift();for(const h of l.groups){const d=document.createElement("div");d.className="treeItem";const c=document.createElement("a");if(d.append(c),typeof h=="object"){o=!0,this._addToggleButton(d,h),this._setNestedName(c,h);const u=document.createElement("div");u.className="treeItems",d.append(u),s.push({parent:u,groups:h.order})}else{const u=e.getGroup(h),p=document.createElement("input");this._bindLink(c,{groupId:h,input:p}),p.type="checkbox",p.checked=u.visible,this._optionalContentVisibility.set(h,{input:p,visible:p.checked});const f=document.createElement("label");f.textContent=this._normalizeTextContent(u.name),f.append(p),c.append(f),a++}l.parent.append(d)}}this._finishRendering(n,a,o)}async#e(e=null){if(!this._optionalContentConfig)return;const t=this._pdfDocument,i=await(e||t.getOptionalContentConfig({intent:"display"}));if(t===this._pdfDocument){if(e){for(const[n,s]of this._optionalContentVisibility){const a=i.getGroup(n);a&&s.visible!==a.visible&&(s.input.checked=s.visible=!s.visible)}return}this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(i)}),this.render({optionalContentConfig:i,pdfDocument:this._pdfDocument})}}}class as extends be{constructor(e){super(e),this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.eventBus._on("toggleoutlinetree",this._toggleAllTreeItems.bind(this)),this.eventBus._on("currentoutlineitem",this._currentOutlineItem.bind(this)),this.eventBus._on("pagechanging",t=>{this._currentPageNumber=t.pageNumber}),this.eventBus._on("pagesloaded",t=>{this._isPagesLoaded=!!t.pagesCount,this._currentOutlineItemCapability?.resolve(this._isPagesLoaded)}),this.eventBus._on("sidebarviewchanged",t=>{this._sidebarView=t.view})}reset(){super.reset(),this._outline=null,this._pageNumberToDestHashCapability=null,this._currentPageNumber=1,this._isPagesLoaded=null,this._currentOutlineItemCapability?.resolve(!1),this._currentOutlineItemCapability=null}_dispatchEvent(e){this._currentOutlineItemCapability=Promise.withResolvers(),e===0||this._pdfDocument?.loadingParams.disableAutoFetch?this._currentOutlineItemCapability.resolve(!1):this._isPagesLoaded!==null&&this._currentOutlineItemCapability.resolve(this._isPagesLoaded),this.eventBus.dispatch("outlineloaded",{source:this,outlineCount:e,currentOutlineItemPromise:this._currentOutlineItemCapability.promise})}_bindLink(e,{url:t,newWindow:i,action:n,attachment:s,dest:a,setOCGState:o}){const{linkService:l}=this;if(t){l.addLinkAttributes(e,t,i);return}if(n){e.href=l.getAnchorUrl(""),e.onclick=()=>(l.executeNamedAction(n),!1);return}if(s){e.href=l.getAnchorUrl(""),e.onclick=()=>(this.downloadManager.openOrDownloadData(s.content,s.filename),!1);return}if(o){e.href=l.getAnchorUrl(""),e.onclick=()=>(l.executeSetOCGState(o),!1);return}e.href=l.getDestinationHash(a),e.onclick=h=>(this._updateCurrentTreeItem(h.target.parentNode),a&&l.goToDestination(a),!1)}_setStyles(e,{bold:t,italic:i}){t&&(e.style.fontWeight="bold"),i&&(e.style.fontStyle="italic")}_addToggleButton(e,{count:t,items:i}){let n=!1;if(t<0){let s=i.length;if(s>0){const a=[...i];for(;a.length>0;){const{count:o,items:l}=a.shift();o>0&&l.length>0&&(s+=l.length,a.push(...l))}}Math.abs(t)===s&&(n=!0)}super._addToggleButton(e,n)}_toggleAllTreeItems(){this._outline&&super._toggleAllTreeItems()}render({outline:e,pdfDocument:t}){if(this._outline&&this.reset(),this._outline=e||null,this._pdfDocument=t||null,!e){this._dispatchEvent(0);return}const i=document.createDocumentFragment(),n=[{parent:i,items:e}];let s=0,a=!1;for(;n.length>0;){const o=n.shift();for(const l of o.items){const h=document.createElement("div");h.className="treeItem";const d=document.createElement("a");if(this._bindLink(d,l),this._setStyles(d,l),d.textContent=this._normalizeTextContent(l.title),h.append(d),l.items.length>0){a=!0,this._addToggleButton(h,l);const c=document.createElement("div");c.className="treeItems",h.append(c),n.push({parent:c,items:l.items})}o.parent.append(h),s++}}this._finishRendering(i,s,a)}async _currentOutlineItem(){if(!this._isPagesLoaded)throw new Error("_currentOutlineItem: All pages have not been loaded.");if(!this._outline||!this._pdfDocument)return;const e=await this._getPageNumberToDestHash(this._pdfDocument);if(e&&(this._updateCurrentTreeItem(null),this._sidebarView===I.OUTLINE))for(let t=this._currentPageNumber;t>0;t--){const i=e.get(t);if(!i)continue;const n=this.container.querySelector(`a[href="${i}"]`);if(n){this._scrollToCurrentTreeItem(n.parentNode);break}}}async _getPageNumberToDestHash(e){if(this._pageNumberToDestHashCapability)return this._pageNumberToDestHashCapability.promise;this._pageNumberToDestHashCapability=Promise.withResolvers();const t=new Map,i=new Map,n=[{nesting:0,items:this._outline}];for(;n.length>0;){const s=n.shift(),a=s.nesting;for(const{dest:o,items:l}of s.items){let h,d;if(typeof o=="string"){if(h=await e.getDestination(o),e!==this._pdfDocument)return null}else h=o;if(Array.isArray(h)){const[c]=h;if(c&&typeof c=="object"?d=e.cachedPageNumber(c):Number.isInteger(c)&&(d=c+1),Number.isInteger(d)&&(!t.has(d)||a>i.get(d))){const u=this.linkService.getDestinationHash(o);t.set(d,u),i.set(d,a)}}l.length>0&&n.push({nesting:a+1,items:l})}}return this._pageNumberToDestHashCapability.resolve(t.size>0?t:null),this._pageNumberToDestHashCapability.promise}}const rs=3e3,Ht="pdfPresentationMode",je="pdfPresentationModeControls",os=50,ls=.1,Ut=50,$e=Math.PI/6;class hs{#e=R.UNKNOWN;#t=null;#i=null;#n=null;constructor({container:e,pdfViewer:t,eventBus:i}){this.container=e,this.pdfViewer=t,this.eventBus=i,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}async request(){const{container:e,pdfViewer:t}=this;if(this.active||!t.pagesCount||!e.requestFullscreen)return!1;this.#E(),this.#s(R.CHANGING);const i=e.requestFullscreen();this.#t={pageNumber:t.currentPageNumber,scaleValue:t.currentScaleValue,scrollMode:t.scrollMode,spreadMode:null,annotationEditorMode:null},t.spreadMode!==x.NONE&&!(t.pageViewsReady&&t.hasEqualPageSizes)&&(console.warn("Ignoring Spread modes when entering PresentationMode, since the document may contain varying page sizes."),this.#t.spreadMode=t.spreadMode),t.annotationEditorMode!==L.DISABLE&&(this.#t.annotationEditorMode=t.annotationEditorMode);try{return await i,t.focus(),!0}catch{this.#g(),this.#s(R.NORMAL)}return!1}get active(){return this.#e===R.CHANGING||this.#e===R.FULLSCREEN}#a(e){if(!this.active)return;e.preventDefault();const t=en(e),i=Date.now(),n=this.mouseScrollTimeStamp;if(!(i>n&&i-n<os)&&((this.mouseScrollDelta>0&&t<0||this.mouseScrollDelta<0&&t>0)&&this.#u(),this.mouseScrollDelta+=t,Math.abs(this.mouseScrollDelta)>=ls)){const s=this.mouseScrollDelta;this.#u(),(s>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=i)}}#s(e){this.#e=e,this.eventBus.dispatch("presentationmodechanged",{source:this,state:e})}#r(){this.#s(R.FULLSCREEN),this.container.classList.add(Ht),setTimeout(()=>{this.pdfViewer.scrollMode=C.PAGE,this.#t.spreadMode!==null&&(this.pdfViewer.spreadMode=x.NONE),this.pdfViewer.currentPageNumber=this.#t.pageNumber,this.pdfViewer.currentScaleValue="page-fit",this.#t.annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode={mode:L.NONE})},0),this.#v(),this.#d(),this.contextMenuOpen=!1,document.getSelection().empty()}#o(){const e=this.pdfViewer.currentPageNumber;this.container.classList.remove(Ht),setTimeout(()=>{this.#g(),this.#s(R.NORMAL),this.pdfViewer.scrollMode=this.#t.scrollMode,this.#t.spreadMode!==null&&(this.pdfViewer.spreadMode=this.#t.spreadMode),this.pdfViewer.currentScaleValue=this.#t.scaleValue,this.pdfViewer.currentPageNumber=e,this.#t.annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode={mode:this.#t.annotationEditorMode}),this.#t=null},0),this.#p(),this.#c(),this.#u(),this.contextMenuOpen=!1}#h(e){if(this.contextMenuOpen){this.contextMenuOpen=!1,e.preventDefault();return}e.button===0&&(e.target.href&&e.target.parentNode?.hasAttribute("data-internal-link")||(e.preventDefault(),e.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))}#l(){this.contextMenuOpen=!0}#d(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(je),this.controlsTimeout=setTimeout(()=>{this.container.classList.remove(je),delete this.controlsTimeout},rs)}#c(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(je),delete this.controlsTimeout)}#u(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0}#f(e){if(this.active){if(e.touches.length>1){this.touchSwipeState=null;return}switch(e.type){case"touchstart":this.touchSwipeState={startX:e.touches[0].pageX,startY:e.touches[0].pageY,endX:e.touches[0].pageX,endY:e.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null)return;this.touchSwipeState.endX=e.touches[0].pageX,this.touchSwipeState.endY=e.touches[0].pageY,e.preventDefault();break;case"touchend":if(this.touchSwipeState===null)return;let t=0;const i=this.touchSwipeState.endX-this.touchSwipeState.startX,n=this.touchSwipeState.endY-this.touchSwipeState.startY,s=Math.abs(Math.atan2(n,i));Math.abs(i)>Ut&&(s<=$e||s>=Math.PI-$e)?t=i:Math.abs(n)>Ut&&Math.abs(s-Math.PI/2)<=$e&&(t=n),t>0?this.pdfViewer.previousPage():t<0&&this.pdfViewer.nextPage();break}}}#v(){if(this.#n)return;this.#n=new AbortController;const{signal:e}=this.#n,t=this.#f.bind(this);window.addEventListener("mousemove",this.#d.bind(this),{signal:e}),window.addEventListener("mousedown",this.#h.bind(this),{signal:e}),window.addEventListener("wheel",this.#a.bind(this),{passive:!1,signal:e}),window.addEventListener("keydown",this.#u.bind(this),{signal:e}),window.addEventListener("contextmenu",this.#l.bind(this),{signal:e}),window.addEventListener("touchstart",t,{signal:e}),window.addEventListener("touchmove",t,{signal:e}),window.addEventListener("touchend",t,{signal:e})}#p(){this.#n?.abort(),this.#n=null}#E(){this.#i||(this.#i=new AbortController,window.addEventListener("fullscreenchange",()=>{document.fullscreenElement?this.#r():this.#o()},{signal:this.#i.signal}))}#g(){this.#i?.abort(),this.#i=null}}class bi{constructor({pdfPage:e,annotationStorage:t=null,linkService:i,xfaHtml:n=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=i,this.xfaHtml=n,this.div=null,this._cancelled=!1}async render({viewport:e,intent:t="display"}){if(t==="print"){const s={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),s.div=this.div,Fe.render(s)}const i=await this.pdfPage.getXfa();if(this._cancelled||!i)return{textDivs:[]};const n={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?Fe.update(n):(this.div=document.createElement("div"),n.div=this.div,Fe.render(n))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}function ds(r,e){const t=e.allXfaHtml,i=new ot,n=Math.round($.PDF_TO_CSS_UNITS*100)/100;for(const s of t.children){const a=document.createElement("div");a.className="xfaPrintedPage",r.append(a);const o=new bi({pdfPage:null,annotationStorage:e.annotationStorage,linkService:i,xfaHtml:s}),l=Bi(s,{scale:n});o.render({viewport:l,intent:"print"}),a.append(o.div)}}let W=null,ie=null,de=null,wi={};function cs(r,e,t,i,n,s,a){const o=W.scratchCanvas,l=n/$.PDF;o.width=Math.floor(i.width*l),o.height=Math.floor(i.height*l);const h=o.getContext("2d");return h.save(),h.fillStyle="rgb(255, 255, 255)",h.fillRect(0,0,o.width,o.height),h.restore(),Promise.all([e.getPage(t),a]).then(function([d,c]){const u={canvasContext:h,transform:[l,0,0,l,0,0],viewport:d.getViewport({scale:1,rotation:i.rotation}),intent:"print",annotationMode:Y.ENABLE_STORAGE,optionalContentConfigPromise:s,printAnnotationStorage:c};return d.render(u).promise.catch(f=>{throw f instanceof me||console.error(f),f})})}class us{constructor({pdfDocument:e,pagesOverview:t,printContainer:i,printResolution:n,printAnnotationStoragePromise:s=null}){this.pdfDocument=e,this.pagesOverview=t,this.printContainer=i,this._printResolution=n||150,this._optionalContentConfigPromise=e.getOptionalContentConfig({intent:"print"}),this._printAnnotationStoragePromise=s||Promise.resolve(),this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}layout(){this.throwIfInactive();const e=document.querySelector("body");e.setAttribute("data-pdfjsprinting",!0);const{width:t,height:i}=this.pagesOverview[0];this.pagesOverview.every(s=>s.width===t&&s.height===i)||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style"),this.pageStyleSheet.textContent=`@page { size: ${t}pt ${i}pt;}`,e.append(this.pageStyleSheet)}destroy(){if(W!==this)return;this.printContainer.textContent="",document.querySelector("body").removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,W=null,et().then(function(){de.closeIfActive(ie)})}renderPages(){if(this.pdfDocument.isPureXfa)return ds(this.printContainer,this.pdfDocument),Promise.resolve();const e=this.pagesOverview.length,t=(i,n)=>{if(this.throwIfInactive(),++this.currentPage>=e){Wt(e,e),i();return}const s=this.currentPage;Wt(s,e),cs(this,this.pdfDocument,s+1,this.pagesOverview[s],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then(function(){t(i,n)},n)};return new Promise(t)}useRenderedPage(){this.throwIfInactive();const e=document.createElement("img");this.scratchCanvas.toBlob(a=>{e.src=URL.createObjectURL(a)});const t=document.createElement("div");t.className="printedPage",t.append(e),this.printContainer.append(t);const{promise:i,resolve:n,reject:s}=Promise.withResolvers();return e.onload=n,e.onerror=s,i.catch(()=>{}).then(()=>{URL.revokeObjectURL(e.src)}),i}performPrint(){return this.throwIfInactive(),new Promise(e=>{setTimeout(()=>{if(!this.active){e();return}fs.call(window),setTimeout(e,20)},0)})}get active(){return this===W}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}const fs=window.print;window.print=function(){if(W){console.warn("Ignored window.print() because of a pending print job.");return}et().then(function(){W&&de.open(ie)});try{yi("beforeprint")}finally{if(!W)console.error("Expected print service to be initialized."),et().then(function(){de.closeIfActive(ie)});else{const r=W;W.renderPages().then(()=>r.performPrint()).catch(()=>{}).then(()=>{r.active&&qe()})}}};function yi(r){const e=new CustomEvent(r,{bubbles:!1,cancelable:!1,detail:"custom"});window.dispatchEvent(e)}function qe(){W&&(W.destroy(),yi("afterprint"))}function Wt(r,e){if(typeof PDFJSDev>"u"&&window.isGECKOVIEW)return;ie||=document.getElementById("printServiceDialog");const t=Math.round(100*r/e),i=ie.querySelector("progress"),n=ie.querySelector(".relative-progress");i.value=t,n.setAttribute("data-l10n-args",JSON.stringify({progress:t}))}window.addEventListener("keydown",function(r){r.keyCode===80&&(r.ctrlKey||r.metaKey)&&!r.altKey&&(!r.shiftKey||window.chrome||window.opera)&&(window.print(),r.preventDefault(),r.stopImmediatePropagation())},!0);if("onbeforeprint"in window){const r=function(e){e.detail!=="custom"&&e.stopImmediatePropagation()};window.addEventListener("beforeprint",r),window.addEventListener("afterprint",r)}let Ke;function et(){if(typeof PDFJSDev>"u"&&window.isGECKOVIEW)return Promise.reject(new Error("ensureOverlay not implemented in GECKOVIEW development mode."));if(!Ke){if(de=wi.overlayManager,!de)throw new Error("The overlay manager has not yet been initialized.");ie||=document.getElementById("printServiceDialog"),Ke=de.register(ie,!0),document.getElementById("printCancel").onclick=qe,ie.addEventListener("close",qe)}return Ke}class tt{static initGlobals(e){wi=e}static get supportsPrinting(){return O(this,"supportsPrinting",!0)}static createPrintService(e){if(W)throw new Error("The print service is created and active.");return W=new us(e)}}const gs=3e4;class Pi{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),gs)))}getHighestPriority(e,t,i,n=!1,s=!1){const a=e.views,o=a.length;if(o===0)return null;for(let u=0;u<o;u++){const p=a[u].view;if(!this.isViewFinished(p))return p}if(!s)for(let u=0;u<o;u++){const{detailView:p}=a[u].view;if(p&&!this.isViewFinished(p))return p}const l=e.first.id,h=e.last.id;if(h-l+1>o){const u=e.ids;for(let p=1,f=h-l;p<f;p++){const v=i?l+p:h-p;if(u.has(v))continue;const y=t[v-1];if(!this.isViewFinished(y))return y}}let d=i?h:l-2,c=t[d];return c&&!this.isViewFinished(c)||n&&(d+=i?1:-1,c=t[d],c&&!this.isViewFinished(c))?c:null}isViewFinished(e){return e.renderingState===T.FINISHED}renderView(e){switch(e.renderingState){case T.FINISHED:return!1;case T.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case T.RUNNING:this.highestPriorityPage=e.renderingId;break;case T.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof me||console.error("renderView:",t)});break}return!0}}class ps{#e=null;#t=null;#i=null;#n=null;#a=null;#s=null;#r=null;#o=null;#h=!1;#l=null;#d=null;constructor({eventBus:e,externalServices:t=null,docProperties:i=null}){this.#a=e,this.#s=t,this.#i=i,typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING")&&Object.defineProperty(this,"sandboxTrip",{value:()=>setTimeout(()=>this.#l?.dispatchEventInSandbox({name:"sandboxtripbegin"}),0)})}setViewer(e){this.#o=e}async setDocument(e){if(this.#r&&await this.#p(),this.#r=e,!e)return;const[t,i,n]=await Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!n){await this.#p();return}if(e!==this.#r)return;try{this.#l=this.#v()}catch(o){console.error("setDocument:",o),await this.#p();return}const s=this.#a;this.#n=new AbortController;const{signal:a}=this.#n;s._on("updatefromsandbox",o=>{o?.source===window&&this.#c(o.detail)},{signal:a}),s._on("dispatcheventinsandbox",o=>{this.#l?.dispatchEventInSandbox(o.detail)},{signal:a}),s._on("pagechanging",({pageNumber:o,previous:l})=>{o!==l&&(this.#f(l),this.#u(o))},{signal:a}),s._on("pagerendered",({pageNumber:o})=>{this._pageOpenPending.has(o)&&o===this.#o.currentPageNumber&&this.#u(o)},{signal:a}),s._on("pagesdestroy",async()=>{await this.#f(this.#o.currentPageNumber),await this.#l?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()},{signal:a});try{const o=await this.#i(e);if(e!==this.#r)return;await this.#l.createSandbox({objects:t,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...o,actions:n}}),s.dispatch("sandboxcreated",{source:this})}catch(o){console.error("setDocument:",o),await this.#p();return}await this.#l?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this.#u(this.#o.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#r&&(this.#h=!0)})}async dispatchWillSave(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#l){await this.#d?.promise,this.#d=Promise.withResolvers();try{await this.#l.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#d.resolve(),this.#d=null,e}await this.#d.promise}}async dispatchDidPrint(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#h}get _pageOpenPending(){return O(this,"_pageOpenPending",new Set)}get _visitedPages(){return O(this,"_visitedPages",new Map)}async#c(e){const t=this.#o,i=t.isInPresentationMode||t.isChangingPresentationMode,{id:n,siblings:s,command:a,value:o}=e;if(!n){if(typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING")&&a==="sandboxTripEnd"){window.setTimeout(()=>{window.dispatchEvent(new CustomEvent("sandboxtripend"))},0);return}switch(a){case"clear":console.clear();break;case"error":console.error(o);break;case"layout":if(!i){const h=pi(o);t.spreadMode=h.spreadMode}break;case"page-num":t.currentPageNumber=o+1;break;case"print":await t.pagesPromise,this.#a.dispatch("print",{source:this});break;case"println":console.log(o);break;case"zoom":i||(t.currentScaleValue=o);break;case"SaveAs":this.#a.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":i||t.increaseScale();break;case"ZoomViewOut":i||t.decreaseScale();break;case"WillPrintFinished":this.#d?.resolve(),this.#d=null;break}return}if(i&&e.focus)return;delete e.id,delete e.siblings;const l=s?[n,...s]:[n];for(const h of l){const d=document.querySelector(`[data-element-id="${h}"]`);d?d.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#r?.annotationStorage.setValue(h,e)}}async#u(e,t=!1){const i=this.#r,n=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;const s=this.#o.getPageView(e-1);if(s?.renderingState!==T.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);const a=(async()=>{const o=await(n.has(e)?null:s.pdfPage?.getJSActions());i===this.#r&&await this.#l?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:o})})();n.set(e,a)}async#f(e){const t=this.#r,i=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;const n=i.get(e);n&&(i.set(e,null),await n,t===this.#r&&await this.#l?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e}))}#v(){if(this.#t=Promise.withResolvers(),this.#l)throw new Error("#initScripting: Scripting already exists.");return this.#s.createScripting()}async#p(){if(!this.#l){this.#r=null,this.#t?.resolve();return}this.#e&&(await Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#r=null;try{await this.#l.destroySandbox()}catch{}this.#d?.reject(new Error("Scripting destroyed.")),this.#d=null,this.#n?.abort(),this.#n=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#l=null,this.#h=!1,this.#t?.resolve()}}const ms="--sidebar-width",Jt=200,Te="sidebarResizing",Gt="pdfSidebarNotification";class vs{#e=!1;#t=null;#i=null;#n=null;constructor({elements:e,eventBus:t,l10n:i}){this.isOpen=!1,this.active=I.THUMBS,this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.onToggled=null,this.onUpdateThumbnails=null,this.outerContainer=e.outerContainer,this.sidebarContainer=e.sidebarContainer,this.toggleButton=e.toggleButton,this.resizer=e.resizer,this.thumbnailButton=e.thumbnailButton,this.outlineButton=e.outlineButton,this.attachmentsButton=e.attachmentsButton,this.layersButton=e.layersButton,this.thumbnailView=e.thumbnailView,this.outlineView=e.outlineView,this.attachmentsView=e.attachmentsView,this.layersView=e.layersView,this._currentOutlineItemButton=e.currentOutlineItemButton,this.eventBus=t,this.#e=i.getDirection()==="rtl",this.#o()}reset(){this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.#r(!0),this.switchView(I.THUMBS),this.outlineButton.disabled=!1,this.attachmentsButton.disabled=!1,this.layersButton.disabled=!1,this._currentOutlineItemButton.disabled=!0}get visibleView(){return this.isOpen?this.active:I.NONE}setInitialView(e=I.NONE){if(!this.isInitialViewSet){if(this.isInitialViewSet=!0,e===I.NONE||e===I.UNKNOWN){this.#a();return}this.switchView(e,!0),this.isInitialEventDispatched||this.#a()}}switchView(e,t=!1){const i=e!==this.active;let n=!1;switch(e){case I.NONE:this.isOpen&&this.close();return;case I.THUMBS:this.isOpen&&i&&(n=!0);break;case I.OUTLINE:if(this.outlineButton.disabled)return;break;case I.ATTACHMENTS:if(this.attachmentsButton.disabled)return;break;case I.LAYERS:if(this.layersButton.disabled)return;break;default:console.error(`PDFSidebar.switchView: "${e}" is not a valid view.`);return}if(this.active=e,U(this.thumbnailButton,e===I.THUMBS,this.thumbnailView),U(this.outlineButton,e===I.OUTLINE,this.outlineView),U(this.attachmentsButton,e===I.ATTACHMENTS,this.attachmentsView),U(this.layersButton,e===I.LAYERS,this.layersView),t&&!this.isOpen){this.open();return}n&&(this.onUpdateThumbnails(),this.onToggled()),i&&this.#a()}open(){this.isOpen||(this.isOpen=!0,X(this.toggleButton,!0),this.outerContainer.classList.add("sidebarMoving","sidebarOpen"),this.active===I.THUMBS&&this.onUpdateThumbnails(),this.onToggled(),this.#a(),this.#r())}close(e=null){this.isOpen&&(this.isOpen=!1,X(this.toggleButton,!1),this.outerContainer.classList.add("sidebarMoving"),this.outerContainer.classList.remove("sidebarOpen"),this.onToggled(),this.#a(),e?.detail>0&&this.toggleButton.blur())}toggle(e=null){this.isOpen?this.close(e):this.open()}#a(){this.isInitialViewSet&&(this.isInitialEventDispatched||=!0),this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView})}#s(){this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-notification-button"),this.isOpen||this.toggleButton.classList.add(Gt)}#r(e=!1){(this.isOpen||e)&&this.toggleButton.classList.remove(Gt),e&&this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-button")}#o(){const{eventBus:e,outerContainer:t}=this;this.sidebarContainer.addEventListener("transitionend",n=>{n.target===this.sidebarContainer&&(t.classList.remove("sidebarMoving"),e.dispatch("resize",{source:this}))}),this.toggleButton.addEventListener("click",n=>{this.toggle(n)}),this.thumbnailButton.addEventListener("click",()=>{this.switchView(I.THUMBS)}),this.outlineButton.addEventListener("click",()=>{this.switchView(I.OUTLINE)}),this.outlineButton.addEventListener("dblclick",()=>{e.dispatch("toggleoutlinetree",{source:this})}),this.attachmentsButton.addEventListener("click",()=>{this.switchView(I.ATTACHMENTS)}),this.layersButton.addEventListener("click",()=>{this.switchView(I.LAYERS)}),this.layersButton.addEventListener("dblclick",()=>{e.dispatch("resetlayers",{source:this})}),this._currentOutlineItemButton.addEventListener("click",()=>{e.dispatch("currentoutlineitem",{source:this})});const i=(n,s,a)=>{s.disabled=!n,n?this.#s():this.active===a&&this.switchView(I.THUMBS)};e._on("outlineloaded",n=>{i(n.outlineCount,this.outlineButton,I.OUTLINE),n.currentOutlineItemPromise.then(s=>{this.isInitialViewSet&&(this._currentOutlineItemButton.disabled=!s)})}),e._on("attachmentsloaded",n=>{i(n.attachmentsCount,this.attachmentsButton,I.ATTACHMENTS)}),e._on("layersloaded",n=>{i(n.layersCount,this.layersButton,I.LAYERS)}),e._on("presentationmodechanged",n=>{n.state===R.NORMAL&&this.visibleView===I.THUMBS&&this.onUpdateThumbnails()}),this.resizer.addEventListener("mousedown",n=>{if(n.button!==0)return;t.classList.add(Te),this.#t=new AbortController;const s={signal:this.#t.signal};window.addEventListener("mousemove",this.#l.bind(this),s),window.addEventListener("mouseup",this.#d.bind(this),s),window.addEventListener("blur",this.#d.bind(this),s)}),e._on("resize",n=>{if(n.source!==window||(this.#i=null,!this.#n))return;if(!this.isOpen){this.#h(this.#n);return}t.classList.add(Te);const s=this.#h(this.#n);Promise.resolve().then(()=>{t.classList.remove(Te),s&&e.dispatch("resize",{source:this})})})}get outerContainerWidth(){return this.#i||=this.outerContainer.clientWidth}#h(e=0){const t=Math.floor(this.outerContainerWidth/2);return e>t&&(e=t),e<Jt&&(e=Jt),e===this.#n?!1:(this.#n=e,rt.setProperty(ms,`${e}px`),!0)}#l(e){let t=e.clientX;this.#e&&(t=this.outerContainerWidth-t),this.#h(t)}#d(e){this.outerContainer.classList.remove(Te),this.eventBus.dispatch("resize",{source:this}),this.#t?.abort(),this.#t=null}}const zt=2,jt=3,Es=98;function De(r){r.width=0,r.height=0}class Si{static#e=null;static getCanvas(e,t){const i=this.#e||=document.createElement("canvas");i.width=e,i.height=t;const n=i.getContext("2d",{alpha:!1});return n.save(),n.fillStyle="rgb(255, 255, 255)",n.fillRect(0,0,e,t),n.restore(),[i,i.getContext("2d")]}static destroyCanvas(){this.#e&&De(this.#e),this.#e=null}}class bs{constructor({container:e,eventBus:t,id:i,defaultViewport:n,optionalContentConfigPromise:s,linkService:a,renderingQueue:o,maxCanvasPixels:l,maxCanvasDim:h,pageColors:d,enableHWA:c}){this.id=i,this.renderingId="thumbnail"+i,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=s||null,this.maxCanvasPixels=l??m.get("maxCanvasPixels"),this.maxCanvasDim=h||m.get("maxCanvasDim"),this.pageColors=d||null,this.enableHWA=c||!1,this.eventBus=t,this.linkService=a,this.renderingQueue=o,this.renderTask=null,this.renderingState=T.INITIAL,this.resume=null;const u=document.createElement("a");u.href=a.getAnchorUrl("#page="+i),u.setAttribute("data-l10n-id","pdfjs-thumb-page-title"),u.setAttribute("data-l10n-args",this.#s),u.onclick=function(){return a.goToPage(i),!1},this.anchor=u;const p=document.createElement("div");p.className="thumbnail",p.setAttribute("data-page-number",this.id),this.div=p,this.#e();const f=document.createElement("div");f.className="thumbnailImage",this._placeholderImg=f,p.append(f),u.append(p),e.append(u)}#e(){const{width:e,height:t}=this.viewport,i=e/t;this.canvasWidth=Es,this.canvasHeight=this.canvasWidth/i|0,this.scale=this.canvasWidth/e;const{style:n}=this.div;n.setProperty("--thumbnail-width",`${this.canvasWidth}px`),n.setProperty("--thumbnail-height",`${this.canvasHeight}px`)}setPdfPage(e){this.pdfPage=e,this.pdfPageRotate=e.rotate;const t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:1,rotation:t}),this.reset()}reset(){this.cancelRendering(),this.renderingState=T.INITIAL,this.div.removeAttribute("data-loaded"),this.image?.replaceWith(this._placeholderImg),this.#e(),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:e=null}){typeof e=="number"&&(this.rotation=e);const t=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:t}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}#t(e=1,t=this.enableHWA){const i=document.createElement("canvas"),n=i.getContext("2d",{alpha:!1,willReadFrequently:!t}),s=new re,a=e*this.canvasWidth,o=e*this.canvasHeight;s.limitCanvas(a,o,this.maxCanvasPixels,this.maxCanvasDim),i.width=a*s.sx|0,i.height=o*s.sy|0;const l=s.scaled?[s.sx,0,0,s.sy,0,0]:null;return{ctx:n,canvas:i,transform:l}}#i(e){if(this.renderingState!==T.FINISHED)throw new Error("#convertCanvasToImage: Rendering has not finished.");const t=this.#a(e),i=document.createElement("img");i.className="thumbnailImage",i.setAttribute("data-l10n-id","pdfjs-thumb-page-canvas"),i.setAttribute("data-l10n-args",this.#s),i.src=t.toDataURL(),this.image=i,this.div.setAttribute("data-loaded",!0),this._placeholderImg.replaceWith(i),De(t)}async draw(){if(this.renderingState!==T.INITIAL){console.error("Must be in new state before drawing");return}const{pageColors:e,pdfPage:t}=this;if(!t)throw this.renderingState=T.FINISHED,new Error("pdfPage is not loaded");this.renderingState=T.RUNNING;const{ctx:i,canvas:n,transform:s}=this.#t(zt),a=this.viewport.clone({scale:zt*this.scale}),o=c=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=T.PAUSED,this.resume=()=>{this.renderingState=T.RUNNING,c()};return}c()},l={canvasContext:i,transform:s,viewport:a,optionalContentConfigPromise:this._optionalContentConfigPromise,pageColors:e},h=this.renderTask=t.render(l);h.onContinue=o;let d=null;try{await h.promise}catch(c){if(c instanceof me){De(n);return}d=c}finally{h===this.renderTask&&(this.renderTask=null)}if(this.renderingState=T.FINISHED,this.#i(n),De(n),this.eventBus.dispatch("thumbnailrendered",{source:this,pageNumber:this.id,pdfPage:t}),d)throw d}setImage(e){if(this.renderingState!==T.INITIAL)return;const{thumbnailCanvas:t,pdfPage:i,scale:n}=e;t&&(this.pdfPage||this.setPdfPage(i),!(n<this.scale)&&(this.renderingState=T.FINISHED,this.#i(t)))}#n(e){const t=e.width<<jt,i=e.height<<jt,n=new re;return n.sx=n.sy=1,n.limitCanvas(t,i,this.maxCanvasPixels,this.maxCanvasDim),[t*n.sx|0,i*n.sy|0]}#a(e){const{ctx:t,canvas:i}=this.#t(1,!0);if(e.width<=2*i.width)return t.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),i;let[n,s]=this.#n(i);const[a,o]=Si.getCanvas(n,s);for(;n>e.width||s>e.height;)n>>=1,s>>=1;for(o.drawImage(e,0,0,e.width,e.height,0,0,n,s);n>2*i.width;)o.drawImage(a,0,0,n,s,0,0,n>>1,s>>1),n>>=1,s>>=1;return t.drawImage(a,0,0,n,s,0,0,i.width,i.height),i}get#s(){return JSON.stringify({page:this.pageLabel??this.id})}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.anchor.setAttribute("data-l10n-args",this.#s),this.renderingState===T.FINISHED&&this.image?.setAttribute("data-l10n-args",this.#s)}}const ws=-19,Xe="selected";class ys{constructor({container:e,eventBus:t,linkService:i,renderingQueue:n,maxCanvasPixels:s,maxCanvasDim:a,pageColors:o,abortSignal:l,enableHWA:h}){this.container=e,this.eventBus=t,this.linkService=i,this.renderingQueue=n,this.maxCanvasPixels=s,this.maxCanvasDim=a,this.pageColors=o||null,this.enableHWA=h||!1,this.scroll=di(this.container,this.#e.bind(this),l),this.#i()}#e(){this.renderingQueue.renderHighestPriority()}getThumbnail(e){return this._thumbnails[e]}#t(){return ci({scrollEl:this.container,views:this._thumbnails})}scrollThumbnailIntoView(e){if(!this.pdfDocument)return;const t=this._thumbnails[e-1];if(!t){console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');return}e!==this._currentPageNumber&&(this._thumbnails[this._currentPageNumber-1].div.classList.remove(Xe),t.div.classList.add(Xe));const{first:i,last:n,views:s}=this.#t();if(s.length>0){let a=!1;if(e<=i.id||e>=n.id)a=!0;else for(const{id:o,percent:l}of s)if(o===e){a=l<100;break}a&&at(t.div,{top:ws})}this._currentPageNumber=e}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!Be(e))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument||this._pagesRotation===e)return;this._pagesRotation=e;const t={rotation:e};for(const i of this._thumbnails)i.update(t)}cleanup(){for(const e of this._thumbnails)e.renderingState!==T.FINISHED&&e.reset();Si.destroyCanvas()}#i(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this.container.textContent=""}setDocument(e){if(this.pdfDocument&&(this.#n(),this.#i()),this.pdfDocument=e,!e)return;const t=e.getPage(1),i=e.getOptionalContentConfig({intent:"display"});t.then(n=>{const s=e.numPages,a=n.getViewport({scale:1});for(let l=1;l<=s;++l){const h=new bs({container:this.container,eventBus:this.eventBus,id:l,defaultViewport:a.clone(),optionalContentConfigPromise:i,linkService:this.linkService,renderingQueue:this.renderingQueue,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,pageColors:this.pageColors,enableHWA:this.enableHWA});this._thumbnails.push(h)}this._thumbnails[0]?.setPdfPage(n),this._thumbnails[this._currentPageNumber-1].div.classList.add(Xe)}).catch(n=>{console.error("Unable to initialize thumbnail viewer",n)})}#n(){for(const e of this._thumbnails)e.cancelRendering()}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,i=this._thumbnails.length;t<i;t++)this._thumbnails[t].setPageLabel(this._pageLabels?.[t]??null)}}async#a(e){if(e.pdfPage)return e.pdfPage;try{const t=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for thumb view",t),null}}#s(e){return e.first?.id===1?!0:e.last?.id===this._thumbnails.length?!1:this.scroll.down}forceRendering(){const e=this.#t(),t=this.#s(e),i=this.renderingQueue.getHighestPriority(e,this._thumbnails,t,!1,!0);return i?(this.#a(i).then(()=>{this.renderingQueue.renderView(i)}),!0):!1}}class Ps{#e=null;#t=null;#i=null;#n=null;#a=null;#s;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this.l10n||=new te),this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#s=e.uiManager,this.#e=e.annotationLayer||null,this.#a=e.textLayer||null,this.#t=e.drawLayer||null,this.#i=e.onAppend||null,this.#n=e.structTreeLayer||null}async render({viewport:e,intent:t="display"}){if(t!=="display"||this._cancelled)return;const i=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:i}),this.show();return}const n=this.div=document.createElement("div");n.className="annotationEditorLayer",n.hidden=!0,n.dir=this.#s.direction,this.#i?.(n),this.annotationEditorLayer=new ki({uiManager:this.#s,div:n,structTreeLayer:this.#n,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:i,annotationLayer:this.#e,textLayer:this.#a,drawLayer:this.#t});const s={viewport:i,div:n,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.annotationEditorLayer.pause(!0),this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1,this.annotationEditorLayer.pause(!1))}}class Ss{#e=null;#t=!1;#i=null;#n=null;#a=!1;constructor({pdfPage:e,linkService:t,downloadManager:i,annotationStorage:n=null,imageResourcesPath:s="",renderForms:a=!0,enableScripting:o=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:h=null,annotationCanvasMap:d=null,accessibilityManager:c=null,annotationEditorUIManager:u=null,onAppend:p=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=i,this.imageResourcesPath=s,this.renderForms=a,this.annotationStorage=n,this.enableScripting=o,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=h||Promise.resolve(null),this._annotationCanvasMap=d,this._accessibilityManager=c,this._annotationEditorUIManager=u,this.#i=p,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}async render({viewport:e,intent:t="display",structTreeLayer:i=null}){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}const[n,s,a]=await Promise.all([this.pdfPage.getAnnotations({intent:t}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const o=this.div=document.createElement("div");if(o.className="annotationLayer",this.#i?.(o),n.length===0){this.#e=n,this.hide(!0);return}this.#s(e,i),await this.annotationLayer.render({annotations:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:s,fieldObjects:a}),this.#e=n,this.linkService.isInPresentationMode&&this.#r(R.FULLSCREEN),this.#n||(this.#n=new AbortController,this._eventBus?._on("presentationmodechanged",l=>{this.#r(l.state)},{signal:this.#n.signal}))}#s(e,t){this.annotationLayer=new Fi({div:this.div,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0}),structTreeLayer:t})}cancel(){this._cancelled=!0,this.#n?.abort(),this.#n=null}hide(e=!1){this.#t=!e,this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}async injectLinkAnnotations({inferredLinks:e,viewport:t,structTreeLayer:i=null}){if(this.#e===null)throw new Error("`render` method must be called before `injectLinkAnnotations`.");if(this._cancelled||this.#a)return;this.#a=!0;const n=this.#e.length?this.#o(e):e;n.length&&(this.annotationLayer||(this.#s(t,i),ri(this.div,t)),await this.annotationLayer.addLinkAnnotations(n,this.linkService),this.#t||(this.div.hidden=!1))}#r(e){if(!this.div)return;let t=!1;switch(e){case R.FULLSCREEN:t=!0;break;case R.NORMAL:break;default:return}for(const i of this.div.childNodes)i.hasAttribute("data-internal-link")||(i.inert=t)}#o(e){function t(s){if(!s.quadPoints)return[s.rect];const a=[];for(let o=2,l=s.quadPoints.length;o<l;o+=8){const h=s.quadPoints[o],d=s.quadPoints[o+1],c=s.quadPoints[o+2],u=s.quadPoints[o+3];a.push([c,u,h,d])}return a}function i(s,a){const o=[],l=t(s),h=t(a);for(const d of l)for(const c of h){const u=nt.intersect(d,c);u&&o.push(u)}return o}function n(s){let a=0;for(const o of s)a+=Math.abs((o[2]-o[0])*(o[3]-o[1]));return a}return e.filter(s=>{let a;for(const o of this.#e){if(o.annotationType!==oi.LINK||!o.url)continue;const l=i(o,s);if(l.length!==0&&(a??=n(t(s)),n(l)/a>.5))return!1}return!0})}}function $t({width:r,height:e,left:t,top:i},n){if(r===0||e===0)return null;const s=n.textLayer.div.getBoundingClientRect(),a=n.getPagePoint(t-s.left,i-s.top),o=n.getPagePoint(t-s.left+r,i-s.top+e);return nt.normalizeRect([a[0],a[1],o[0],o[1]])}function _s(r,e){const t=r.getClientRects();if(t.length===1)return{rect:$t(t[0],e)};const i=[1/0,1/0,-1/0,-1/0],n=[];let s=0;for(const a of t){const o=$t(a,e);o!==null&&(n[s]=n[s+4]=o[0],n[s+1]=n[s+3]=o[3],n[s+2]=n[s+6]=o[2],n[s+5]=n[s+7]=o[1],nt.rectBoundingBox(...o,i),s+=8)}return{quadPoints:n,rect:i}}function Kt(r,e){let t=r;do{if(t.nodeType===Node.TEXT_NODE){const i=t.textContent.length;if(e<=i)return[t,e];e-=i}else if(t.firstChild){t=t.firstChild;continue}for(;!t.nextSibling&&t!==r;)t=t.parentNode;t!==r&&(t=t.nextSibling)}while(t!==r);throw new Error("Offset is bigger than container's contents length.")}function Cs({url:r,index:e,length:t},i,n){const s=i._textHighlighter,[{begin:a,end:o}]=s._convertMatches([e],[t]),l=new Range;return l.setStart(...Kt(s.textDivs[a.divIdx],a.offset)),l.setEnd(...Kt(s.textDivs[o.divIdx],o.offset)),{id:`inferred_link_${n}`,unsafeUrl:r,url:r,annotationType:oi.LINK,rotation:0,..._s(l,i),borderStyle:null}}class Ts{static#e=0;static#t;static findLinks(e){this.#t??=new RegExp("\\b(?:https?:\\/\\/|mailto:|www\\.)(?:[\\S--[\\p{P}<>]]|\\/|[\\S--[\\[\\]]]+[\\S--[\\p{P}<>]])+|\\b[\\S--[@\\p{Ps}\\p{Pe}<>]]+@([\\S--[\\p{P}<>]]+(?:\\.[\\S--[\\p{P}<>]]+)+)","gmv");const[t,i]=Ie(e,{ignoreDashEOL:!0}),n=t.matchAll(this.#t),s=[];for(const a of n){const[o,l]=a;let h;if(o.startsWith("www.")||o.startsWith("http://")||o.startsWith("https://"))h=o;else if(URL.canParse(`http://${l}`))h=o.startsWith("mailto:")?o:`mailto:${o}`;else continue;const d=si(h,null,{addDefaultProtocol:!0});if(d){const[c,u]=Ei(i,a.index,o.length);s.push({url:d.href,index:c,length:u})}}return s}static processLinks(e){return this.findLinks(e._textHighlighter.textContentItemsStr.join(`
`)).map(t=>Cs(t,e,this.#e++))}}class _i{#e=!1;#t=null;#i=0;#n=null;#a=T.INITIAL;#s=null;#r=0;#o=null;canvas=null;div=null;eventBus=null;id=null;pageColors=null;renderingQueue=null;renderTask=null;resume=null;constructor(e){this.#e=#e in e?e.#e:e.enableHWA||!1,this.eventBus=e.eventBus,this.id=e.id,this.pageColors=e.pageColors||null,this.renderingQueue=e.renderingQueue,this.#i=e.minDurationToUpdateCanvas??500}get renderingState(){return this.#a}set renderingState(e){if(e!==this.#a)switch(this.#a=e,this.#t&&(clearTimeout(this.#t),this.#t=null),e){case T.PAUSED:this.div.classList.remove("loading"),this.#r=0,this.#s?.(!1);break;case T.RUNNING:this.div.classList.add("loadingIcon"),this.#t=setTimeout(()=>{this.div.classList.add("loading"),this.#t=null},0),this.#r=Date.now();break;case T.INITIAL:case T.FINISHED:this.div.classList.remove("loadingIcon","loading"),this.#r=0;break}}_createCanvas(e,t=!1){const{pageColors:i}=this,n=!!(i?.background&&i?.foreground),s=this.canvas,a=!s&&!n&&!t;let o=this.canvas=document.createElement("canvas");this.#s=h=>{if(a){let d=this.#o;if(!h&&this.#i>0){if(Date.now()-this.#r<this.#i)return;d||(d=this.#o=o,o=this.canvas=o.cloneNode(!1),e(o))}if(d){o.getContext("2d",{alpha:!1}).drawImage(d,0,0),h?this.#l():this.#r=Date.now();return}e(o),this.#s=null;return}h&&(s?(s.replaceWith(o),s.width=s.height=0):e(o))};const l=o.getContext("2d",{alpha:!1,willReadFrequently:!this.#e});return{canvas:o,prevCanvas:s,ctx:l}}#h=e=>{if(this.#s?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=T.PAUSED,this.resume=()=>{this.renderingState=T.RUNNING,e()};return}e()};_resetCanvas(){const{canvas:e}=this;e&&(e.remove(),e.width=e.height=0,this.canvas=null,this.#l())}#l(){this.#o&&(this.#o.width=this.#o.height=0,this.#o=null)}async _drawCanvas(e,t,i){const n=this.renderTask=this.pdfPage.render(e);n.onContinue=this.#h,n.onError=a=>{a instanceof me&&(t(),this.#n=null)};let s=null;try{await n.promise,this.#s?.(!0)}catch(a){if(a instanceof me)return;s=a,this.#s?.(!0)}finally{this.#n=s,n===this.renderTask&&(this.renderTask=null)}if(this.renderingState=T.FINISHED,i(n),s)throw s}cancelRendering({cancelExtraDelay:e=0}={}){this.renderTask&&(this.renderTask.cancel(e),this.renderTask=null),this.resume=null}dispatchPageRender(){this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id})}dispatchPageRendered(e,t){this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:e,isDetailView:t,timestamp:performance.now(),error:this.#n})}}class Is{#e=null;constructor(e){this.pageIndex=e.pageIndex}async render({intent:e="display"}){e!=="display"||this.#e||this._cancelled||(this.#e=new Oi({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}}class Ds extends _i{#e=null;renderingCancelled=!1;constructor({pageView:e}){super(e),this.pageView=e,this.renderingId="detail"+this.id,this.div=e.div}setPdfPage(e){this.pageView.setPdfPage(e)}get pdfPage(){return this.pageView.pdfPage}get renderingState(){return super.renderingState}set renderingState(e){this.renderingCancelled=!1,super.renderingState=e}reset({keepCanvas:e=!1}={}){const t=this.renderingCancelled||this.renderingState===T.RUNNING||this.renderingState===T.PAUSED;this.cancelRendering(),this.renderingState=T.INITIAL,this.renderingCancelled=t,e||this._resetCanvas()}#t(e){if(!this.#e)return!0;const t=this.#e.minX,i=this.#e.minY,n=this.#e.width+t,s=this.#e.height+i;if(e.minX<t||e.minY<i||e.maxX>n||e.maxY>s)return!0;const{width:a,height:o,scale:l}=this.pageView.viewport;if(this.#e.scale!==l)return!0;const h=e.minX-t,d=n-e.maxX,c=e.minY-i,u=s-e.maxY,p=.5,f=(1+p)/p;return t>0&&d/h>f||n<a&&h/d>f||i>0&&u/c>f||s<o&&c/u>f}update({visibleArea:e=null,underlyingViewUpdated:t=!1}={}){if(t){this.cancelRendering(),this.renderingState=T.INITIAL;return}if(!this.#t(e))return;const{viewport:i,maxCanvasPixels:n,capCanvasAreaFactor:s}=this.pageView,a=e.maxX-e.minX,o=e.maxY-e.minY,l=a*o*re.pixelRatio**2,d=(Math.sqrt(re.capPixels(n,s)/l)-1)/2;let c=Math.min(1,d);c<0&&(c=0);const u=a*c,p=o*c,f=Math.max(0,e.minX-u),v=Math.min(i.width,e.maxX+u),y=Math.max(0,e.minY-p),S=Math.min(i.height,e.maxY+p),w=v-f,b=S-y;this.#e={minX:f,minY:y,width:w,height:b,scale:i.scale},this.reset({keepCanvas:!0})}async draw(){if(this.pageView.detailView!==this)return;const e=this.pageView.renderingState===T.FINISHED||this.renderingState===T.FINISHED;this.renderingState!==T.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,pdfPage:i,viewport:n}=this.pageView;if(!i)throw this.renderingState=T.FINISHED,new Error("pdfPage is not loaded");this.renderingState=T.RUNNING;const s=this.pageView._ensureCanvasWrapper(),{canvas:a,prevCanvas:o,ctx:l}=this._createCanvas(y=>{s.firstElementChild?.tagName==="CANVAS"?s.firstElementChild.after(y):s.prepend(y)},e);a.setAttribute("aria-hidden","true");const{width:h,height:d}=n,c=this.#e,{pixelRatio:u}=re,p=[u,0,0,u,-c.minX*u,-c.minY*u];a.width=c.width*u,a.height=c.height*u;const{style:f}=a;f.width=`${c.width*100/h}%`,f.height=`${c.height*100/d}%`,f.top=`${c.minY*100/d}%`,f.left=`${c.minX*100/h}%`;const v=this._drawCanvas(this.pageView._getRenderingContext(l,p),()=>{this.canvas?.remove(),this.canvas=o},()=>{this.dispatchPageRendered(!1,!0)});return t.setAttribute("data-loaded",!0),this.dispatchPageRender(),v}}const Xt={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Ls=/^H(\d+)$/;class As{#e;#t=null;#i;#n=new Map;#a;#s=null;constructor(e,t){this.#e=e.getStructTree(),this.#a=t}async render(){if(this.#i)return this.#i;const{promise:e,resolve:t,reject:i}=Promise.withResolvers();this.#i=e;try{this.#t=this.#h(await this.#e)}catch(n){i(n)}return this.#e=null,this.#t?.classList.add("structTree"),t(this.#t),e}async getAriaAttributes(e){try{return await this.render(),this.#n.get(e)}catch{}return null}hide(){this.#t&&!this.#t.hidden&&(this.#t.hidden=!0)}show(){this.#t?.hidden&&(this.#t.hidden=!1)}#r(e,t){const{alt:i,id:n,lang:s}=e;if(i!==void 0){let a=!1;const o=he(i);for(const l of e.children)if(l.type==="annotation"){let h=this.#n.get(l.id);h||(h=new Map,this.#n.set(l.id,h)),h.set("aria-label",o),a=!0}a||t.setAttribute("aria-label",o)}n!==void 0&&t.setAttribute("aria-owns",n),s!==void 0&&t.setAttribute("lang",he(s,!0))}#o(e,t){const{alt:i,bbox:n,children:s}=e,a=s?.[0];if(!this.#a||!i||!n||a?.type!=="content")return!1;const{id:o}=a;if(!o)return!1;t.setAttribute("aria-owns",o);const l=document.createElement("span");(this.#s||=new Map).set(o,l),l.setAttribute("role","img"),l.setAttribute("aria-label",he(i));const{pageHeight:h,pageX:d,pageY:c}=this.#a,u="calc(var(--total-scale-factor) *",{style:p}=l;return p.width=`${u}${n[2]-n[0]}px)`,p.height=`${u}${n[3]-n[1]}px)`,p.left=`${u}${n[0]-d}px)`,p.top=`${u}${h-n[3]+c}px)`,!0}addElementsToTextLayer(){if(this.#s){for(const[e,t]of this.#s)document.getElementById(e)?.append(t);this.#s.clear(),this.#s=null}}#h(e){if(!e)return null;const t=document.createElement("span");if("role"in e){const{role:i}=e,n=i.match(Ls);if(n?(t.setAttribute("role","heading"),t.setAttribute("aria-level",n[1])):Xt[i]&&t.setAttribute("role",Xt[i]),i==="Figure"&&this.#o(e,t))return t}if(this.#r(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#r(e.children[0],t);else for(const i of e.children)t.append(this.#h(i));return t}}class ge{#e=!1;#t=null;#i=new Map;#n=new Map;setTextMapping(e){this.#t=e}static#a(e,t){const i=e.getBoundingClientRect(),n=t.getBoundingClientRect();if(i.width===0&&i.height===0)return 1;if(n.width===0&&n.height===0)return-1;const s=i.y,a=i.y+i.height,o=i.y+i.height/2,l=n.y,h=n.y+n.height,d=n.y+n.height/2;if(o<=l&&d>=a)return-1;if(d<=s&&o>=h)return 1;const c=i.x+i.width/2,u=n.x+n.width/2;return c-u}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(ge.#a),this.#i.size>0){const e=this.#t;for(const[t,i]of this.#i){if(!document.getElementById(t)){this.#i.delete(t);continue}this.#s(t,e[i])}}for(const[e,t]of this.#n)this.addPointerInTextLayer(e,t);this.#n.clear()}disable(){this.#e&&(this.#n.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#n.delete(e);return}const t=this.#t;if(!t||t.length===0)return;const{id:i}=e,n=this.#i.get(i);if(n===void 0)return;const s=t[n];this.#i.delete(i);let a=s.getAttribute("aria-owns");a?.includes(i)&&(a=a.split(" ").filter(o=>o!==i).join(" "),a?s.setAttribute("aria-owns",a):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#s(e,t){const i=t.getAttribute("aria-owns");i?.includes(e)||t.setAttribute("aria-owns",i?`${i} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){const{id:i}=e;if(!i)return null;if(!this.#e)return this.#n.set(e,t),null;t&&this.removePointerInTextLayer(e);const n=this.#t;if(!n||n.length===0)return null;const s=Ee(n,h=>ge.#a(e,h)<0),a=Math.max(0,s-1),o=n[a];this.#s(i,o),this.#i.set(i,a);const l=o.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(e,t,i,n){const s=this.addPointerInTextLayer(i,n);if(!e.hasChildNodes())return e.append(t),s;const a=Array.from(e.childNodes).filter(h=>h!==t);if(a.length===0)return s;const o=i||t,l=Ee(a,h=>ge.#a(o,h)<0);return l===0?a[0].before(t):a[l-1].after(t),s}}class xs{#e=null;constructor({findController:e,eventBus:t,pageIndex:i}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=i,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];const{textContentItemsStr:i}=this;let n=0,s=0;const a=i.length-1,o=[];for(let l=0,h=e.length;l<h;l++){let d=e[l];for(;n!==a&&d>=s+i[n].length;)s+=i[n].length,n++;n===i.length&&console.error("Could not find a matching mapping");const c={begin:{divIdx:n,offset:d-s}};for(d+=t[l];n!==a&&d>s+i[n].length;)s+=i[n].length,n++;c.end={divIdx:n,offset:d-s},o.push(c)}return o}_renderMatches(e){if(e.length===0)return;const{findController:t,pageIdx:i}=this,{textContentItemsStr:n,textDivs:s}=this,a=i===t.selected.pageIdx,o=t.selected.matchIdx,l=t.state.highlightAll;let h=null;const d={offset:void 0};function c(S,w){const b=S.divIdx;return s[b].textContent="",u(b,0,S.offset,w)}function u(S,w,b,E){let P=s[S];if(P.nodeType===Node.TEXT_NODE){const A=document.createElement("span");P.before(A),A.append(P),s[S]=A,P=A}const _=n[S].substring(w,b),D=document.createTextNode(_);if(E){const A=document.createElement("span");if(A.className=`${E} appended`,A.append(D),P.append(A),E.includes("selected")){const{left:F}=A.getClientRects()[0],H=P.getBoundingClientRect().left;return F-H}return 0}return P.append(D),0}let p=o,f=p+1;if(l)p=0,f=e.length;else if(!a)return;let v=-1,y=-1;for(let S=p;S<f;S++){const w=e[S],b=w.begin;if(b.divIdx===v&&b.offset===y)continue;v=b.divIdx,y=b.offset;const E=w.end,P=a&&S===o,_=P?" selected":"";let D=0;if(!h||b.divIdx!==h.divIdx?(h!==null&&u(h.divIdx,h.offset,d.offset),c(b)):u(h.divIdx,h.offset,b.offset),b.divIdx===E.divIdx)D=u(b.divIdx,b.offset,E.offset,"highlight"+_);else{D=u(b.divIdx,b.offset,d.offset,"highlight begin"+_);for(let A=b.divIdx+1,F=E.divIdx;A<F;A++)s[A].className="highlight middle"+_;c(E,"highlight end"+_)}h=E,P&&t.scrollMatchIntoView({element:s[b.divIdx],selectedLeft:D,pageIndex:i,matchIndex:o})}h&&u(h.divIdx,h.offset,d.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;const{findController:t,matches:i,pageIdx:n}=this,{textContentItemsStr:s,textDivs:a}=this;let o=-1;for(const d of i){const c=Math.max(o,d.begin.divIdx);for(let u=c,p=d.end.divIdx;u<=p;u++){const f=a[u];f.textContent=s[u],f.className=""}o=d.end.divIdx+1}if(!t?.highlightMatches||e)return;const l=t.pageMatches[n]||null,h=t.pageMatchesLength[n]||null;this.matches=this._convertMatches(l,h),this._renderMatches(this.matches)}}class pe{#e=!1;#t=null;#i=!1;#n=null;static#a=new Map;static#s=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:i=null,enablePermissions:n=!1,onAppend:s=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=i,this.#e=n===!0,this.#t=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render({viewport:e,textContentParams:t=null}){if(this.#i&&this.#n){this.#n.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#n=new Vi({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});const{textDivs:i,textContentItemsStr:n}=this.#n;this.highlighter?.setTextMapping(i,n),this.accessibilityManager?.setTextMapping(i),await this.#n.render(),this.#i=!0;const s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#r(s),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()}hide(){!this.div.hidden&&this.#i&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#i&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#n?.cancel(),this.#n=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),pe.#o(this.div)}#r(e){const{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",i=>{if(!this.#e){const n=document.getSelection();i.clipboardData.setData("text/plain",he(Hi(n.toString())))}Q(i)}),pe.#a.set(t,e),pe.#h()}static#o(e){this.#a.delete(e),this.#a.size===0&&(this.#s?.abort(),this.#s=null)}static#h(){if(this.#s)return;this.#s=new AbortController;const{signal:e}=this.#s,t=(a,o)=>{(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&(o.append(a),a.style.width="",a.style.height=""),o.classList.remove("selecting")};let i=!1;if(document.addEventListener("pointerdown",()=>{i=!0},{signal:e}),document.addEventListener("pointerup",()=>{i=!1,this.#a.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{i=!1,this.#a.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{i||this.#a.forEach(t)},{signal:e}),typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))var n,s;document.addEventListener("selectionchange",()=>{const a=document.getSelection();if(a.rangeCount===0){this.#a.forEach(t);return}const o=new Set;for(let p=0;p<a.rangeCount;p++){const f=a.getRangeAt(p);for(const v of this.#a.keys())!o.has(v)&&f.intersectsNode(v)&&o.add(v)}for(const[p,f]of this.#a)o.has(p)?p.classList.add("selecting"):t(f,p);if(typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")||(typeof PDFJSDev>"u"||!PDFJSDev.test("CHROME"))&&(n??=getComputedStyle(this.#a.values().next().value).getPropertyValue("-moz-user-select")==="none",n))return;const l=a.getRangeAt(0),h=s&&(l.compareBoundaryPoints(Range.END_TO_END,s)===0||l.compareBoundaryPoints(Range.START_TO_END,s)===0);let d=h?l.startContainer:l.endContainer;if(d.nodeType===Node.TEXT_NODE&&(d=d.parentNode),!h&&l.endOffset===0)do{for(;!d.previousSibling;)d=d.parentNode;d=d.previousSibling}while(!d.childNodes.length);const c=d.parentElement?.closest(".textLayer"),u=this.#a.get(c);u&&(u.style.width=c.style.width,u.style.height=c.style.height,d.parentElement.insertBefore(u,h?d:d.nextSibling)),s=l.cloneRange()},{signal:e})}}const Ns=typeof PDFJSDev>"u"||!PDFJSDev.test("COMPONENTS")?null:{annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new ot}},Ms=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);class Rs extends _i{#e=Y.ENABLE_FORMS;#t=null;#i=!0;#n=!1;#a=!1;#s=null;#r=!1;#o=null;#h=null;#l=1;#d=1;#c=K.ENABLE;#u=1;#f={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#v=[null,null,null,null];constructor(e){super(e);const t=e.container,i=e.defaultViewport;this.renderingId="page"+this.id,this.#s=e.layerProperties||Ns,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||st,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#c=e.textLayerMode??K.ENABLE,this.#e=e.annotationMode??Y.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.enableDetailCanvas=e.enableDetailCanvas??!0,this.maxCanvasPixels=e.maxCanvasPixels??m.get("maxCanvasPixels"),this.maxCanvasDim=e.maxCanvasDim||m.get("maxCanvasDim"),this.capCanvasAreaFactor=e.capCanvasAreaFactor??m.get("capCanvasAreaFactor"),this.#i=e.enableAutoLinking!==!1,this.l10n=e.l10n,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this.l10n||=new te),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null,this.detailView=null;const n=document.createElement("div");if(n.className="page",n.setAttribute("data-page-number",this.id),n.setAttribute("role","region"),n.setAttribute("data-l10n-id","pdfjs-page-landmark"),n.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=n,this.#E(),t?.append(n),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*$.PDF_TO_CSS_UNITS),this.pageColors?.background&&t?.style.setProperty("--page-bg-color",this.pageColors.background);const{optionalContentConfigPromise:s}=e;s&&s.then(a=>{s===this._optionalContentConfigPromise&&(this.#f.initialOptionalContent=a.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#p(e,t){const i=Ms.get(t),n=this.#v[i];if(this.#v[i]=e,n){n.replaceWith(e);return}for(let s=i-1;s>=0;s--){const a=this.#v[s];if(a){a.after(e);return}}this.div.prepend(e)}#E(){const{div:e,viewport:t}=this;if(t.userUnit!==this.#u&&(t.userUnit!==1?e.style.setProperty("--user-unit",t.userUnit):e.style.removeProperty("--user-unit"),this.#u=t.userUnit),this.pdfPage){if(this.#h===t.rotation)return;this.#h=t.rotation}ri(e,t,!0,!1)}setPdfPage(e){(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;const t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*$.PDF_TO_CSS_UNITS,rotation:t}),this.#E(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return O(this,"_textHighlighter",new xs({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#s.findController}))}#g(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}async#T(){let e=null;try{await this.annotationLayer.render({viewport:this.viewport,intent:"display",structTreeLayer:this.structTreeLayer})}catch(t){console.error("#renderAnnotationLayer:",t),e=t}finally{this.#g("annotationlayerrendered",e)}}async#P(){let e=null;try{await this.annotationEditorLayer.render({viewport:this.viewport,intent:"display"})}catch(t){console.error("#renderAnnotationEditorLayer:",t),e=t}finally{this.#g("annotationeditorlayerrendered",e)}}async#w(){try{await this.drawLayer.render({intent:"display"})}catch(e){console.error("#renderDrawLayer:",e)}}async#m(){let e=null;try{const t=await this.xfaLayer.render({viewport:this.viewport,intent:"display"});t?.textDivs&&this._textHighlighter&&this.#C(t.textDivs)}catch(t){console.error("#renderXfaLayer:",t),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#p(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#g("xfalayerrendered",e)}}async#L(){if(!this.textLayer)return;let e=null;try{await this.textLayer.render({viewport:this.viewport})}catch(t){if(t instanceof Ui)return;console.error("#renderTextLayer:",t),e=t}this.#g("textlayerrendered",e),this.#b()}async#b(){if(!this.textLayer)return;const e=await this.structTreeLayer?.render();e&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&e.parentNode!==this.canvas&&this.canvas.append(e),this.l10n.resume()),this.structTreeLayer?.show()}async#C(e){const t=await this.pdfPage.getTextContent(),i=[];for(const n of t.items)i.push(n.str);this._textHighlighter.setTextMapping(e,i),this._textHighlighter.enable()}async#S(e){let t=null;try{if(await e,!this.annotationLayer)return;await this.annotationLayer.injectLinkAnnotations({inferredLinks:Ts.processLinks(this),viewport:this.viewport,structTreeLayer:this.structTreeLayer})}catch(i){console.error("#injectLinkAnnotations:",i),t=i}(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING"))&&this.#g("linkannotationsadded",t)}_resetCanvas(){super._resetCanvas(),this.#o=null}reset({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:i=!1,keepTextLayer:n=!1,keepCanvasWrapper:s=!1,preserveDetailViewState:a=!1}={}){this.cancelRendering({keepAnnotationLayer:e,keepAnnotationEditorLayer:t,keepXfaLayer:i,keepTextLayer:n}),this.renderingState=T.INITIAL;const o=this.div,l=o.childNodes,h=e&&this.annotationLayer?.div||null,d=t&&this.annotationEditorLayer?.div||null,c=i&&this.xfaLayer?.div||null,u=n&&this.textLayer?.div||null,p=s&&this.#t||null;for(let f=l.length-1;f>=0;f--){const v=l[f];switch(v){case h:case d:case c:case u:case p:continue}v.remove();const y=this.#v.indexOf(v);y>=0&&(this.#v[y]=null)}o.removeAttribute("data-loaded"),h&&this.annotationLayer.hide(),d&&this.annotationEditorLayer.hide(),c&&this.xfaLayer.hide(),u&&this.textLayer.hide(),this.structTreeLayer?.hide(),!s&&this.#t&&(this.#t=null,this._resetCanvas()),a||(this.detailView?.reset({keepCanvas:s}),s||(this.detailView=null))}toggleEditingMode(e){this.#a=e,this.hasEditableAnnotations()&&this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0})}updateVisibleArea(e){this.enableDetailCanvas&&(this.#r&&this.maxCanvasPixels>0&&e?(this.detailView??=new Ds({pageView:this}),this.detailView.update({visibleArea:e})):this.detailView&&(this.detailView.reset(),this.detailView=null))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:i=null,drawingDelay:n=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),i instanceof Promise&&(this._optionalContentConfigPromise=i,i.then(a=>{i===this._optionalContentConfigPromise&&(this.#f.initialOptionalContent=a.hasInitialVisibility)})),this.#f.directDrawing=!0;const s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*$.PDF_TO_CSS_UNITS,rotation:s}),this.#E(),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.#y(),this.canvas){const a=this.#n&&this.#r,o=n>=0&&n<1e3;if(o||a){o&&!a&&this.renderingState!==T.FINISHED&&(this.cancelRendering({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:n}),this.renderingState=T.FINISHED,this.#f.directDrawing=!1),this.cssTransform({redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!o,hideTextLayer:o}),o||(this.detailView?.update({underlyingViewUpdated:!0}),this.dispatchPageRendered(!0,!1));return}}this.cssTransform({}),this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0,preserveDetailViewState:!0}),this.detailView?.update({underlyingViewUpdated:!0})}#y(){const{width:e,height:t}=this.viewport,i=this.outputScale=new re;if((typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this.maxCanvasPixels===0){const n=1/this.scale;i.sx*=n,i.sy*=n,this.#r=!0}else this.#r=i.limitCanvas(e,t,this.maxCanvasPixels,this.maxCanvasDim,this.capCanvasAreaFactor)}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:i=!1,keepTextLayer:n=!1,cancelExtraDelay:s=0}={}){super.cancelRendering({cancelExtraDelay:s}),this.textLayer&&(!n||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!i||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({redrawAnnotationLayer:e=!1,redrawAnnotationEditorLayer:t=!1,redrawXfaLayer:i=!1,redrawTextLayer:n=!1,hideTextLayer:s=!1}){const{canvas:a}=this;if(!a)return;const o=this.#o;if(this.viewport!==o){const l=(360+this.viewport.rotation-o.rotation)%360;if(l===90||l===270){const{width:h,height:d}=this.viewport,c=d/h,u=h/d;a.style.transform=`rotate(${l}deg) scale(${c},${u})`}else a.style.transform=l===0?"":`rotate(${l}deg)`}e&&this.annotationLayer&&this.#T(),t&&this.annotationEditorLayer&&(this.drawLayer&&this.#w(),this.#P()),i&&this.xfaLayer&&this.#m(),this.textLayer&&(s?(this.textLayer.hide(),this.structTreeLayer?.hide()):n&&this.#L())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}_ensureCanvasWrapper(){let e=this.#t;return e||(e=this.#t=document.createElement("div"),e.classList.add("canvasWrapper"),this.#p(e,"canvasWrapper")),e}_getRenderingContext(e,t){return{canvasContext:e,transform:t,viewport:this.viewport,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors,isEditing:this.#a}}async draw(){this.renderingState!==T.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:e,l10n:t,pdfPage:i,viewport:n}=this;if(!i)throw this.renderingState=T.FINISHED,new Error("pdfPage is not loaded");this.renderingState=T.RUNNING;const s=this._ensureCanvasWrapper();if(!this.textLayer&&this.#c!==K.DISABLE&&!i.isPureXfa&&(this._accessibilityManager||=new ge,this.textLayer=new pe({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#c===K.ENABLE_PERMISSIONS,onAppend:E=>{this.l10n.pause(),this.#p(E,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==Y.DISABLE){const{annotationStorage:E,annotationEditorUIManager:P,downloadManager:_,enableScripting:D,fieldObjectsPromise:A,hasJSActionsPromise:F,linkService:H}=this.#s;this._annotationCanvasMap||=new Map,this.annotationLayer=new Ss({pdfPage:i,annotationStorage:E,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===Y.ENABLE_FORMS,linkService:H,downloadManager:_,enableScripting:D,hasJSActionsPromise:F,fieldObjectsPromise:A,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:P,onAppend:q=>{this.#p(q,"annotationLayer")}})}const{width:a,height:o}=n;this.#o=n;const{canvas:l,prevCanvas:h,ctx:d}=this._createCanvas(E=>{s.prepend(E)});l.setAttribute("role","presentation"),this.outputScale||this.#y();const{outputScale:c}=this;this.#n=this.#r;const u=Tt(c.sx),p=Tt(c.sy),f=l.width=Pe(Se(a*c.sx),u[0]),v=l.height=Pe(Se(o*c.sy),p[0]),y=Pe(Se(a),u[1]),S=Pe(Se(o),p[1]);c.sx=f/y,c.sy=v/S,this.#l!==u[1]&&(e.style.setProperty("--scale-round-x",`${u[1]}px`),this.#l=u[1]),this.#d!==p[1]&&(e.style.setProperty("--scale-round-y",`${p[1]}px`),this.#d=p[1]);const w=c.scaled?[c.sx,0,0,c.sy,0,0]:null,b=this._drawCanvas(this._getRenderingContext(d,w),()=>{h?.remove(),this._resetCanvas()},E=>{this.#f.regularAnnotations=!E.separateAnnots,this.dispatchPageRendered(!1,!1)}).then(async()=>{this.structTreeLayer||=new As(i,n.rawDims);const E=this.#L();this.annotationLayer&&(await this.#T(),this.#i&&this.annotationLayer&&this.textLayer&&await this.#S(E));const{annotationEditorUIManager:P}=this.#s;P&&(this.drawLayer||=new Is({pageIndex:this.id}),await this.#w(),this.drawLayer.setParent(s),this.annotationEditorLayer||=new Ps({uiManager:P,pdfPage:i,l10n:t,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:_=>{this.#p(_,"annotationEditorLayer")}}),this.#P())});if(i.isPureXfa){if(!this.xfaLayer){const{annotationStorage:E,linkService:P}=this.#s;this.xfaLayer=new bi({pdfPage:i,annotationStorage:E,linkService:P})}this.#m()}return e.setAttribute("data-loaded",!0),this.dispatchPageRender(),b}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:e,initialOptionalContent:t,regularAnnotations:i}=this.#f;return e&&t&&i?this.canvas:null}}const Zt=10,ce={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function Yt(r){return Object.values(L).includes(r)&&r!==L.DISABLE}class Bs{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){const t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#i()}resize(e,t=null){this.#t=e;const i=this.#e;if(t){const n=i.size;let s=1;for(const a of i)if(t.has(a.id)&&(i.delete(a),i.add(a)),++s>n)break}for(;i.size>this.#t;)this.#i()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#i(){const e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}}class ks{#e=null;#t=null;#i=null;#n=L.NONE;#a=null;#s=Y.ENABLE_FORMS;#r=null;#o=null;#h=!1;#l=!1;#d=!1;#c=!1;#u=!1;#f=!0;#v=null;#p=0;#E=null;#g=null;#T=null;#P=null;#w=!1;#m=null;#L=!1;#b=0;#C=new ResizeObserver(this.#K.bind(this));#S=null;#y=null;#_=null;#A=!0;#N=K.ENABLE;#I=null;constructor(e){if(typeof PDFJSDev<"u"&&PDFJSDev.eval("BUNDLE_VERSION"),this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.#I=e.viewerAlert||null,typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")){if(this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.")}this.#C.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new ot,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.#_=e.signatureManager||null,this.#o=e.editorUndoBar||null,this.findController&&(this.findController.onIsPageVisible=i=>this._getVisiblePages().ids.has(i)),this._scriptingManager=e.scriptingManager||null,this.#N=e.textLayerMode??K.ENABLE,this.#s=e.annotationMode??Y.ENABLE_FORMS,this.#n=e.annotationEditorMode??L.NONE,this.#i=e.annotationEditorHighlightColors||null,this.#l=e.enableHighlightFloatingButton===!0,this.#c=e.enableUpdatedAddImage===!0,this.#u=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this.removePageBorders=e.removePageBorders||!1),this.maxCanvasPixels=e.maxCanvasPixels,this.maxCanvasDim=e.maxCanvasDim,this.capCanvasAreaFactor=e.capCanvasAreaFactor,this.enableDetailCanvas=e.enableDetailCanvas??!0,this.l10n=e.l10n,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this.l10n||=new te),this.#d=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#E=e.mlManager||null,this.#h=e.enableHWA||!1,this.#A=e.supportsPinchToZoom!==!1,this.#f=e.enableAutoLinking!==!1,this.#p=e.minDurationToUpdateCanvas??500,this.defaultRenderingQueue=!e.renderingQueue,(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this.defaultRenderingQueue?(this.renderingQueue=new Pi,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;const{abortSignal:t}=e;t?.addEventListener("abort",()=>{this.#C.disconnect(),this.#C=null},{once:!0}),this.scroll=di(this.container,this._scrollUpdate.bind(this),t),this.presentationModeState=R.UNKNOWN,this._resetView(),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#z(),this.eventBus._on("thumbnailrendered",({pageNumber:i,pdfPage:n})=>{const s=this._pages[i-1];this.#e.has(s)||n?.cleanup()}),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&!e.l10n&&this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#s===Y.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#V(),!0;if(!(0<e&&e<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:i}),t&&this.#V(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){const i=this._pageLabels.indexOf(e);i>=0&&(t=i+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==Ve?this._currentScale:st}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#M(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#M(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!Be(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;const t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#M(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const e=this;return O(this,"_layerProperties",{get annotationEditorUIManager(){return e.#a},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#H(e){const t={annotationEditorMode:this.#n,annotationMode:this.#s,textLayerMode:this.#N};return e&&(!e.includes(we.COPY)&&this.#N===K.ENABLE&&(t.textLayerMode=K.ENABLE_PERMISSIONS),e.includes(we.MODIFY_CONTENTS)||(t.annotationEditorMode=L.DISABLE),!e.includes(we.MODIFY_ANNOTATIONS)&&!e.includes(we.FILL_INTERACTIVE_FORMS)&&this.#s===Y.ENABLE_FORMS&&(t.annotationMode=Y.ENABLE)),t}async#F(e){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;const t=Promise.withResolvers(),i=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&t.resolve()},{signal:AbortSignal.any([e,i.signal])}),await Promise.race([this._onePageRenderedCapability.promise,t.promise]),i.abort()}async getAllText(){const e=[],t=[];for(let i=1,n=this.pdfDocument.numPages;i<=n;++i){if(this.#L)return null;t.length=0;const s=await this.pdfDocument.getPage(i),{items:a}=await s.getTextContent();for(const o of a)o.str&&t.push(o.str),o.hasEOL&&t.push(`
`);e.push(he(t.join("")))}return e.join(`
`)}#O(e,t){const i=document.getSelection(),{focusNode:n,anchorNode:s}=i;if(s&&n&&i.containsNode(this.#m)){if(this.#w||e===K.ENABLE_PERMISSIONS){Q(t);return}this.#w=!0;const{classList:a}=this.viewer;a.add("copyAll");const o=new AbortController;window.addEventListener("keydown",l=>this.#L=l.key==="Escape",{signal:o.signal}),this.getAllText().then(async l=>{l!==null&&await navigator.clipboard.writeText(l)}).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#w=!1,this.#L=!1,o.abort(),a.remove("copyAll")}),Q(t)}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#a?.destroy(),this.#a=null),this.pdfDocument=e,!e)return;const t=e.numPages,i=e.getPage(1),n=e.getOptionalContentConfig({intent:"display"}),s=this.#d?e.getPermissions():Promise.resolve(),{eventBus:a,pageColors:o,viewer:l}=this;this.#v=new AbortController;const{signal:h}=this.#v;if(t>ce.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const u=this._scrollMode=C.PAGE;a.dispatch("scrollmodechanged",{source:this,mode:u})}this._pagesCapability.promise.then(()=>{a.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});const d=u=>{const p=this._pages[u.pageNumber-1];p&&this.#e.push(p)};a._on("pagerender",d,{signal:h});const c=u=>{u.cssTransform||u.isDetailView||(this._onePageRenderedCapability.resolve({timestamp:u.timestamp}),a._off("pagerendered",c))};a._on("pagerendered",c,{signal:h}),Promise.all([i,s]).then(([u,p])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(u),this._optionalContentConfigPromise=n;const{annotationEditorMode:f,annotationMode:v,textLayerMode:y}=this.#H(p);if(y!==K.DISABLE){const E=this.#m=document.createElement("div");E.id="hiddenCopyElement",l.before(E)}if(f!==L.DISABLE){const E=f;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):Yt(E)?(this.#a=new Wi(this.container,l,this.#I,this.#t,this.#_,a,e,o,this.#i,this.#l,this.#c,this.#u,this.#E,this.#o,this.#A),a.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#a}),E!==L.NONE&&(this.#j(E),this.#a.updateMode(E))):console.error(`Invalid AnnotationEditor mode: ${E}`)}const S=this._scrollMode===C.PAGE?null:l,w=this.currentScale,b=u.getViewport({scale:w*$.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",b.scale),o?.background&&l.style.setProperty("--page-bg-color",o.background),(o?.foreground==="CanvasText"||o?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let E=1;E<=t;++E){const P=new Rs({container:S,eventBus:a,id:E,scale:w,defaultViewport:b.clone(),optionalContentConfigPromise:n,renderingQueue:this.renderingQueue,textLayerMode:y,annotationMode:v,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,capCanvasAreaFactor:this.capCanvasAreaFactor,enableDetailCanvas:this.enableDetailCanvas,pageColors:o,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#h,enableAutoLinking:this.#f,minDurationToUpdateCanvas:this.#p});this._pages.push(P)}this._pages[0]?.setPdfPage(u),this._scrollMode===C.PAGE?this.#R():this._spreadMode!==x.NONE&&this._updateSpreadMode(),this.#F(h).then(async()=>{if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#m&&document.addEventListener("copy",this.#O.bind(this,y),{signal:h}),this.#a&&a.dispatch("annotationeditormodechanged",{source:this,mode:this.#n}),e.loadingParams.disableAutoFetch||t>ce.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let E=t-1;if(E<=0){this._pagesCapability.resolve();return}for(let P=2;P<=t;++P){const _=e.getPage(P).then(D=>{const A=this._pages[P-1];A.pdfPage||A.setPdfPage(D),--E===0&&this._pagesCapability.resolve()},D=>{console.error(`Unable to get page ${P} to initialize viewer`,D),--E===0&&this._pagesCapability.resolve()});P%ce.PAUSE_EAGER_PAGE_INIT===0&&await _}}),a.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:E})=>{e===this.pdfDocument&&E.Language&&(l.lang=E.Language)}),this.defaultRenderingQueue&&this.update()}).catch(u=>{console.error("Unable to initialize viewer",u),this._pagesCapability.reject(u)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,i=this._pages.length;t<i;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=Ve,this._currentScaleValue=null,this._pageLabels=null,this.#e=new Bs(Zt),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=C.VERTICAL,this._previousScrollMode=C.UNKNOWN,this._spreadMode=x.NONE,this.#S={previousPageNumber:1,scrollDown:!0,pages:[]},this.#v?.abort(),this.#v=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#m?.remove(),this.#m=null,this.#W(),this.#J()}#R(){if(this._scrollMode!==C.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const e=this._currentPageNumber,t=this.#S,i=this.viewer;if(i.textContent="",t.pages.length=0,this._spreadMode===x.NONE&&!this.isInPresentationMode){const n=this._pages[e-1];i.append(n.div),t.pages.push(n)}else{const n=new Set,s=this._spreadMode-1;s===-1?n.add(e-1):e%2!==s?(n.add(e-1),n.add(e)):(n.add(e-2),n.add(e-1));const a=document.createElement("div");if(a.className="spread",this.isInPresentationMode){const o=document.createElement("div");o.className="dummyPage",a.append(o)}for(const o of n){const l=this._pages[o];l&&(a.append(l.div),t.pages.push(l))}i.append(a)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&(this.#g&&clearTimeout(this.#g),this.#g=setTimeout(()=>{this.#g=null,this.update()},100),this.update())}#D(e,t=null){const{div:i,id:n}=e;if(this._currentPageNumber!==n&&this._setCurrentPageNumber(n),this._scrollMode===C.PAGE&&(this.#R(),this.update()),!t&&!this.isInPresentationMode){const s=i.offsetLeft+i.clientLeft,a=s+i.clientWidth,{scrollLeft:o,clientWidth:l}=this.container;(this._scrollMode===C.HORIZONTAL||s<o||a>o+l)&&(t={left:0,top:0})}at(i,t),!this._currentScaleValue&&this._location&&(this._location=null)}#x(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#k(e,t,{noScroll:i=!1,preset:n=!1,drawingDelay:s=-1,origin:a=null}){if(this._currentScaleValue=t.toString(),this.#x(e)){n&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*$.PDF_TO_CSS_UNITS);const o=s>=0&&s<1e3;this.refresh(!0,{scale:e,drawingDelay:o?s:-1}),o&&(this.#y=setTimeout(()=>{this.#y=null,this.refresh()},s));const l=this._currentScale;if(this._currentScale=e,!i){let h=this._currentPageNumber,d;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(h=this._location.pageNumber,d=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:h,destArray:d,allowNegativeOffset:!0}),Array.isArray(a)){const c=e/l-1,[u,p]=this.containerTopLeft;this.container.scrollLeft+=(a[0]-p)*c,this.container.scrollTop+=(a[1]-u)*c}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:n?t:void 0}),this.defaultRenderingQueue&&this.update()}get#U(){return this._spreadMode!==x.NONE&&this._scrollMode!==C.HORIZONTAL?2:1}#M(e,t){let i=parseFloat(e);if(i>0)t.preset=!1,this.#k(i,e,t);else{const n=this._pages[this._currentPageNumber-1];if(!n)return;let s=St,a=_t;this.isInPresentationMode?(s=a=4,this._spreadMode!==x.NONE&&(s*=2)):(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this.removePageBorders?s=a=0:this._scrollMode===C.HORIZONTAL&&([s,a]=[a,s]);const o=(this.container.clientWidth-s)/n.width*n.scale/this.#U,l=(this.container.clientHeight-a)/n.height*n.scale;switch(e){case"page-actual":i=1;break;case"page-width":i=o;break;case"page-height":i=l;break;case"page-fit":i=Math.min(o,l);break;case"auto":const h=Ye(n)?o:Math.min(l,o);i=Math.min(Zi,h);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#k(i,e,t)}}#V(){const e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#M(this._currentScaleValue,{noScroll:!0}),this.#D(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;const t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:n=!1}){if(!this.pdfDocument)return;const s=Number.isInteger(e)&&this._pages[e-1];if(!s){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let a=0,o=0,l=0,h=0,d,c;const u=s.rotation%180!==0,p=(u?s.height:s.width)/s.scale/$.PDF_TO_CSS_UNITS,f=(u?s.width:s.height)/s.scale/$.PDF_TO_CSS_UNITS;let v=0;switch(t[1].name){case"XYZ":a=t[2],o=t[3],v=t[4],a=a!==null?a:0,o=o!==null?o:f;break;case"Fit":case"FitB":v="page-fit";break;case"FitH":case"FitBH":o=t[2],v="page-width",o===null&&this._location?(a=this._location.left,o=this._location.top):(typeof o!="number"||o<0)&&(o=f);break;case"FitV":case"FitBV":a=t[2],l=p,h=f,v="page-height";break;case"FitR":a=t[2],o=t[3],l=t[4]-a,h=t[5]-o;let b=St,E=_t;(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&this.removePageBorders&&(b=E=0),d=(this.container.clientWidth-b)/l/$.PDF_TO_CSS_UNITS,c=(this.container.clientHeight-E)/h/$.PDF_TO_CSS_UNITS,v=Math.min(Math.abs(d),Math.abs(c));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(n||(v&&v!==this._currentScale?this.currentScaleValue=v:this._currentScale===Ve&&(this.currentScaleValue=fe)),v==="page-fit"&&!t[4]){this.#D(s);return}const y=[s.viewport.convertToViewportPoint(a,o),s.viewport.convertToViewportPoint(a+l,o+h)];let S=Math.min(y[0][0],y[1][0]),w=Math.min(y[0][1],y[1][1]);i||(S=Math.max(S,0),w=Math.max(w,0)),this.#D(s,{left:S,top:w})}_updateLocation(e){const t=this._currentScale,i=this._currentScaleValue,n=parseFloat(i)===t?Math.round(t*1e4)/100:i,s=e.id,a=this._pages[s-1],o=this.container,l=a.getPagePoint(o.scrollLeft-e.x,o.scrollTop-e.y),h=Math.round(l[0]),d=Math.round(l[1]);let c=`#page=${s}`;this.isInPresentationMode||(c+=`&zoom=${n},${h},${d}`),this._location={pageNumber:s,scale:n,top:d,left:h,rotation:this._pagesRotation,pdfOpenParams:c}}update(){const e=this._getVisiblePages(),t=e.views,i=t.length;if(i===0)return;const n=Math.max(Zt,2*i+1);this.#e.resize(n,e.ids);for(const{view:l,visibleArea:h}of t)l.updateVisibleArea(h);for(const l of this.#e)e.ids.has(l.id)||l.updateVisibleArea(null);this.renderingQueue.renderHighestPriority(e);const s=this._spreadMode===x.NONE&&(this._scrollMode===C.PAGE||this._scrollMode===C.VERTICAL),a=this._currentPageNumber;let o=!1;for(const l of t){if(l.percent<100)break;if(l.id===a&&s){o=!0;break}}this._setCurrentPageNumber(o?a:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#G(){const e=this._getVisiblePages(),t=[],{ids:i,views:n}=e;for(const s of n){const{view:a}=s;if(!a.hasEditableAnnotations()){i.delete(a.id);continue}t.push(s)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:i}),i)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===R.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===R.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const e=this._scrollMode===C.PAGE?this.#S.pages:this._pages,t=this._scrollMode===C.HORIZONTAL,i=t&&this._isContainerRtl;return ci({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:i})}cleanup(){for(const e of this._pages)e.renderingState!==T.FINISHED&&e.reset()}_cancelRendering(){for(const e of this._pages)e.cancelRendering()}async#B(e){if(e.pdfPage)return e.pdfPage;try{const t=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}}#$(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case C.PAGE:return this.#S.scrollDown;case C.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){const t=e||this._getVisiblePages(),i=this.#$(t),n=this._spreadMode!==x.NONE&&this._scrollMode!==C.HORIZONTAL,s=this.#y!==null||this.#g!==null&&t.views.some(o=>o.detailView?.renderingCancelled),a=this.renderingQueue.getHighestPriority(t,this._pages,i,n,s);return a?(this.#B(a).then(()=>{this.renderingQueue.renderView(a)}),!0):!1}get hasEqualPageSizes(){const e=this._pages[0];for(let t=1,i=this._pages.length;t<i;++t){const n=this._pages[t];if(n.width!==e.width||n.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{const i=t.pdfPage.getViewport({scale:1}),n=Ye(i);if(e===void 0)e=n;else if(this.enablePrintAutoRotate&&n!==e)return{width:i.height,height:i.width,rotation:(i.rotation-90)%360};return{width:i.width,height:i.height,rotation:i.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(!(typeof PDFJSDev>"u"?window.isGECKOVIEW:PDFJSDev.test("GECKOVIEW"))&&this._scrollMode!==e){if(!fi(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>ce.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){const t=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",t===C.HORIZONTAL),i.classList.toggle("scrollWrapped",t===C.WRAPPED),!(!this.pdfDocument||!e)&&(t===C.PAGE?this.#R():this._previousScrollMode===C.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#M(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(!(typeof PDFJSDev>"u"?window.isGECKOVIEW:PDFJSDev.test("GECKOVIEW"))&&this._spreadMode!==e){if(!gi(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;const t=this.viewer,i=this._pages;if(this._scrollMode===C.PAGE)this.#R();else if(t.textContent="",this._spreadMode===x.NONE)for(const n of this._pages)t.append(n.div);else{const n=this._spreadMode-1;let s=null;for(let a=0,o=i.length;a<o;++a)s===null?(s=document.createElement("div"),s.className="spread",t.append(s)):a%2===n&&(s=s.cloneNode(!1),t.append(s)),s.append(i[a].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#M(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case C.WRAPPED:{const{views:i}=this._getVisiblePages(),n=new Map;for(const{id:s,y:a,percent:o,widthPercent:l}of i){if(o===0||l<100)continue;let h=n.get(a);h||n.set(a,h||=[]),h.push(s)}for(const s of n.values()){const a=s.indexOf(e);if(a===-1)continue;const o=s.length;if(o===1)break;if(t)for(let l=a-1,h=0;l>=h;l--){const d=s[l],c=s[l+1]-1;if(d<c)return e-c}else for(let l=a+1,h=o;l<h;l++){const d=s[l],c=s[l-1]+1;if(d>c)return c-e}if(t){const l=s[0];if(l<e)return e-l+1}else{const l=s[o-1];if(l>e)return l-e+1}break}break}case C.HORIZONTAL:break;case C.PAGE:case C.VERTICAL:{if(this._spreadMode===x.NONE)break;const i=this._spreadMode-1;if(t&&e%2!==i)break;if(!t&&e%2===i)break;const{views:n}=this._getVisiblePages(),s=t?e-1:e+1;for(const{id:a,percent:o,widthPercent:l}of n)if(a===s){if(o>0&&l===100)return 2;break}break}}return 1}nextPage(){const e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;const i=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+i,t),!0}previousPage(){const e=this._currentPageNumber;if(e<=1)return!1;const t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:i=null,origin:n}){if(i===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(t>0&&t!==1)s=Math.round(s*t*100)/100;else if(i){const a=i>0?Pt:1/Pt,o=i>0?Math.ceil:Math.floor;i=Math.abs(i);do s=o((s*a).toFixed(2)*10)/10;while(--i>0)}s=it(s,li,hi),this.#M(s,{noScroll:!1,drawingDelay:e,origin:n})}increaseScale(e={}){this.updateScale({...e,steps:e.steps??1})}decreaseScale(e={}){this.updateScale({...e,steps:-(e.steps??1)})}#z(e=this.container.clientHeight){e!==this.#b&&(this.#b=e,rt.setProperty("--viewer-container-height",`${e}px`))}#K(e){for(const t of e)if(t.target===this.container){this.#z(Math.floor(t.borderBoxSize[0].blockSize)),this.#r=null;break}}get containerTopLeft(){return this.#r||=[this.container.offsetTop,this.container.offsetLeft]}#W(){this.#y!==null&&(clearTimeout(this.#y),this.#y=null),this.#g!==null&&(clearTimeout(this.#g),this.#g=null)}#J(){this.#T?.abort(),this.#T=null,this.#P!==null&&(clearTimeout(this.#P),this.#P=null)}#j(e){switch(e){case L.STAMP:this.#E?.loadModel("altText");break;case L.SIGNATURE:this.#_?.loadSignatures();break}}get annotationEditorMode(){return this.#a?this.#n:L.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:i=!1,mustEnterInEditMode:n=!1}){if(!this.#a)throw new Error("The AnnotationEditor is not enabled.");if(this.#n===e)return;if(!Yt(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;this.#j(e);const{eventBus:s,pdfDocument:a}=this,o=async()=>{this.#J(),this.#n=e,await this.#a.updateMode(e,t,i,n),!(e!==this.#n||a!==this.pdfDocument)&&s.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===L.NONE||this.#n===L.NONE){const l=e!==L.NONE;l||this.pdfDocument.annotationStorage.resetModifiedIds();for(const d of this._pages)d.toggleEditingMode(l);const h=this.#G();if(l&&h){this.#J(),this.#T=new AbortController;const d=AbortSignal.any([this.#v.signal,this.#T.signal]);s._on("pagerendered",({pageNumber:c})=>{h.delete(c),h.size===0&&(this.#P=setTimeout(o,0))},{signal:d});return}}o()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(const i of this._pages)i.update(t);this.#W(),e||this.update()}}}class Fs{#e;constructor(e,t){this.#e=e;const i=[{element:e.presentationModeButton,eventName:"presentationmode",close:!0},{element:e.printButton,eventName:"print",close:!0},{element:e.downloadButton,eventName:"download",close:!0},{element:e.viewBookmarkButton,eventName:null,close:!0},{element:e.firstPageButton,eventName:"firstpage",close:!0},{element:e.lastPageButton,eventName:"lastpage",close:!0},{element:e.pageRotateCwButton,eventName:"rotatecw",close:!1},{element:e.pageRotateCcwButton,eventName:"rotateccw",close:!1},{element:e.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:V.SELECT},close:!0},{element:e.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:V.HAND},close:!0},{element:e.scrollPageButton,eventName:"switchscrollmode",eventDetails:{mode:C.PAGE},close:!0},{element:e.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:C.VERTICAL},close:!0},{element:e.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:C.HORIZONTAL},close:!0},{element:e.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:C.WRAPPED},close:!0},{element:e.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:x.NONE},close:!0},{element:e.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:x.ODD},close:!0},{element:e.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:x.EVEN},close:!0},{element:e.imageAltTextSettingsButton,eventName:"imagealttextsettings",close:!0},{element:e.documentPropertiesButton,eventName:"documentproperties",close:!0}];(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&i.push({element:e.openFileButton,eventName:"openfile",close:!0}),this.eventBus=t,this.opened=!1,this.#i(i),this.reset()}get isOpen(){return this.opened}setPageNumber(e){this.pageNumber=e,this.#t()}setPagesCount(e){this.pagesCount=e,this.#t()}reset(){this.pageNumber=0,this.pagesCount=0,this.#t(),this.eventBus.dispatch("switchcursortool",{source:this,reset:!0}),this.#a({mode:C.VERTICAL}),this.#s({mode:x.NONE})}#t(){const{firstPageButton:e,lastPageButton:t,pageRotateCwButton:i,pageRotateCcwButton:n}=this.#e;e.disabled=this.pageNumber<=1,t.disabled=this.pageNumber>=this.pagesCount,i.disabled=this.pagesCount===0,n.disabled=this.pagesCount===0}#i(e){const{eventBus:t}=this,{toggleButton:i}=this.#e;i.addEventListener("click",this.toggle.bind(this));for(const{element:n,eventName:s,close:a,eventDetails:o}of e)n.addEventListener("click",l=>{s!==null&&t.dispatch(s,{source:this,...o}),a&&this.close(),t.dispatch("reporttelemetry",{source:this,details:{type:"buttons",data:{id:n.id}}})});t._on("cursortoolchanged",this.#n.bind(this)),t._on("scrollmodechanged",this.#a.bind(this)),t._on("spreadmodechanged",this.#s.bind(this))}#n({tool:e,disabled:t}){const{cursorSelectToolButton:i,cursorHandToolButton:n}=this.#e;U(i,e===V.SELECT),U(n,e===V.HAND),i.disabled=t,n.disabled=t}#a({mode:e}){const{scrollPageButton:t,scrollVerticalButton:i,scrollHorizontalButton:n,scrollWrappedButton:s,spreadNoneButton:a,spreadOddButton:o,spreadEvenButton:l}=this.#e;U(t,e===C.PAGE),U(i,e===C.VERTICAL),U(n,e===C.HORIZONTAL),U(s,e===C.WRAPPED);const h=this.pagesCount>ce.FORCE_SCROLL_MODE_PAGE;t.disabled=h,i.disabled=h,n.disabled=h,s.disabled=h;const d=e===C.HORIZONTAL;a.disabled=d,o.disabled=d,l.disabled=d}#s({mode:e}){const{spreadNoneButton:t,spreadOddButton:i,spreadEvenButton:n}=this.#e;U(t,e===x.NONE),U(i,e===x.ODD),U(n,e===x.EVEN)}open(){if(this.opened)return;this.opened=!0;const{toggleButton:e,toolbar:t}=this.#e;X(e,!0,t)}close(){if(!this.opened)return;this.opened=!1;const{toggleButton:e,toolbar:t}=this.#e;X(e,!1,t)}toggle(){this.opened?this.close():this.open()}}const Qt=40;class Me{#e;#t=null;#i;#n;#a;#s;#r;#o=null;#h;#l=null;#d="";#c=null;#u;#f;#v;#p=null;#E=null;#g;#T;#P;#w;#m;#L;#b;#C;#S=null;#y;#_=null;#A=null;#N=!1;#I;#H=!1;#F;#O;#R;#D;#x=null;static#k=null;constructor({dialog:e,panels:t,typeButton:i,typeInput:n,drawButton:s,drawPlaceholder:a,drawSVG:o,drawThickness:l,imageButton:h,imageSVG:d,imagePlaceholder:c,imagePicker:u,imagePickerLink:p,description:f,clearButton:v,cancelButton:y,addButton:S,errorCloseButton:w,errorBar:b,saveCheckbox:E,saveContainer:P},_,D,A,F,H,q){this.#e=S,this.#i=v,this.#n=f.lastElementChild,this.#s=f.firstElementChild,this.#r=e,this.#u=o,this.#h=a,this.#f=l,this.#v=b,this.#w=d,this.#P=c,this.#g=u,this.#T=p,this.#O=A,this.#m=E,this.#L=P,this.#C=D,this.#y=n,this.#F=F,this.#D=H,this.#I=q,this.#R=new Os(_,A),Me.#k||=Object.freeze({signature:"pdfjs-editor-add-signature-description-default-when-drawing"}),e.addEventListener("close",this.#ee.bind(this)),e.addEventListener("contextmenu",M=>{const{target:N}=M;N!==this.#y&&N!==this.#s&&M.preventDefault()}),e.addEventListener("drop",M=>{Q(M)}),y.addEventListener("click",this.#q.bind(this)),S.addEventListener("click",this.#te.bind(this)),v.addEventListener("click",()=>{this.#X({type:"signature",action:"pdfjs.signature.clear",data:{type:this.#_}}),this.#G(null)},{passive:!0}),this.#s.addEventListener("input",()=>{this.#n.disabled=this.#s.value===""},{passive:!0}),this.#n.addEventListener("click",()=>{this.#s.value="",this.#n.disabled=!0},{passive:!0}),w.addEventListener("click",()=>{b.hidden=!0},{passive:!0}),this.#U(i,s,h,t),u.accept=ye.join(","),q._on("storedsignatureschanged",this.#Q.bind(this)),A.register(e)}#U(e,t,i,n){const s=this.#b=new Map([["type",e],["draw",t],["image",i]]),a=l=>{for(const[h,d]of s)d===l.target?(d.setAttribute("aria-selected",!0),d.setAttribute("tabindex",0),n.setAttribute("data-selected",h),this.#G(h)):(d.setAttribute("aria-selected",!1),d.setAttribute("tabindex",-1))},o=Array.from(s.values());for(let l=0,h=o.length;l<h;l++){const d=o[l];d.addEventListener("click",a,{passive:!0}),d.addEventListener("keydown",({key:c})=>{c!=="ArrowLeft"&&c!=="ArrowRight"||o[l+(c==="ArrowLeft"?-1:1)]?.focus()},{passive:!0})}}#M(){this.#N=!1,this.#s.value="",this.#_&&(this.#t.get(this.#_).value="")}#V(e){switch(e){case"type":this.#y.value="";break;case"draw":this.#o=null,this.#c=null,this.#d="",this.#l?.remove(),this.#l=null,this.#h.hidden=!1,this.#f.value=1;break;case"image":this.#P.hidden=!1,this.#E?.remove(),this.#E=null;break}}#G(e){if(e&&this.#_===e)return;this.#_&&(this.#t.get(this.#_).value=this.#s.value),e&&(this.#_=e),this.#v.hidden=!0;const t=!e;switch(t?this.#M():this.#s.value=this.#t.get(this.#_).value,this.#n.disabled=this.#s.value==="",this.#A?.abort(),this.#A=new AbortController,this.#_){case"type":this.#$(t);break;case"draw":this.#z(t);break;case"image":this.#K(t);break}}#B(e){(!e||!this.#H)&&(this.#m.disabled=!e),this.#i.disabled=this.#e.disabled=this.#s.disabled=!e}#$(e){e&&this.#V("type"),this.#B(this.#y.value);const{signal:t}=this.#A,i={passive:!0,signal:t};this.#y.addEventListener("input",()=>{const{value:n}=this.#y;this.#N||(this.#t.get("type").default=this.#s.value=n,this.#n.disabled=n===""),this.#B(n)},i),this.#s.addEventListener("input",()=>{this.#N=this.#y.value!==this.#s.value},i)}#z(e){e&&this.#V("draw"),this.#B(this.#l);const{signal:t}=this.#A,i={signal:t};let n=NaN;const s=a=>{const{pointerId:o}=a;if(!isNaN(n)&&n!==o)return;n=o,a.preventDefault(),this.#u.setPointerCapture(o);const{width:l,height:h}=this.#u.getBoundingClientRect();let{offsetX:d,offsetY:c}=a;if(d=Math.round(d),c=Math.round(c),a.target===this.#h&&(this.#h.hidden=!0),!this.#o){this.#o={width:l,height:h,thickness:parseInt(this.#f.value),curves:[]},this.#B(!0);const f=new ue,v=this.#l=f.createElement("path");v.setAttribute("stroke-width",this.#f.value),this.#u.append(v),this.#u.addEventListener("pointerdown",s,i),this.#h.removeEventListener("pointerdown",s),this.#s.value===""&&this.#F.get(Me.#k.signature).then(y=>{this.#t.get("draw").default=y,this.#s.value||=y,this.#n.disabled=this.#s.value===""})}this.#c=[d,c],this.#o.curves.push({points:this.#c}),this.#d+=`M ${d} ${c}`,this.#l.setAttribute("d",this.#d);const u=new AbortController,p={signal:AbortSignal.any([t,u.signal])};this.#u.addEventListener("contextmenu",Re,p),this.#u.addEventListener("pointermove",f=>{f.preventDefault();let{offsetX:v,offsetY:y}=f;v=Math.round(v),y=Math.round(y);const S=this.#c;if(!(v<0||y<0||v>l||y>h||v===S.at(-2)&&y===S.at(-1))){if(S.length>=4){const[w,b,E,P]=S.slice(-4);this.#d+=`C${(w+5*E)/6} ${(b+5*P)/6} ${(5*E+v)/6} ${(5*P+y)/6} ${(E+v)/2} ${(P+y)/2}`}else this.#d+=`L${v} ${y}`;S.push(v,y),this.#l.setAttribute("d",this.#d)}},p),this.#u.addEventListener("pointerup",f=>{const{pointerId:v}=f;!isNaN(n)&&n!==v||(n=NaN,f.preventDefault(),this.#u.releasePointerCapture(v),u.abort(),this.#c.length===2&&(this.#d+=`L${this.#c[0]} ${this.#c[1]}`,this.#l.setAttribute("d",this.#d)))},p)};this.#o?this.#u.addEventListener("pointerdown",s,i):this.#h.addEventListener("pointerdown",s,i),this.#f.addEventListener("input",()=>{const{value:a}=this.#f;this.#f.setAttribute("data-l10n-args",JSON.stringify({thickness:a})),this.#o&&(this.#l.setAttribute("stroke-width",a),this.#o.thickness=a)},i)}#K(e){e&&this.#V("image"),this.#B(this.#E);const{signal:t}=this.#A,i={signal:t},n={passive:!0,signal:t};this.#T.addEventListener("keydown",s=>{const{key:a}=s;(a==="Enter"||a===" ")&&(Q(s),this.#g.click())},i),this.#g.addEventListener("click",()=>{this.#r.classList.toggle("waiting",!0)},n),this.#g.addEventListener("change",async()=>{const s=this.#g.files?.[0];if(!s||!ye.includes(s.type)){this.#v.hidden=!1,this.#r.classList.toggle("waiting",!1);return}await this.#W(s)},n),this.#g.addEventListener("cancel",()=>{this.#r.classList.toggle("waiting",!1)},n),this.#P.addEventListener("dragover",s=>{const{dataTransfer:a}=s;for(const{type:o}of a.items)if(ye.includes(o)){a.dropEffect=a.effectAllowed==="copy"?"copy":"move",Q(s);return}a.dropEffect="none"},i),this.#P.addEventListener("drop",s=>{const{dataTransfer:{files:a}}=s;if(a?.length){for(const o of a)if(ye.includes(o.type)){this.#W(o);break}Q(s),this.#r.classList.toggle("waiting",!0)}},i)}async#W(e){let t;try{t=await this.#x.imageManager.getFromFile(e)}catch(a){console.error("SignatureManager.#extractSignature.",a)}if(!t){this.#v.hidden=!1,this.#r.classList.toggle("waiting",!1);return}const{outline:i}=this.#p=this.#a.getFromImage(t.bitmap);if(!i){this.#r.classList.toggle("waiting",!1);return}this.#P.hidden=!0,this.#B(!0);const n=new ue,s=this.#E=n.createElement("path");this.#w.setAttribute("viewBox",i.viewBox),this.#w.setAttribute("preserveAspectRatio","xMidYMid meet"),this.#w.append(s),s.setAttribute("d",i.toSVGPath()),this.#t.get("image").default=e.name,this.#s.value===""&&(this.#s.value=e.name||"",this.#n.disabled=this.#s.value===""),this.#r.classList.toggle("waiting",!1)}#J(){return this.#a.getFromText(this.#y.value,window.getComputedStyle(this.#y))}#j(){const{width:e,height:t}=this.#u.getBoundingClientRect();return this.#a.getDrawnSignature(this.#o,e,t)}#X(e){this.#I.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}#Y(e,t,i){const{curves:n,areContours:s,thickness:a,width:o,height:l}=e,h=Math.max(o,l),d=Oe.processDrawnLines({lines:{curves:n,thickness:a,width:o,height:l},pageWidth:h,pageHeight:h,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});if(!d)return;const{outline:c}=d,u=new ue,p=document.createElement("div"),f=document.createElement("button");f.addEventListener("click",()=>{this.#I.dispatch("switchannotationeditorparams",{source:this,type:j.CREATE,value:{signatureData:{lines:{curves:n,thickness:a,width:o,height:l},mustSmooth:!1,areContours:s,description:i,uuid:t,heightInPage:Qt}}})}),p.append(f),p.classList.add("toolbarAddSignatureButtonContainer");const v=u.create(1,1,!0);f.append(v);const y=document.createElement("span");y.ariaHidden=!0,f.append(y),f.classList.add("toolbarAddSignatureButton"),f.type="button",y.textContent=i,f.setAttribute("data-l10n-id","pdfjs-editor-add-saved-signature-button"),f.setAttribute("data-l10n-args",JSON.stringify({description:i})),f.tabIndex=0;const S=u.createElement("path");v.append(S),v.setAttribute("viewBox",c.viewBox),v.setAttribute("preserveAspectRatio","xMidYMid meet"),s&&S.classList.add("contours"),S.setAttribute("d",c.toSVGPath());const w=document.createElement("button");p.append(w),w.classList.add("toolbarButton","deleteButton"),w.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button1"),w.type="button",w.tabIndex=0,w.addEventListener("click",async()=>{await this.#D.delete(t)&&(p.remove(),this.#X({type:"signature",action:"pdfjs.signature.delete_saved",data:{savedCount:await this.#D.size()}}))});const b=document.createElement("span");w.append(b),b.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button-label1"),this.#C.before(p)}async#Q(){const e=this.#C.parentElement;for(;e.firstElementChild!==this.#C;)e.firstElementChild.remove();this.#S=null,await this.loadSignatures(!0)}getSignature(e){return this.open(e)}async loadSignatures(e=!1){if(!this.#C||!e&&this.#C.previousElementSibling||!this.#D||!this.#S&&(this.#S=this.#D.getAll().then(async s=>[s,await Promise.all(Array.from(s.values(),({signatureData:a})=>Oe.decompressSignature(a)))]),!e))return;const[t,i]=await this.#S;this.#S=null;let n=0;for(const[s,{description:a}]of t){const o=i[n++];o&&(o.curves=o.outlines.map(l=>({points:l})),delete o.outlines,this.#Y(o,s,a))}}async renderEditButton(e){const t=document.createElement("button");t.classList.add("altText","editDescription"),t.tabIndex=0,e.description&&(t.title=e.description);const i=document.createElement("span");return t.append(i),i.setAttribute("data-l10n-id","pdfjs-editor-add-signature-edit-button-label"),t.addEventListener("click",()=>{this.#R.open(e)},{passive:!0}),t}async open({uiManager:e,editor:t}){this.#t||=new Map(this.#b.keys().map(s=>[s,{value:"",default:""}])),this.#x=e,this.#a=t,this.#x.removeEditListeners();const i=this.#H=await this.#D.isFull();this.#L.classList.toggle("fullStorage",i),this.#m.checked=!i,await this.#O.open(this.#r);const n=this.#b.get("type");n.focus(),n.click()}#q(){this.#Z()}#Z(){this.#O.closeIfActive(this.#r)}#ee(){this.#a._drawId===null&&this.#a.remove(),this.#x?.addEditListeners(),this.#A?.abort(),this.#A=null,this.#x=null,this.#a=null,this.#M();for(const[e]of this.#b)this.#V(e);this.#B(!1),this.#_=null,this.#t=null}async#te(){let e;const t=this.#_;switch(t){case"type":e=this.#J();break;case"draw":e=this.#j();break;case"image":e=this.#p;break}let i=null;const n=this.#s.value;if(this.#m.checked){const{newCurves:a,areContours:o,thickness:l,width:h,height:d}=e,c=await Oe.compressSignature({outlines:a,areContours:o,thickness:l,width:h,height:d});i=await this.#D.create({description:n,signatureData:c}),i?this.#Y({curves:a.map(u=>({points:u})),areContours:o,thickness:l,width:h,height:d},i,n):console.warn("SignatureManager.add: cannot save the signature.")}const s=this.#t.get(t);this.#X({type:"signature",action:"pdfjs.signature.created",data:{type:t,saved:!!i,savedCount:await this.#D.size(),descriptionChanged:n!==s.default}}),this.#a.addSignature(e,Qt,this.#s.value,i),this.#Z()}destroy(){this.#x=null,this.#Z()}}class Os{#e;#t;#i;#n;#a;#s;#r;constructor({dialog:e,description:t,cancelButton:i,updateButton:n,editSignatureView:s},a){const o=this.#i=t.firstElementChild;this.#s=s,this.#n=e,this.#a=a,e.addEventListener("close",this.#d.bind(this)),e.addEventListener("contextmenu",h=>{h.target!==this.#i&&h.preventDefault()}),i.addEventListener("click",this.#h.bind(this)),n.addEventListener("click",this.#o.bind(this));const l=t.lastElementChild;l.addEventListener("click",()=>{o.value="",l.disabled=!0,n.disabled=this.#t===""}),o.addEventListener("input",()=>{const{value:h}=o;l.disabled=h==="",n.disabled=h===this.#t,s.setAttribute("aria-label",h)},{passive:!0}),a.register(e)}async open(e){this.#r=e._uiManager,this.#e=e,this.#t=this.#i.value=e.description,this.#i.dispatchEvent(new Event("input")),this.#r.removeEditListeners();const{areContours:t,outline:i}=e.getSignaturePreview(),s=new ue().createElement("path");this.#s.append(s),this.#s.setAttribute("viewBox",i.viewBox),s.setAttribute("d",i.toSVGPath()),t&&s.classList.add("contours"),await this.#a.open(this.#n)}async#o(){this.#e._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!0}}),this.#e.description=this.#i.value,this.#l()}#h(){this.#e._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!1}}),this.#l()}#l(){this.#a.closeIfActive(this.#n)}#d(){this.#r?.addEditListeners(),this.#r=null,this.#e=null,this.#s.firstElementChild.remove()}}class qt{#e=null;#t;constructor(e,t,i=0){this.#t=e,this.eventBus=t;const n=[{element:e.previous,eventName:"previouspage"},{element:e.next,eventName:"nextpage"},{element:e.zoomIn,eventName:"zoomin"},{element:e.zoomOut,eventName:"zoomout"},{element:e.print,eventName:"print"},{element:e.download,eventName:"download"},{element:e.editorFreeTextButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:s}=e.editorFreeTextButton;return s.contains("toggled")?L.NONE:L.FREETEXT}}},{element:e.editorHighlightButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:s}=e.editorHighlightButton;return s.contains("toggled")?L.NONE:L.HIGHLIGHT}}},{element:e.editorInkButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:s}=e.editorInkButton;return s.contains("toggled")?L.NONE:L.INK}}},{element:e.editorStampButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:s}=e.editorStampButton;return s.contains("toggled")?L.NONE:L.STAMP}},telemetry:{type:"editing",data:{action:"pdfjs.image.icon_click"}}},{element:e.editorSignatureButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:s}=e.editorSignatureButton;return s.contains("toggled")?L.NONE:L.SIGNATURE}}}];this.#n(n),this.#i({value:i}),this.reset()}#i({value:e}){let t="normal";switch(e){case 1:t="compact";break;case 2:t="touch";break}document.documentElement.setAttribute("data-toolbar-density",t)}setPageNumber(e,t){this.pageNumber=e,this.pageLabel=t,this.#s(!1)}setPagesCount(e,t){this.pagesCount=e,this.hasPageLabels=t,this.#s(!0)}setPageScale(e,t){this.pageScaleValue=(e||t).toString(),this.pageScale=t,this.#s(!1)}reset(){this.#e=null,this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=fe,this.pageScale=st,this.#s(!0),this.updateLoadingIndicatorState(),this.#a({mode:L.DISABLE})}#n(e){const{eventBus:t}=this,{editorHighlightColorPicker:i,editorHighlightButton:n,pageNumber:s,scaleSelect:a}=this.#t,o=this;for(const{element:l,eventName:h,eventDetails:d,telemetry:c}of e)l.addEventListener("click",u=>{h!==null&&t.dispatch(h,{source:this,...d,isFromKeyboard:u.detail===0}),c&&t.dispatch("reporttelemetry",{source:this,details:c})});s.addEventListener("click",function(){this.select()}),s.addEventListener("change",function(){t.dispatch("pagenumberchanged",{source:o,value:this.value})}),a.addEventListener("change",function(){this.value!=="custom"&&t.dispatch("scalechanged",{source:o,value:this.value})}),a.addEventListener("click",function({target:l}){this.value===o.pageScaleValue&&l.tagName.toUpperCase()==="OPTION"&&this.blur()}),a.oncontextmenu=Re,t._on("annotationeditormodechanged",this.#a.bind(this)),t._on("showannotationeditorui",({mode:l})=>{switch(l){case L.HIGHLIGHT:n.click();break}}),t._on("toolbardensity",this.#i.bind(this)),i&&(t._on("annotationeditoruimanager",({uiManager:l})=>{const h=this.#e=new Ji({uiManager:l});l.setMainHighlightColorPicker(h),i.append(h.renderMainDropdown())}),t._on("mainhighlightcolorpickerupdatecolor",({value:l})=>{this.#e?.updateColor(l)}))}#a({mode:e}){const{editorFreeTextButton:t,editorFreeTextParamsToolbar:i,editorHighlightButton:n,editorHighlightParamsToolbar:s,editorInkButton:a,editorInkParamsToolbar:o,editorStampButton:l,editorStampParamsToolbar:h,editorSignatureButton:d,editorSignatureParamsToolbar:c}=this.#t;X(t,e===L.FREETEXT,i),X(n,e===L.HIGHLIGHT,s),X(a,e===L.INK,o),X(l,e===L.STAMP,h),X(d,e===L.SIGNATURE,c);const u=e===L.DISABLE;t.disabled=u,n.disabled=u,a.disabled=u,l.disabled=u,d.disabled=u}#s(e=!1){const{pageNumber:t,pagesCount:i,pageScaleValue:n,pageScale:s}=this,a=this.#t;e&&(this.hasPageLabels?(a.pageNumber.type="text",a.numPages.setAttribute("data-l10n-id","pdfjs-page-of-pages")):(a.pageNumber.type="number",a.numPages.setAttribute("data-l10n-id","pdfjs-of-pages"),a.numPages.setAttribute("data-l10n-args",JSON.stringify({pagesCount:i}))),a.pageNumber.max=i),this.hasPageLabels?(a.pageNumber.value=this.pageLabel,a.numPages.setAttribute("data-l10n-args",JSON.stringify({pageNumber:t,pagesCount:i}))):a.pageNumber.value=t,a.previous.disabled=t<=1,a.next.disabled=t>=i,a.zoomOut.disabled=s<=li,a.zoomIn.disabled=s>=hi;let o=!1;for(const l of a.scaleSelect.options){if(l.value!==n){l.selected=!1;continue}l.selected=!0,o=!0}o||(a.customScaleOption.selected=!0,a.customScaleOption.setAttribute("data-l10n-args",JSON.stringify({scale:Math.round(s*1e4)/100})))}updateLoadingIndicatorState(e=!1){const{pageNumber:t}=this.#t;t.classList.toggle("loading",e)}}const Vs=20;class Hs{constructor(e,t=Vs){this.fingerprint=e,this.cacheSize=t,this._initializedPromise=this._readFromStorage().then(i=>{const n=JSON.parse(i||"{}");let s=-1;if(!Array.isArray(n.files))n.files=[];else{for(;n.files.length>=this.cacheSize;)n.files.shift();for(let a=0,o=n.files.length;a<o;a++)if(n.files[a].fingerprint===this.fingerprint){s=a;break}}s===-1&&(s=n.files.push({fingerprint:this.fingerprint})-1),this.file=n.files[s],this.database=n})}async _writeToStorage(){const e=JSON.stringify(this.database);if(typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")){sessionStorage.setItem("pdfjs.history",e);return}localStorage.setItem("pdfjs.history",e)}async _readFromStorage(){return typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?sessionStorage.getItem("pdfjs.history"):localStorage.getItem("pdfjs.history")}async set(e,t){return await this._initializedPromise,this.file[e]=t,this._writeToStorage()}async setMultiple(e){await this._initializedPromise;for(const t in e)this.file[t]=e[t];return this._writeToStorage()}async get(e,t){await this._initializedPromise;const i=this.file[e];return i!==void 0?i:t}async getMultiple(e){await this._initializedPromise;const t=Object.create(null);for(const i in e){const n=this.file[i];t[i]=n!==void 0?n:e[i]}return t}}const Us=1e4,Ze={UNKNOWN:-1,INITIAL:1},ct={initialBookmark:document.location.hash.substring(1),_initializedCapability:{...Promise.withResolvers(),settled:!1},appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:new fn,toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,annotationEditorParams:null,imageAltTextSettings:null,isInitialViewSet:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",mlManager:null,_downloadUrl:"",_eventBusAbortController:null,_windowAbortController:null,_globalAbortController:new AbortController,documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,_saveInProgress:!1,_wheelUnusedTicks:0,_wheelUnusedFactor:1,_touchManager:null,_touchUnusedTicks:0,_touchUnusedFactor:1,_PDFBug:null,_hasAnnotationEditors:!1,_title:document.title,_printAnnotationStoragePromise:null,_isCtrlKeyDown:!1,_caretBrowsing:null,_isScrolling:!1,editorUndoBar:null,async initialize(r){this.appConfig=r;try{await this.preferences.initializedPromise}catch(t){console.error("initialize:",t)}m.get("pdfBugEnabled")&&await this._parseHashParams();let e;switch(m.get("viewerCssTheme")){case 1:e="light";break;case 2:e="dark";break}e&&rt.setProperty("color-scheme",e),typeof PDFJSDev>"u"||PDFJSDev.test("TESTING")?m.get("enableFakeMLManager")&&(this.mlManager=Ae.getFakeMLManager?.({enableGuessAltText:m.get("enableGuessAltText"),enableAltTextModelDownload:m.get("enableAltTextModelDownload")})||null):PDFJSDev.test("MOZCENTRAL")&&m.get("enableAltText")&&(this.mlManager=new Ae({enableGuessAltText:m.get("enableGuessAltText"),enableAltTextModelDownload:m.get("enableAltTextModelDownload"),altTextLearnMoreUrl:m.get("altTextLearnMoreUrl")})),this.l10n=await this.externalServices.createL10n(),document.getElementsByTagName("html")[0].dir=this.l10n.getDirection(),(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&this.l10n.translate(r.appContainer||document.documentElement),this.isViewerEmbedded&&m.get("externalLinkTarget")===ee.NONE&&m.set("externalLinkTarget",ee.TOP),await this._initializeViewerComponents(),this.bindEvents(),this.bindWindowEvents(),this._initializedCapability.settled=!0,this._initializedCapability.resolve()},async _parseHashParams(){const r=document.location.hash.substring(1);if(!r)return;const{mainContainer:e,viewerContainer:t}=this.appConfig,i=ve(r),n=async()=>{if(this._PDFBug)return;const{PDFBug:a}=typeof PDFJSDev>"u"?await import(m.get("debuggerSrc")):await __raw_import__(m.get("debuggerSrc"));this._PDFBug=a};if(i.get("disableworker")==="true")try{wt.workerSrc||=m.get("workerSrc"),typeof PDFJSDev>"u"?await ln(()=>import("https://registry.npmmirror.com/pdfjs-dist/5.3.93/files/build/pdf.worker.mjs"),[]):await __raw_import__(Xi.workerSrc),m.set("workerPort",null)}catch(a){console.error("_parseHashParams:",a)}if(i.has("textlayer"))switch(i.get("textlayer")){case"off":m.set("textLayerMode",K.DISABLE);break;case"visible":case"shadow":case"hover":t.classList.add(`textLayer-${i.get("textlayer")}`);try{await n(),this._PDFBug.loadCSS()}catch(a){console.error("_parseHashParams:",a)}break}if(i.has("pdfbug")){const a=i.get("pdfbug").split(",");try{await n(),this._PDFBug.init(e,a)}catch(l){console.error("_parseHashParams:",l)}const o={pdfBug:!0,fontExtraProperties:!0};globalThis.StepperManager?.enabled&&(o.minDurationToUpdateCanvas=0),m.setAll(o)}(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&i.has("locale")&&m.set("localeProperties",{lang:i.get("locale")});const s={disableAutoFetch:a=>a==="true",disableFontFace:a=>a==="true",disableHistory:a=>a==="true",disableRange:a=>a==="true",disableStream:a=>a==="true",verbosity:a=>a|0};typeof PDFJSDev<"u"&&PDFJSDev.test("TESTING")&&Object.assign(s,{capCanvasAreaFactor:a=>parseInt(a),docBaseUrl:a=>a,enableAltText:a=>a==="true",enableAutoLinking:a=>a==="true",enableFakeMLManager:a=>a==="true",enableGuessAltText:a=>a==="true",enableUpdatedAddImage:a=>a==="true",highlightEditorColors:a=>a,maxCanvasPixels:a=>parseInt(a),spreadModeOnLoad:a=>parseInt(a),supportsCaretBrowsingMode:a=>a==="true",viewerCssTheme:a=>parseInt(a)});for(const a in s){const o=s[a],l=a.toLowerCase();i.has(l)&&m.set(a,o(i.get(l)))}},async _initializeViewerComponents(){const{appConfig:r,externalServices:e,l10n:t,mlManager:i}=this,n=this._globalAbortController.signal,s=typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?new hn(m.get("allowedGlobalEvents"),e,m.get("isInAutomation")):new lt;this.eventBus=m.eventBus=s,i?.setEventBus(s,n);const a=this.overlayManager=new yn,o=this.pdfRenderingQueue=new Pi;o.onIdle=this._cleanup.bind(this);const l=this.pdfLinkService=new mi({eventBus:s,externalLinkTarget:m.get("externalLinkTarget"),externalLinkRel:m.get("externalLinkRel"),ignoreDestinationZoom:m.get("ignoreDestinationZoom")}),h=this.downloadManager=new wn,d=this.findController=new Xn({linkService:l,eventBus:s,updateMatchesCountOnProgress:typeof PDFJSDev>"u"?!window.isGECKOVIEW:!PDFJSDev.test("GECKOVIEW")}),c=this.pdfScriptingManager=new ps({eventBus:s,externalServices:e,docProperties:this._scriptingDocProperties.bind(this)}),u=r.mainContainer,p=r.viewerContainer,f=m.get("annotationEditorMode"),v=m.get("forcePageColors")||window.matchMedia("(forced-colors: active)").matches?{background:m.get("pageColorsBackground"),foreground:m.get("pageColorsForeground")}:null;let y;m.get("enableUpdatedAddImage")?y=r.newAltTextDialog?new mn(r.newAltTextDialog,a,s):null:y=r.altTextDialog?new En(r.altTextDialog,u,a,s):null,r.editorUndoBar&&(this.editorUndoBar=new Ne(r.editorUndoBar,s));const S=m.get("enableSignatureEditor")&&r.addSignatureDialog?new Me(r.addSignatureDialog,r.editSignatureDialog,r.annotationEditorParams?.editorSignatureAddSignature||null,a,t,e.createSignatureStorage(s,n),s):null,w=m.get("enableHWA"),b=m.get("maxCanvasPixels"),E=m.get("maxCanvasDim"),P=m.get("capCanvasAreaFactor"),_=this.pdfViewer=new ks({container:u,viewer:p,viewerAlert:r.viewerAlert,eventBus:s,renderingQueue:o,linkService:l,downloadManager:h,altTextManager:y,signatureManager:S,editorUndoBar:this.editorUndoBar,findController:d,scriptingManager:m.get("enableScripting")&&c,l10n:t,textLayerMode:m.get("textLayerMode"),annotationMode:m.get("annotationMode"),annotationEditorMode:f,annotationEditorHighlightColors:m.get("highlightEditorColors"),enableHighlightFloatingButton:m.get("enableHighlightFloatingButton"),enableUpdatedAddImage:m.get("enableUpdatedAddImage"),enableNewAltTextWhenAddingImage:m.get("enableNewAltTextWhenAddingImage"),imageResourcesPath:m.get("imageResourcesPath"),enablePrintAutoRotate:m.get("enablePrintAutoRotate"),maxCanvasPixels:b,maxCanvasDim:E,capCanvasAreaFactor:P,enableDetailCanvas:m.get("enableDetailCanvas"),enablePermissions:m.get("enablePermissions"),pageColors:v,mlManager:i,abortSignal:n,enableHWA:w,supportsPinchToZoom:this.supportsPinchToZoom,enableAutoLinking:m.get("enableAutoLinking"),minDurationToUpdateCanvas:m.get("minDurationToUpdateCanvas")});if(o.setViewer(_),l.setViewer(_),c.setViewer(_),r.sidebar?.thumbnailView&&(this.pdfThumbnailViewer=new ys({container:r.sidebar.thumbnailView,eventBus:s,renderingQueue:o,linkService:l,maxCanvasPixels:b,maxCanvasDim:E,pageColors:v,abortSignal:n,enableHWA:w}),o.setThumbnailViewer(this.pdfThumbnailViewer)),!this.isViewerEmbedded&&!m.get("disableHistory")&&(this.pdfHistory=new ts({linkService:l,eventBus:s}),l.setHistory(this.pdfHistory)),!this.supportsIntegratedFind&&r.findBar&&(this.findBar=new Yn(r.findBar,r.principalContainer,s)),r.annotationEditorParams)if(f!==L.DISABLE){const D=r.toolbar?.editorSignatureButton;D&&m.get("enableSignatureEditor")&&(D.parentElement.hidden=!1),this.annotationEditorParams=new bn(r.annotationEditorParams,s)}else for(const D of["editorModeButtons","editorModeSeparator"])document.getElementById(D)?.classList.add("hidden");if(i&&r.secondaryToolbar?.imageAltTextSettingsButton&&(this.imageAltTextSettings=new vn(r.altTextSettingsDialog,a,s,i)),r.documentProperties&&(this.pdfDocumentProperties=new Ln(r.documentProperties,a,s,t,()=>this._docFilename,()=>this._docTitle)),r.secondaryToolbar?.cursorHandToolButton&&(this.pdfCursorTools=new Tn({container:u,eventBus:s,cursorToolOnLoad:m.get("cursorToolOnLoad")})),r.toolbar)if(typeof PDFJSDev>"u"?window.isGECKOVIEW:PDFJSDev.test("GECKOVIEW")){const D=JSON.parse(m.get("nimbusDataStr")||"null");this.toolbar=new qt(r.toolbar,s,D)}else this.toolbar=new qt(r.toolbar,s,m.get("toolbarDensity"));r.secondaryToolbar&&(m.get("enableAltText")&&(r.secondaryToolbar.imageAltTextSettingsButton?.classList.remove("hidden"),r.secondaryToolbar.imageAltTextSettingsSeparator?.classList.remove("hidden")),this.secondaryToolbar=new Fs(r.secondaryToolbar,s)),this.supportsFullscreen&&r.secondaryToolbar?.presentationModeButton&&(this.pdfPresentationMode=new hs({container:u,pdfViewer:_,eventBus:s})),r.passwordOverlay&&(this.passwordPrompt=new Pn(r.passwordOverlay,a,this.isViewerEmbedded)),r.sidebar?.outlineView&&(this.pdfOutlineViewer=new as({container:r.sidebar.outlineView,eventBus:s,l10n:t,linkService:l,downloadManager:h})),r.sidebar?.attachmentsView&&(this.pdfAttachmentViewer=new _n({container:r.sidebar.attachmentsView,eventBus:s,l10n:t,downloadManager:h})),r.sidebar?.layersView&&(this.pdfLayerViewer=new ss({container:r.sidebar.layersView,eventBus:s,l10n:t})),r.sidebar&&(this.pdfSidebar=new vs({elements:r.sidebar,eventBus:s,l10n:t}),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.pdfSidebar.onUpdateThumbnails=()=>{for(const D of _.getCachedPageViews())D.renderingState===T.FINISHED&&this.pdfThumbnailViewer.getThumbnail(D.id-1)?.setImage(D);this.pdfThumbnailViewer.scrollThumbnailIntoView(_.currentPageNumber)})},async run(r){await this.initialize(r);const{appConfig:e,eventBus:t}=this;let i;if(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")){const n=document.location.search.substring(1);i=ve(n).get("file")??m.get("defaultUrl");try{i=new URL(decodeURIComponent(i)).href}catch{i=encodeURIComponent(i).replaceAll("%2F","/")}Ws(i)}else PDFJSDev.test("MOZCENTRAL")?i=window.location.href:PDFJSDev.test("CHROME")&&(i=m.get("defaultUrl"));if(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")){const n=this._openFileInput=document.createElement("input");n.id="fileInput",n.hidden=!0,n.type="file",n.value=null,document.body.append(n),n.addEventListener("change",function(s){const{files:a}=s.target;!a||a.length===0||t.dispatch("fileinputchange",{source:this,fileInput:s.target})}),e.mainContainer.addEventListener("dragover",function(s){for(const a of s.dataTransfer.items)if(a.type==="application/pdf"){s.dataTransfer.dropEffect=s.dataTransfer.effectAllowed==="copy"?"copy":"move",Q(s);return}}),e.mainContainer.addEventListener("drop",function(s){s.dataTransfer.files?.[0].type==="application/pdf"&&(Q(s),t.dispatch("fileinputchange",{source:this,fileInput:s.dataTransfer}))})}if(m.get("supportsDocumentFonts")||(m.set("disableFontFace",!0),this.l10n.get("pdfjs-web-fonts-disabled").then(n=>{console.warn(n)})),this.supportsPrinting||(e.toolbar?.print?.classList.add("hidden"),e.secondaryToolbar?.printButton.classList.add("hidden")),this.supportsFullscreen||e.secondaryToolbar?.presentationModeButton.classList.add("hidden"),this.supportsIntegratedFind&&e.findBar?.toggleButton?.classList.add("hidden"),typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))i?this.open({url:i}):this._hideViewBookmark();else if(PDFJSDev.test("MOZCENTRAL || CHROME"))this.setTitleUsingUrl(i,i),this.externalServices.initPassiveLoading();else throw new Error("Not implemented: run")},get externalServices(){return O(this,"externalServices",new gn)},get initialized(){return this._initializedCapability.settled},get initializedPromise(){return this._initializedCapability.promise},updateZoom(r,e,t){this.pdfViewer.isInPresentationMode||this.pdfViewer.updateScale({drawingDelay:m.get("defaultZoomDelay"),steps:r,scaleFactor:e,origin:t})},zoomIn(){this.updateZoom(1)},zoomOut(){this.updateZoom(-1)},zoomReset(){this.pdfViewer.isInPresentationMode||(this.pdfViewer.currentScaleValue=fe)},touchPinchCallback(r,e,t){if(this.supportsPinchToZoom){const i=this._accumulateFactor(this.pdfViewer.currentScale,t/e,"_touchUnusedFactor");this.updateZoom(null,i,r)}else{const n=this._accumulateTicks((t-e)/30,"_touchUnusedTicks");this.updateZoom(n,null,r)}},touchPinchEndCallback(){this._touchUnusedTicks=0,this._touchUnusedFactor=1},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},get page(){return this.pdfViewer.currentPageNumber},set page(r){this.pdfViewer.currentPageNumber=r},get supportsPrinting(){return O(this,"supportsPrinting",m.get("supportsPrinting")&&tt.supportsPrinting)},get supportsFullscreen(){return O(this,"supportsFullscreen",document.fullscreenEnabled)},get supportsPinchToZoom(){return O(this,"supportsPinchToZoom",m.get("supportsPinchToZoom"))},get supportsIntegratedFind(){return O(this,"supportsIntegratedFind",m.get("supportsIntegratedFind"))},get loadingBar(){const r=document.getElementById("loadingBar"),e=r?new nn(r):null;return O(this,"loadingBar",e)},get supportsMouseWheelZoomCtrlKey(){return O(this,"supportsMouseWheelZoomCtrlKey",m.get("supportsMouseWheelZoomCtrlKey"))},get supportsMouseWheelZoomMetaKey(){return O(this,"supportsMouseWheelZoomMetaKey",m.get("supportsMouseWheelZoomMetaKey"))},get supportsCaretBrowsingMode(){return m.get("supportsCaretBrowsingMode")},moveCaret(r,e){this._caretBrowsing||=new xe(this._globalAbortController.signal,this.appConfig.mainContainer,this.appConfig.viewerContainer,this.appConfig.toolbar?.container),this._caretBrowsing.moveCaret(r,e)},setTitleUsingUrl(r="",e=null){this.url=r,this.baseUrl=typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?le(r,"",!0):le(r,""),e&&(this._downloadUrl=e===r?this.baseUrl:typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?le(e,"",!0):le(e,"")),bt(r)?this._hideViewBookmark():typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL || CHROME")&&m.set("docBaseUrl",this.baseUrl);let t=yt(r,"");if(!t)try{t=decodeURIComponent(Ki(r))}catch{}this.setTitle(t||r)},setTitle(r=this._title){if(this._title=r,this.isViewerEmbedded)return;const e=this._hasAnnotationEditors&&!this.pdfRenderingQueue.printing;document.title=`${e?"* ":""}${r}`},get _docFilename(){return this._contentDispositionFilename||yt(this.url)},get _docTitle(){const{documentInfo:r,metadata:e}=this,t=e?.get("dc:title");return t&&t!=="Untitled"&&!/[\uFFF0-\uFFFF]/g.test(t)?t:r.Title},_hideViewBookmark(){const{secondaryToolbar:r}=this.appConfig;r?.viewBookmarkButton.classList.add("hidden"),r?.presentationModeButton.classList.contains("hidden")&&document.getElementById("viewBookmarkSeparator")?.classList.add("hidden")},async close(){if(this._unblockDocumentLoadEvent(),this._hideViewBookmark(),!this.pdfLoadingTask)return;if((typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC && !TESTING"))&&this.pdfDocument?.annotationStorage.size>0&&this._annotationStorageModified)try{await this.save()}catch{}const r=[];r.push(this.pdfLoadingTask.destroy()),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,this.pdfThumbnailViewer?.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null),this.pdfDocumentProperties?.setDocument(null)),this.pdfLinkService.externalLinkEnabled=!0,this.store=null,this.isInitialViewSet=!1,this.url="",this.baseUrl="",this._downloadUrl="",this.documentInfo=null,this.metadata=null,this._contentDispositionFilename=null,this._contentLength=null,this._saveInProgress=!1,this._hasAnnotationEditors=!1,r.push(this.pdfScriptingManager.destroyPromise,this.passwordPrompt.close()),this.setTitle(),this.pdfSidebar?.reset(),this.pdfOutlineViewer?.reset(),this.pdfAttachmentViewer?.reset(),this.pdfLayerViewer?.reset(),this.pdfHistory?.reset(),this.findBar?.reset(),this.toolbar?.reset(),this.secondaryToolbar?.reset(),this._PDFBug?.cleanup(),await Promise.all(r)},async open(r){this.pdfLoadingTask&&await this.close();const e=m.getAll(g.WORKER);Object.assign(wt,e),typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")?r.data&&ai(r.filename)&&(this._contentDispositionFilename=r.filename):r.url&&this.setTitleUsingUrl(r.originalUrl||r.url,r.url);const t=m.getAll(g.API),i=zi({...t,...r});return this.pdfLoadingTask=i,i.onPassword=(n,s)=>{this.isViewerEmbedded&&this._unblockDocumentLoadEvent(),this.pdfLinkService.externalLinkEnabled=!1,this.passwordPrompt.setUpdateCallback(n,s),this.passwordPrompt.open()},i.onProgress=({loaded:n,total:s})=>{this.progress(n/s)},i.promise.then(n=>{this.load(n)},n=>{if(i!==this.pdfLoadingTask)return;let s="pdfjs-loading-error";return n instanceof ji?s="pdfjs-invalid-file-error":n instanceof $i&&(s=n.missing?"pdfjs-missing-file-error":"pdfjs-unexpected-response-error"),this._documentError(s,{message:n.message}).then(()=>{throw n})})},async download(){let r;try{r=await(this.pdfDocument?this.pdfDocument.getData():this.pdfLoadingTask.getData())}catch{}this.downloadManager.download(r,this._downloadUrl,this._docFilename)},async save(){if(!this._saveInProgress){this._saveInProgress=!0,await this.pdfScriptingManager.dispatchWillSave();try{const r=await this.pdfDocument.saveDocument();this.downloadManager.download(r,this._downloadUrl,this._docFilename)}catch(r){console.error("Error when saving the document:",r),await this.download()}finally{await this.pdfScriptingManager.dispatchDidSave(),this._saveInProgress=!1}this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"save",stats:this.pdfDocument?.annotationStorage.editorStats}})}},async downloadOrSave(){const{classList:r}=this.appConfig.appContainer;r.add("wait"),await(this.pdfDocument?.annotationStorage.size>0?this.save():this.download()),r.remove("wait")},async _documentError(r,e=null){this._unblockDocumentLoadEvent();const t=await this._otherError(r||"pdfjs-loading-error",e);this.eventBus.dispatch("documenterror",{source:this,message:t,reason:e?.message??null})},async _otherError(r,e=null){const t=await this.l10n.get(r),i=[`PDF.js v${vt} (build: ${Et})`];return e&&(i.push(`Message: ${e.message}`),e.stack?i.push(`Stack: ${e.stack}`):(e.filename&&i.push(`File: ${e.filename}`),e.lineNumber&&i.push(`Line: ${e.lineNumber}`))),console.error(`${t}

${i.join(`
`)}`),t},progress(r){const e=Math.round(r*100);!this.loadingBar||e<=this.loadingBar.percent||(this.loadingBar.percent=e,(this.pdfDocument?.loadingParams.disableAutoFetch??m.get("disableAutoFetch"))&&this.loadingBar.setDisableAutoFetch())},load(r){this.pdfDocument=r,r.getDownloadInfo().then(({length:h})=>{this._contentLength=h,this.loadingBar?.hide(),s.then(()=>{this.eventBus.dispatch("documentloaded",{source:this})})});const e=r.getPageLayout().catch(()=>{}),t=r.getPageMode().catch(()=>{}),i=r.getOpenAction().catch(()=>{});if(this.toolbar?.setPagesCount(r.numPages,!1),this.secondaryToolbar?.setPagesCount(r.numPages),typeof PDFJSDev<"u"&&PDFJSDev.test("CHROME")){const h=le(location,"");this.pdfLinkService.setDocument(r,bt(h)?null:h)}else this.pdfLinkService.setDocument(r);this.pdfDocumentProperties?.setDocument(r);const n=this.pdfViewer;n.setDocument(r);const{firstPagePromise:s,onePageRendered:a,pagesPromise:o}=n;this.pdfThumbnailViewer?.setDocument(r);const l=(this.store=new Hs(r.fingerprints[0])).getMultiple({page:null,zoom:fe,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:I.UNKNOWN,scrollMode:C.UNKNOWN,spreadMode:x.UNKNOWN}).catch(()=>{});s.then(h=>{this.loadingBar?.setWidth(this.appConfig.viewerContainer),this._initializeAnnotationStorageCallbacks(r),Promise.all([tn,l,e,t,i]).then(async([d,c,u,p,f])=>{const v=m.get("viewOnLoad");this._initializePdfHistory({fingerprint:r.fingerprints[0],viewOnLoad:v,initialDest:f?.dest});const y=this.initialBookmark,S=m.get("defaultZoomValue");let w=S?`zoom=${S}`:null,b=null,E=m.get("sidebarViewOnLoad"),P=m.get("scrollModeOnLoad"),_=m.get("spreadModeOnLoad");c?.page&&v!==Ze.INITIAL&&(w=`page=${c.page}&zoom=${S||c.zoom},${c.scrollLeft},${c.scrollTop}`,b=parseInt(c.rotation,10),E===I.UNKNOWN&&(E=c.sidebarView|0),P===C.UNKNOWN&&(P=c.scrollMode|0),_===x.UNKNOWN&&(_=c.spreadMode|0)),p&&E===I.UNKNOWN&&(E=sn(p)),u&&P===C.UNKNOWN&&_===x.UNKNOWN&&(_=pi(u).spreadMode),this.setInitialView(w,{rotation:b,sidebarView:E,scrollMode:P,spreadMode:_}),this.eventBus.dispatch("documentinit",{source:this}),await Promise.race([o,new Promise(D=>{setTimeout(D,Us)})]),!(!y&&!w)&&(n.hasEqualPageSizes||(this.initialBookmark=y,n.currentScaleValue=n.currentScaleValue,this.setInitialView(w)))}).catch(()=>{this.setInitialView()}).then(function(){n.update()})}),o.then(()=>{this._unblockDocumentLoadEvent(),this._initializeAutoPrint(r,i)},h=>{this._documentError("pdfjs-loading-error",{message:h.message})}),a.then(h=>{this.externalServices.reportTelemetry({type:"pageInfo",timestamp:h.timestamp}),this.pdfOutlineViewer&&r.getOutline().then(d=>{r===this.pdfDocument&&this.pdfOutlineViewer.render({outline:d,pdfDocument:r})}),this.pdfAttachmentViewer&&r.getAttachments().then(d=>{r===this.pdfDocument&&this.pdfAttachmentViewer.render({attachments:d})}),this.pdfLayerViewer&&n.optionalContentConfigPromise.then(d=>{r===this.pdfDocument&&this.pdfLayerViewer.render({optionalContentConfig:d,pdfDocument:r})})}),this._initializePageLabels(r),this._initializeMetadata(r)},async _scriptingDocProperties(r){return!this.documentInfo&&(await new Promise(e=>{this.eventBus._on("metadataloaded",e,{once:!0})}),r!==this.pdfDocument)||!this._contentLength&&(await new Promise(e=>{this.eventBus._on("documentloaded",e,{once:!0})}),r!==this.pdfDocument)?null:{...this.documentInfo,baseURL:this.baseUrl,filesize:this._contentLength,filename:this._docFilename,metadata:this.metadata?.getRaw(),authors:this.metadata?.get("dc:creator"),numPages:this.pagesCount,URL:this.url}},async _initializeAutoPrint(r,e){const[t,i]=await Promise.all([e,this.pdfViewer.enableScripting?null:r.getJSActions()]);if(r!==this.pdfDocument)return;let n=t?.action==="Print";if(i){console.warn("Warning: JavaScript support is not enabled");for(const s in i){if(n)break;switch(s){case"WillClose":case"WillSave":case"DidSave":case"WillPrint":case"DidPrint":continue}n=i[s].some(a=>Yi.test(a))}}n&&this.triggerPrinting()},async _initializeMetadata(r){const{info:e,metadata:t,contentDispositionFilename:i,contentLength:n}=await r.getMetadata();if(r!==this.pdfDocument)return;e.collectedSignatureCertificates&&this.externalServices.reportTelemetry({type:"signatureCertificates",data:e.collectedSignatureCertificates}),this.documentInfo=e,this.metadata=t,this._contentDispositionFilename??=i,this._contentLength??=n,console.log(`PDF ${r.fingerprints[0]} [${e.PDFFormatVersion} ${(t?.get("pdf:producer")||e.Producer||"-").trim()} / ${(t?.get("xmp:creatortool")||e.Creator||"-").trim()}] (PDF.js: ${vt} [${Et}])`);const s=this._docTitle;s?this.setTitle(`${s} - ${this._contentDispositionFilename||this._title}`):this._contentDispositionFilename&&this.setTitle(this._contentDispositionFilename),e.IsXFAPresent&&!e.IsAcroFormPresent&&!r.isPureXfa?r.loadingParams.enableXfa?console.warn("Warning: XFA Foreground documents are not supported"):console.warn("Warning: XFA support is not enabled"):(e.IsAcroFormPresent||e.IsXFAPresent)&&!this.pdfViewer.renderForms&&console.warn("Warning: Interactive form support is not enabled"),e.IsSignaturesPresent&&console.warn("Warning: Digital signatures validation is not supported"),this.eventBus.dispatch("metadataloaded",{source:this})},async _initializePageLabels(r){if(typeof PDFJSDev>"u"?window.isGECKOVIEW:PDFJSDev.test("GECKOVIEW"))return;const e=await r.getPageLabels();if(r!==this.pdfDocument||!e||m.get("disablePageLabels"))return;const t=e.length;let i=0,n=0;for(let l=0;l<t;l++){const h=e[l];if(h===(l+1).toString())i++;else if(h==="")n++;else break}if(i>=t||n>=t)return;const{pdfViewer:s,pdfThumbnailViewer:a,toolbar:o}=this;s.setPageLabels(e),a?.setPageLabels(e),o?.setPagesCount(t,!0),o?.setPageNumber(s.currentPageNumber,s.currentPageLabel)},_initializePdfHistory({fingerprint:r,viewOnLoad:e,initialDest:t=null}){this.pdfHistory&&(this.pdfHistory.initialize({fingerprint:r,resetHistory:e===Ze.INITIAL,updateUrl:m.get("historyUpdateUrl")}),this.pdfHistory.initialBookmark&&(this.initialBookmark=this.pdfHistory.initialBookmark,this.initialRotation=this.pdfHistory.initialRotation),t&&!this.initialBookmark&&e===Ze.UNKNOWN&&(this.initialBookmark=JSON.stringify(t),this.pdfHistory.push({explicitDest:t,pageNumber:null})))},_initializeAnnotationStorageCallbacks(r){if(r!==this.pdfDocument)return;const{annotationStorage:e}=r;e.onSetModified=()=>{window.addEventListener("beforeunload",ti),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(this._annotationStorageModified=!0)},e.onResetModified=()=>{window.removeEventListener("beforeunload",ti),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&delete this._annotationStorageModified},e.onAnnotationEditor=t=>{this._hasAnnotationEditors=!!t,this.setTitle()}},setInitialView(r,{rotation:e,sidebarView:t,scrollMode:i,spreadMode:n}={}){const s=o=>{Be(o)&&(this.pdfViewer.pagesRotation=o)},a=(o,l)=>{fi(o)&&(this.pdfViewer.scrollMode=o),gi(l)&&(this.pdfViewer.spreadMode=l)};this.isInitialViewSet=!0,this.pdfSidebar?.setInitialView(t),a(i,n),this.initialBookmark?(s(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):r&&(s(e),this.pdfLinkService.setHash(r)),this.toolbar?.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),this.secondaryToolbar?.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=fe)},_cleanup(){this.pdfDocument&&(this.pdfViewer.cleanup(),this.pdfThumbnailViewer?.cleanup(),this.pdfDocument.cleanup(m.get("fontExtraProperties")))},forceRendering(){this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar?.visibleView===I.THUMBS,this.pdfRenderingQueue.renderHighestPriority()},beforePrint(){if(this._printAnnotationStoragePromise=this.pdfScriptingManager.dispatchWillPrint().catch(()=>{}).then(()=>this.pdfDocument?.annotationStorage.print),!this.printService){if(!this.supportsPrinting){this._otherError("pdfjs-printing-not-supported");return}if(!this.pdfViewer.pageViewsReady){this.l10n.get("pdfjs-printing-not-ready").then(r=>{window.alert(r)});return}this.printService=tt.createPrintService({pdfDocument:this.pdfDocument,pagesOverview:this.pdfViewer.getPagesOverview(),printContainer:this.appConfig.printContainer,printResolution:m.get("printResolution"),printAnnotationStoragePromise:this._printAnnotationStoragePromise}),this.forceRendering(),this.setTitle(),this.printService.layout(),this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"print",stats:this.pdfDocument?.annotationStorage.editorStats}})}},afterPrint(){this._printAnnotationStoragePromise&&(this._printAnnotationStoragePromise.then(()=>{this.pdfScriptingManager.dispatchDidPrint()}),this._printAnnotationStoragePromise=null),this.printService&&(this.printService.destroy(),this.printService=null,this.pdfDocument?.annotationStorage.resetModified()),this.forceRendering(),this.setTitle()},rotatePages(r){this.pdfViewer.pagesRotation+=r},requestPresentationMode(){this.pdfPresentationMode?.request()},triggerPrinting(){this.supportsPrinting&&window.print()},bindEvents(){if(this._eventBusAbortController)return;const e={signal:(this._eventBusAbortController=new AbortController).signal},{eventBus:t,externalServices:i,pdfDocumentProperties:n,pdfViewer:s,preferences:a}=this;t._on("resize",Ys.bind(this),e),t._on("hashchange",Qs.bind(this),e),t._on("beforeprint",this.beforePrint.bind(this),e),t._on("afterprint",this.afterPrint.bind(this),e),t._on("pagerender",zs.bind(this),e),t._on("pagerendered",js.bind(this),e),t._on("updateviewarea",Zs.bind(this),e),t._on("pagechanging",ra.bind(this),e),t._on("scalechanging",sa.bind(this),e),t._on("rotationchanging",aa.bind(this),e),t._on("sidebarviewchanged",Xs.bind(this),e),t._on("pagemode",$s.bind(this),e),t._on("namedaction",Ks.bind(this),e),t._on("presentationmodechanged",o=>s.presentationModeState=o.state,e),t._on("presentationmode",this.requestPresentationMode.bind(this),e),t._on("switchannotationeditormode",o=>s.annotationEditorMode=o,e),t._on("print",this.triggerPrinting.bind(this),e),t._on("download",this.downloadOrSave.bind(this),e),t._on("firstpage",()=>this.page=1,e),t._on("lastpage",()=>this.page=this.pagesCount,e),t._on("nextpage",()=>s.nextPage(),e),t._on("previouspage",()=>s.previousPage(),e),t._on("zoomin",this.zoomIn.bind(this),e),t._on("zoomout",this.zoomOut.bind(this),e),t._on("zoomreset",this.zoomReset.bind(this),e),t._on("pagenumberchanged",qs.bind(this),e),t._on("scalechanged",o=>s.currentScaleValue=o.value,e),t._on("rotatecw",this.rotatePages.bind(this,90),e),t._on("rotateccw",this.rotatePages.bind(this,-90),e),t._on("optionalcontentconfig",o=>s.optionalContentConfigPromise=o.promise,e),t._on("switchscrollmode",o=>s.scrollMode=o.mode,e),t._on("scrollmodechanged",ei.bind(this,"scrollMode"),e),t._on("switchspreadmode",o=>s.spreadMode=o.mode,e),t._on("spreadmodechanged",ei.bind(this,"spreadMode"),e),t._on("imagealttextsettings",ea.bind(this),e),t._on("documentproperties",()=>n?.open(),e),t._on("findfromurlhash",ta.bind(this),e),t._on("updatefindmatchescount",ia.bind(this),e),t._on("updatefindcontrolstate",na.bind(this),e),(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(t._on("fileinputchange",Js.bind(this),e),t._on("openfile",Gs.bind(this),e)),typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")&&(t._on("annotationeditorstateschanged",o=>i.updateEditorStates(o),e),t._on("reporttelemetry",o=>i.reportTelemetry(o.details),e)),(typeof PDFJSDev>"u"||PDFJSDev.test("TESTING || MOZCENTRAL"))&&t._on("setpreference",o=>a.set(o.name,o.value),e)},bindWindowEvents(){if(this._windowAbortController)return;this._windowAbortController=new AbortController;const{eventBus:r,appConfig:{mainContainer:e},pdfViewer:t,_windowAbortController:{signal:i}}=this;this._touchManager=new Gi({container:window,isPinchingDisabled:()=>t.isInPresentationMode,isPinchingStopped:()=>this.overlayManager?.active,onPinching:this.touchPinchCallback.bind(this),onPinchEnd:this.touchPinchEndCallback.bind(this),signal:i});function n(o=null){o&&t.refresh(),window.matchMedia(`(resolution: ${re.pixelRatio}dppx)`).addEventListener("change",n,{once:!0,signal:i})}if(n(),window.addEventListener("wheel",oa.bind(this),{passive:!1,signal:i}),window.addEventListener("click",da.bind(this),{signal:i}),window.addEventListener("keydown",ua.bind(this),{signal:i}),window.addEventListener("keyup",ca.bind(this),{signal:i}),window.addEventListener("resize",()=>r.dispatch("resize",{source:window}),{signal:i}),window.addEventListener("hashchange",()=>{r.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},{signal:i}),window.addEventListener("beforeprint",()=>r.dispatch("beforeprint",{source:window}),{signal:i}),window.addEventListener("afterprint",()=>r.dispatch("afterprint",{source:window}),{signal:i}),window.addEventListener("updatefromsandbox",o=>{r.dispatch("updatefromsandbox",{source:window,detail:o.detail})},{signal:i}),(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&!("onscrollend"in document.documentElement))return;(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=e);const s=()=>{(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=e),this._isScrolling=!1,e.addEventListener("scroll",a,{passive:!0,signal:i}),e.removeEventListener("scrollend",s),e.removeEventListener("blur",s)},a=()=>{this._isCtrlKeyDown||(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&this._lastScrollTop===e.scrollTop&&this._lastScrollLeft===e.scrollLeft||(e.removeEventListener("scroll",a),this._isScrolling=!0,e.addEventListener("scrollend",s,{signal:i}),e.addEventListener("blur",s,{signal:i}))};e.addEventListener("scroll",a,{passive:!0,signal:i})},unbindEvents(){this._eventBusAbortController?.abort(),this._eventBusAbortController=null},unbindWindowEvents(){this._windowAbortController?.abort(),this._windowAbortController=null,this._touchManager=null},async testingClose(){this.unbindEvents(),this.unbindWindowEvents(),this._globalAbortController?.abort(),this._globalAbortController=null,this.findBar?.close(),await Promise.all([this.l10n?.destroy(),this.close()])},_accumulateTicks(r,e){(this[e]>0&&r<0||this[e]<0&&r>0)&&(this[e]=0),this[e]+=r;const t=Math.trunc(this[e]);return this[e]-=t,t},_accumulateFactor(r,e,t){if(e===1)return 1;(this[t]>1&&e<1||this[t]<1&&e>1)&&(this[t]=1);const i=Math.floor(r*e*this[t]*100)/(100*r);return this[t]=e/i,i},_unblockDocumentLoadEvent(){document.blockUnblockOnload?.(!1),this._unblockDocumentLoadEvent=()=>{}},get scriptingReady(){return this.pdfScriptingManager.ready}};(typeof PDFJSDev>"u"||!PDFJSDev.test("MOZCENTRAL"))&&tt.initGlobals(ct);if(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))var Ws=function(r){},Js=function(r){if(this.pdfViewer?.isInPresentationMode)return;const e=r.fileInput.files[0];this.open({url:URL.createObjectURL(e),originalUrl:encodeURIComponent(e.name)})},Gs=function(r){this._openFileInput?.click()};function zs({pageNumber:r}){r===this.page&&this.toolbar?.updateLoadingIndicatorState(!0)}function js({pageNumber:r,isDetailView:e,error:t}){if(r===this.page&&this.toolbar?.updateLoadingIndicatorState(!1),!e&&this.pdfSidebar?.visibleView===I.THUMBS){const i=this.pdfViewer.getPageView(r-1),n=this.pdfThumbnailViewer?.getThumbnail(r-1);i&&n?.setImage(i)}t&&this._otherError("pdfjs-rendering-error",t)}function $s({mode:r}){let e;switch(r){case"thumbs":e=I.THUMBS;break;case"bookmarks":case"outline":e=I.OUTLINE;break;case"attachments":e=I.ATTACHMENTS;break;case"layers":e=I.LAYERS;break;case"none":e=I.NONE;break;default:console.error('Invalid "pagemode" hash parameter: '+r);return}this.pdfSidebar?.switchView(e,!0)}function Ks(r){switch(r.action){case"GoToPage":this.appConfig.toolbar?.pageNumber.select();break;case"Find":this.supportsIntegratedFind||this.findBar?.toggle();break;case"Print":this.triggerPrinting();break;case"SaveAs":this.downloadOrSave();break}}function Xs({view:r}){this.pdfRenderingQueue.isThumbnailViewEnabled=r===I.THUMBS,this.isInitialViewSet&&this.store?.set("sidebarView",r).catch(()=>{})}function Zs({location:r}){this.isInitialViewSet&&this.store?.setMultiple({page:r.pageNumber,zoom:r.scale,scrollLeft:r.left,scrollTop:r.top,rotation:r.rotation}).catch(()=>{}),this.appConfig.secondaryToolbar&&(this.appConfig.secondaryToolbar.viewBookmarkButton.href=this.pdfLinkService.getAnchorUrl(r.pdfOpenParams))}function ei(r,e){this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode&&this.store?.set(r,e.mode).catch(()=>{})}function Ys(){const{pdfDocument:r,pdfViewer:e,pdfRenderingQueue:t}=this;if(t.printing&&window.matchMedia("print").matches||!r)return;const i=e.currentScaleValue;(i==="auto"||i==="page-fit"||i==="page-width")&&(e.currentScaleValue=i),e.update()}function Qs(r){const e=r.hash;e&&(this.isInitialViewSet?this.pdfHistory?.popStateInProgress||this.pdfLinkService.setHash(e):this.initialBookmark=e)}function qs(r){const{pdfViewer:e}=this;r.value!==""&&this.pdfLinkService.goToPage(r.value),r.value!==e.currentPageNumber.toString()&&r.value!==e.currentPageLabel&&this.toolbar?.setPageNumber(e.currentPageNumber,e.currentPageLabel)}function ea(){this.imageAltTextSettings?.open({enableGuessAltText:m.get("enableGuessAltText"),enableNewAltTextWhenAddingImage:m.get("enableNewAltTextWhenAddingImage")})}function ta(r){this.eventBus.dispatch("find",{source:r.source,type:"",query:r.query,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1,matchDiacritics:!0})}function ia({matchesCount:r}){this.supportsIntegratedFind?this.externalServices.updateFindMatchesCount(r):this.findBar?.updateResultsCount(r)}function na({state:r,previous:e,entireWord:t,matchesCount:i,rawQuery:n}){this.supportsIntegratedFind?this.externalServices.updateFindControlState({result:r,findPrevious:e,entireWord:t,matchesCount:i,rawQuery:n}):this.findBar?.updateUIState(r,e,i)}function sa(r){this.toolbar?.setPageScale(r.presetValue,r.scale),this.pdfViewer.update()}function aa(r){this.pdfThumbnailViewer&&(this.pdfThumbnailViewer.pagesRotation=r.pagesRotation),this.forceRendering(),this.pdfViewer.currentPageNumber=r.pageNumber}function ra({pageNumber:r,pageLabel:e}){this.toolbar?.setPageNumber(r,e),this.secondaryToolbar?.setPageNumber(r),this.pdfSidebar?.visibleView===I.THUMBS&&this.pdfThumbnailViewer?.scrollThumbnailIntoView(r);const t=this.pdfViewer.getPageView(r-1);this.toolbar?.updateLoadingIndicatorState(t?.renderingState===T.RUNNING)}function oa(r){const{pdfViewer:e,supportsMouseWheelZoomCtrlKey:t,supportsMouseWheelZoomMetaKey:i,supportsPinchToZoom:n}=this;if(e.isInPresentationMode)return;const s=r.deltaMode;let a=Math.exp(-r.deltaY/100);const o=typeof PDFJSDev<"u"&&PDFJSDev.test("MOZCENTRAL")&&ni.platform.isMac,l=r.ctrlKey&&!this._isCtrlKeyDown&&s===WheelEvent.DOM_DELTA_PIXEL&&r.deltaX===0&&(Math.abs(a-1)<.05||o)&&r.deltaZ===0,h=[r.clientX,r.clientY];if(l||r.ctrlKey&&t||r.metaKey&&i){if(r.preventDefault(),this._isScrolling||document.visibilityState==="hidden"||this.overlayManager.active)return;if(l&&n)a=this._accumulateFactor(e.currentScale,a,"_wheelUnusedFactor"),this.updateZoom(null,a,h);else{const d=ui(r);let c=0;s===WheelEvent.DOM_DELTA_LINE||s===WheelEvent.DOM_DELTA_PAGE?c=Math.abs(d)>=1?Math.sign(d):this._accumulateTicks(d,"_wheelUnusedTicks"):c=this._accumulateTicks(d/30,"_wheelUnusedTicks"),this.updateZoom(c,null,h)}}}function la({target:r}){if(!this.secondaryToolbar?.isOpen)return;const{toolbar:e,secondaryToolbar:t}=this.appConfig;(this.pdfViewer.containsElement(r)||e?.container.contains(r)&&!t?.toolbar.contains(r)&&!t?.toggleButton.contains(r))&&this.secondaryToolbar.close()}function ha(r){this.editorUndoBar?.isOpen&&this.appConfig.secondaryToolbar?.toolbar.contains(r.target)&&this.editorUndoBar.hide()}function da(r){la.call(this,r),ha.call(this,r)}function ca(r){r.key==="Control"&&(this._isCtrlKeyDown=!1)}function ua(r){if(this._isCtrlKeyDown=r.key==="Control",this.editorUndoBar?.isOpen&&r.keyCode!==9&&r.keyCode!==16&&!((r.keyCode===13||r.keyCode===32)&&It()===this.appConfig.editorUndoBar.undoButton)&&this.editorUndoBar.hide(),this.overlayManager.active)return;const{eventBus:e,pdfViewer:t}=this,i=t.isInPresentationMode;let n=!1,s=!1;const a=(r.ctrlKey?1:0)|(r.altKey?2:0)|(r.shiftKey?4:0)|(r.metaKey?8:0);if(a===1||a===8||a===5||a===12)switch(r.keyCode){case 70:!this.supportsIntegratedFind&&!r.shiftKey&&(this.findBar?.open(),n=!0);break;case 71:if(!this.supportsIntegratedFind){const{state:h}=this.findController;if(h){const d={source:window,type:"again",findPrevious:a===5||a===12};e.dispatch("find",{...h,...d})}n=!0}break;case 61:case 107:case 187:case 171:this.zoomIn(),n=!0;break;case 173:case 109:case 189:this.zoomOut(),n=!0;break;case 48:case 96:i||(setTimeout(()=>{this.zoomReset()}),n=!1);break;case 38:(i||this.page>1)&&(this.page=1,n=!0,s=!0);break;case 40:(i||this.page<this.pagesCount)&&(this.page=this.pagesCount,n=!0,s=!0);break}if((typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC || CHROME"))&&(a===1||a===8))switch(r.keyCode){case 83:e.dispatch("download",{source:window}),n=!0;break;case 79:(typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC"))&&(e.dispatch("openfile",{source:window}),n=!0);break}if(a===3||a===10)switch(r.keyCode){case 80:this.requestPresentationMode(),n=!0,this.externalServices.reportTelemetry({type:"buttons",data:{id:"presentationModeKeyboard"}});break;case 71:this.appConfig.toolbar&&(this.appConfig.toolbar.pageNumber.select(),n=!0);break}if(n){s&&!i&&t.focus(),r.preventDefault();return}const o=It(),l=o?.tagName.toUpperCase();if(!((l==="INPUT"||l==="TEXTAREA"||l==="SELECT"||l==="BUTTON"&&r.keyCode===32||o?.isContentEditable)&&r.keyCode!==27)){if(a===0){let h=0,d=!1;switch(r.keyCode){case 38:if(this.supportsCaretBrowsingMode){this.moveCaret(!0,!1),n=!0;break}case 33:t.isVerticalScrollbarEnabled&&(d=!0),h=-1;break;case 8:i||(d=!0),h=-1;break;case 37:if(this.supportsCaretBrowsingMode)return;t.isHorizontalScrollbarEnabled&&(d=!0);case 75:case 80:h=-1;break;case 27:this.secondaryToolbar?.isOpen&&(this.secondaryToolbar.close(),n=!0),!this.supportsIntegratedFind&&this.findBar?.opened&&(this.findBar.close(),n=!0);break;case 40:if(this.supportsCaretBrowsingMode){this.moveCaret(!1,!1),n=!0;break}case 34:t.isVerticalScrollbarEnabled&&(d=!0),h=1;break;case 32:i||(d=!0),h=1;break;case 39:if(this.supportsCaretBrowsingMode)return;t.isHorizontalScrollbarEnabled&&(d=!0);case 74:case 78:h=1;break;case 36:(i||this.page>1)&&(this.page=1,n=!0,s=!0);break;case 35:(i||this.page<this.pagesCount)&&(this.page=this.pagesCount,n=!0,s=!0);break;case 83:this.pdfCursorTools?.switchTool(V.SELECT);break;case 72:this.pdfCursorTools?.switchTool(V.HAND);break;case 82:this.rotatePages(90);break;case 115:this.pdfSidebar?.toggle();break}h!==0&&(!d||t.currentScaleValue==="page-fit")&&(h>0?t.nextPage():t.previousPage(),n=!0)}if(a===4)switch(r.keyCode){case 32:if(!i&&t.currentScaleValue!=="page-fit")break;t.previousPage(),n=!0;break;case 38:this.moveCaret(!0,!0),n=!0;break;case 40:this.moveCaret(!1,!0),n=!0;break;case 82:this.rotatePages(-90);break}!n&&!i&&(r.keyCode>=33&&r.keyCode<=40||r.keyCode===32&&l!=="BUTTON")&&(s=!0),s&&!t.containsElement(o)&&t.focus(),n&&r.preventDefault()}}function ti(r){return r.preventDefault(),r.returnValue="",!1}const fa=typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?{LinkTarget:ee,RenderingStates:T,ScrollMode:C,SpreadMode:x}:null;window.PDFViewerApplication=ct;window.PDFViewerApplicationConstants=fa;window.PDFViewerApplicationOptions=m;function ga(){return{appContainer:document.body,principalContainer:document.getElementById("mainContainer"),mainContainer:document.getElementById("viewerContainer"),viewerContainer:document.getElementById("viewer"),viewerAlert:document.getElementById("viewer-alert"),toolbar:{container:document.getElementById("toolbarContainer"),numPages:document.getElementById("numPages"),pageNumber:document.getElementById("pageNumber"),scaleSelect:document.getElementById("scaleSelect"),customScaleOption:document.getElementById("customScaleOption"),previous:document.getElementById("previous"),next:document.getElementById("next"),zoomIn:document.getElementById("zoomInButton"),zoomOut:document.getElementById("zoomOutButton"),print:document.getElementById("printButton"),editorFreeTextButton:document.getElementById("editorFreeTextButton"),editorFreeTextParamsToolbar:document.getElementById("editorFreeTextParamsToolbar"),editorHighlightButton:document.getElementById("editorHighlightButton"),editorHighlightParamsToolbar:document.getElementById("editorHighlightParamsToolbar"),editorHighlightColorPicker:document.getElementById("editorHighlightColorPicker"),editorInkButton:document.getElementById("editorInkButton"),editorInkParamsToolbar:document.getElementById("editorInkParamsToolbar"),editorStampButton:document.getElementById("editorStampButton"),editorStampParamsToolbar:document.getElementById("editorStampParamsToolbar"),editorSignatureButton:document.getElementById("editorSignatureButton"),editorSignatureParamsToolbar:document.getElementById("editorSignatureParamsToolbar"),download:document.getElementById("downloadButton")},secondaryToolbar:{toolbar:document.getElementById("secondaryToolbar"),toggleButton:document.getElementById("secondaryToolbarToggleButton"),presentationModeButton:document.getElementById("presentationMode"),openFileButton:typeof PDFJSDev>"u"||PDFJSDev.test("GENERIC")?document.getElementById("secondaryOpenFile"):null,printButton:document.getElementById("secondaryPrint"),downloadButton:document.getElementById("secondaryDownload"),viewBookmarkButton:document.getElementById("viewBookmark"),firstPageButton:document.getElementById("firstPage"),lastPageButton:document.getElementById("lastPage"),pageRotateCwButton:document.getElementById("pageRotateCw"),pageRotateCcwButton:document.getElementById("pageRotateCcw"),cursorSelectToolButton:document.getElementById("cursorSelectTool"),cursorHandToolButton:document.getElementById("cursorHandTool"),scrollPageButton:document.getElementById("scrollPage"),scrollVerticalButton:document.getElementById("scrollVertical"),scrollHorizontalButton:document.getElementById("scrollHorizontal"),scrollWrappedButton:document.getElementById("scrollWrapped"),spreadNoneButton:document.getElementById("spreadNone"),spreadOddButton:document.getElementById("spreadOdd"),spreadEvenButton:document.getElementById("spreadEven"),imageAltTextSettingsButton:document.getElementById("imageAltTextSettings"),imageAltTextSettingsSeparator:document.getElementById("imageAltTextSettingsSeparator"),documentPropertiesButton:document.getElementById("documentProperties")},sidebar:{outerContainer:document.getElementById("outerContainer"),sidebarContainer:document.getElementById("sidebarContainer"),toggleButton:document.getElementById("sidebarToggleButton"),resizer:document.getElementById("sidebarResizer"),thumbnailButton:document.getElementById("viewThumbnail"),outlineButton:document.getElementById("viewOutline"),attachmentsButton:document.getElementById("viewAttachments"),layersButton:document.getElementById("viewLayers"),thumbnailView:document.getElementById("thumbnailView"),outlineView:document.getElementById("outlineView"),attachmentsView:document.getElementById("attachmentsView"),layersView:document.getElementById("layersView"),currentOutlineItemButton:document.getElementById("currentOutlineItem")},findBar:{bar:document.getElementById("findbar"),toggleButton:document.getElementById("viewFindButton"),findField:document.getElementById("findInput"),highlightAllCheckbox:document.getElementById("findHighlightAll"),caseSensitiveCheckbox:document.getElementById("findMatchCase"),matchDiacriticsCheckbox:document.getElementById("findMatchDiacritics"),entireWordCheckbox:document.getElementById("findEntireWord"),findMsg:document.getElementById("findMsg"),findResultsCount:document.getElementById("findResultsCount"),findPreviousButton:document.getElementById("findPreviousButton"),findNextButton:document.getElementById("findNextButton")},passwordOverlay:{dialog:document.getElementById("passwordDialog"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel")},documentProperties:{dialog:document.getElementById("documentPropertiesDialog"),closeButton:document.getElementById("documentPropertiesClose"),fields:{fileName:document.getElementById("fileNameField"),fileSize:document.getElementById("fileSizeField"),title:document.getElementById("titleField"),author:document.getElementById("authorField"),subject:document.getElementById("subjectField"),keywords:document.getElementById("keywordsField"),creationDate:document.getElementById("creationDateField"),modificationDate:document.getElementById("modificationDateField"),creator:document.getElementById("creatorField"),producer:document.getElementById("producerField"),version:document.getElementById("versionField"),pageCount:document.getElementById("pageCountField"),pageSize:document.getElementById("pageSizeField"),linearized:document.getElementById("linearizedField")}},altTextDialog:{dialog:document.getElementById("altTextDialog"),optionDescription:document.getElementById("descriptionButton"),optionDecorative:document.getElementById("decorativeButton"),textarea:document.getElementById("descriptionTextarea"),cancelButton:document.getElementById("altTextCancel"),saveButton:document.getElementById("altTextSave")},newAltTextDialog:{dialog:document.getElementById("newAltTextDialog"),title:document.getElementById("newAltTextTitle"),descriptionContainer:document.getElementById("newAltTextDescriptionContainer"),textarea:document.getElementById("newAltTextDescriptionTextarea"),disclaimer:document.getElementById("newAltTextDisclaimer"),learnMore:document.getElementById("newAltTextLearnMore"),imagePreview:document.getElementById("newAltTextImagePreview"),createAutomatically:document.getElementById("newAltTextCreateAutomatically"),createAutomaticallyButton:document.getElementById("newAltTextCreateAutomaticallyButton"),downloadModel:document.getElementById("newAltTextDownloadModel"),downloadModelDescription:document.getElementById("newAltTextDownloadModelDescription"),error:document.getElementById("newAltTextError"),errorCloseButton:document.getElementById("newAltTextCloseButton"),cancelButton:document.getElementById("newAltTextCancel"),notNowButton:document.getElementById("newAltTextNotNow"),saveButton:document.getElementById("newAltTextSave")},altTextSettingsDialog:{dialog:document.getElementById("altTextSettingsDialog"),createModelButton:document.getElementById("createModelButton"),aiModelSettings:document.getElementById("aiModelSettings"),learnMore:document.getElementById("altTextSettingsLearnMore"),deleteModelButton:document.getElementById("deleteModelButton"),downloadModelButton:document.getElementById("downloadModelButton"),showAltTextDialogButton:document.getElementById("showAltTextDialogButton"),altTextSettingsCloseButton:document.getElementById("altTextSettingsCloseButton"),closeButton:document.getElementById("altTextSettingsCloseButton")},addSignatureDialog:{dialog:document.getElementById("addSignatureDialog"),panels:document.getElementById("addSignatureActionContainer"),typeButton:document.getElementById("addSignatureTypeButton"),typeInput:document.getElementById("addSignatureTypeInput"),drawButton:document.getElementById("addSignatureDrawButton"),drawSVG:document.getElementById("addSignatureDraw"),drawPlaceholder:document.getElementById("addSignatureDrawPlaceholder"),drawThickness:document.getElementById("addSignatureDrawThickness"),imageButton:document.getElementById("addSignatureImageButton"),imageSVG:document.getElementById("addSignatureImage"),imagePlaceholder:document.getElementById("addSignatureImagePlaceholder"),imagePicker:document.getElementById("addSignatureFilePicker"),imagePickerLink:document.getElementById("addSignatureImageBrowse"),description:document.getElementById("addSignatureDescription"),clearButton:document.getElementById("clearSignatureButton"),saveContainer:document.getElementById("addSignatureSaveContainer"),saveCheckbox:document.getElementById("addSignatureSaveCheckbox"),errorBar:document.getElementById("addSignatureError"),errorCloseButton:document.getElementById("addSignatureErrorCloseButton"),cancelButton:document.getElementById("addSignatureCancelButton"),addButton:document.getElementById("addSignatureAddButton")},editSignatureDialog:{dialog:document.getElementById("editSignatureDescriptionDialog"),description:document.getElementById("editSignatureDescription"),editSignatureView:document.getElementById("editSignatureView"),cancelButton:document.getElementById("editSignatureCancelButton"),updateButton:document.getElementById("editSignatureUpdateButton")},annotationEditorParams:{editorFreeTextFontSize:document.getElementById("editorFreeTextFontSize"),editorFreeTextColor:document.getElementById("editorFreeTextColor"),editorInkColor:document.getElementById("editorInkColor"),editorInkThickness:document.getElementById("editorInkThickness"),editorInkOpacity:document.getElementById("editorInkOpacity"),editorStampAddImage:document.getElementById("editorStampAddImage"),editorSignatureAddSignature:document.getElementById("editorSignatureAddSignature"),editorFreeHighlightThickness:document.getElementById("editorFreeHighlightThickness"),editorHighlightShowAll:document.getElementById("editorHighlightShowAll")},printContainer:document.getElementById("printContainer"),editorUndoBar:{container:document.getElementById("editorUndoBar"),message:document.getElementById("editorUndoBarMessage"),undoButton:document.getElementById("editorUndoBarUndoButton"),closeButton:document.getElementById("editorUndoBarCloseButton")}}}function ii(){const r=ga();if(typeof PDFJSDev<"u"&&PDFJSDev.test("GENERIC")){const e=new CustomEvent("webviewerloaded",{bubbles:!0,cancelable:!0,detail:{source:window}});try{parent.document.dispatchEvent(e)}catch(t){console.error("webviewerloaded:",t),document.dispatchEvent(e)}}ct.run(r)}document.blockUnblockOnload?.(!0);document.readyState==="interactive"||document.readyState==="complete"?ii():document.addEventListener("DOMContentLoaded",ii,!0);
